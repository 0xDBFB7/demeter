<!DOCTYPE HTMP PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Data import</title>
    <link rel="stylesheet" href=../ab.css />
    <link rel="stylesheet" href=../ppi.css />
    <meta http-equiv="Content-Type" content="text/html"; charset=iso-8859-15 />
    <meta name="robots" contents="all" />
  </head>

  <body>
    <div class=topbar>
  <div class=navbar>
  <a class=navhead href="../index.html">The Athena Users' Guide</a>
  <table class=navtable>
    <tr>
      <td align=left>
        &laquo;<a class=navtable href="http://bruceravel.github.io/demeter/"><span class=programlink>DEMETER</span></a>&raquo; &nbsp;
        &laquo;<a class=navtable href="http://cars9.uchicago.edu/iffwiki/Ifeffit"><span class=programlink>IFEFFIT</span></a>&raquo; &nbsp;
        <!-- [&nbsp;<a class=navtable href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"></a>&nbsp;] &nbsp; -->
        &laquo;<a class=navtable href="http://xafs.org">xafs.org</a>&raquo; &nbsp;
	<!-- [&nbsp;<a class=navtable href="../demeter.pdf">PDF&nbsp;doc</a>&nbsp;] -->
      </td>
      <td align=right>
        Back: <a class=navtable href="../intro.html" class="menu">Introduction</a> &nbsp;&nbsp;
        Down: <a class=navtable href="../import/columns.html" class="menu">The column selection dialog</a>
        &nbsp;&nbsp;
        Next: <a class=navtable href="../bkg/index.html" class="menu">Background Removal</a>      </td>
    </tr>
  </table>
  </div>
</div>

<div class=sidebar>
  <a href="../pallas.html"><img src=../../images/pallas_athene_thumb.jpg
    width=90% border=0 alt='[Athena logo]'></a>
  <br />
  <a href="../index.html"  class="menu">Home</a><br />
<a href="../forward.html"  class="menu">Forward</a><br />
<a href="../intro.html"  class="menu">Introduction</a><br />
<span style="font-style: italic;">Importing Data</span><br />
&nbsp;&#8618;&nbsp;<a href="../import/columns.html"  class="menu">The column selection dialog</a><br />
&nbsp;&#8618;&nbsp;<a href="../import/projsel.html"  class="menu">The project selection dialog</a><br />
&nbsp;&#8618;&nbsp;<a href="../import/multiple.html"  class="menu">Importing multiple data sets</a><br />
&nbsp;&#8618;&nbsp;<a href="../import/ref.html"  class="menu">Reference channel</a><br />
&nbsp;&#8618;&nbsp;<a href="../import/preproc.html"  class="menu">Data preprocessing</a><br /><a href="../bkg/index.html"  class="menu">Background Removal</a><br />
<a href="../plot/index.html"  class="menu">Plotting</a><br />
<a href="../ui/index.html"  class="menu">User Interface</a><br />
<a href="../params/index.html"  class="menu">Setting parameter values</a><br />
<a href="../output/index.html"  class="menu">Output files</a><br />
<a href="../process/index.html"  class="menu">Data processing</a><br />
<a href="../analysis/index.html"  class="menu">Data analysis</a><br />
<a href="../other/index.html"  class="menu">Other main window chores</a><br />
<a href="../examples/index.html"  class="menu">Worked examples</a><br />
<a href="../hephaestus.html"  class="menu">Hephaestus</a><br />
</div>

<div class=contentarea>


<h1>
  Data import
</h1>

<p>

<span class=program>ATHENA</span> is very versatile in how she reads in data files. Pretty
much any data in the form of columns of numbers can be successfully
read. With a few exceptions, <span class=program>ATHENA</span> relies upon <span class=program>IFEFFIT</span>'s
<tt>read_data()</tt> command to handle the details
of data import. <span class=program>IFEFFIT</span> is clever about recognizing which part
of a file is columns of numbers and which part is not. In the
following, I'll explain how the
<tt>read_data()</tt>
command interprets files, explain the limits on its and <span class=program>ATHENA</span>'s
abilities to interpret a data file, and discuss the kinds of
manipulations of data that can and cannot be performed by <span class=program>ATHENA</span>
as data are imported.
</p>

<p>
<span class=program>ATHENA</span> expects data of one of a few types. Column data in which
the columns represent such things as the energy grid and the scalars
measured during the experiment are the most common sort of data that
most people use import into <span class=program>ATHENA</span>. <span class=program>ATHENA</span>'s column
selection dialog is used to convert the raw scalars into &mu;(E)
data. Other common kinds of data files that might be read into
<span class=program>ATHENA</span> are files that contain &mu;(E) or chi(k) data in columns or
the output files from Feff, <span class=file>xmu.dat</span> and
<span class=file>chi.dat</span>.
</p>

<p>
Here is an example of a data file that will make <span class=program>ATHENA</span> as happy
as can be. There are some header lines, followed by a line of dashes,
followed by a line of column labels, followed by lines containing
columns of data.
</p>


<pre>
# X15B  project: MT 9/23/04
# original file: STD1.001
# unpacked from original data as a sequence of 4-byte floats
# -----------------------------------------------------------
#   energy           I0          narrow        wide
    2400.0020    60183.3008       38.5000       83.0000
    2401.5088    60241.0508       41.5000       82.0000
    2403.0078    60347.5508       40.0000       83.7500
    2404.5039    60531.0508       42.2500       78.2500
  ... etc ...
</pre>

<p>

In this example of a perfectly formatted file, the header lines, the
line of dashes, and the column labels line are all preceded by a hash
(#) mark. <span class=program>IFEFFIT</span> is thus able to recognize these as header
lines. Since <span class=program>IFEFFIT</span> recognizes them as such, <span class=program>ATHENA</span> will store
them in the project along with the data. Because there is a line of
dashes and because it is followed immediately by column labels,
<span class=program>ATHENA</span> is able to use these labels in the column selection
dialog. A few other common US keyboard symbols, such as % or *, will
also be understood as marking header lines.
</p>

<p>
The numbers in the columns can be integers, floats (such as
<tt>1.234</tt>,
<tt>-1.234</tt>, .<tt>1234</tt> or
<tt>-.1234</tt>), or exponentials (such as
<tt>1.23e45</tt> or <tt>-1.23E-45</tt>).
Anything interpretable as a number in the C programming
language will be interpretable in this context. The columns of numbers
go to the end of the file. There is no text following the data.
</p>

<p>
When data is recorded as described above, it will be fully utilized by
<span class=program>ATHENA</span>. The headers will be recorded, the column labels will be used,
the data will be interpreted. <span class=program>ATHENA</span> can, however, accommodate
significant deviation from the format described above.
</p>


<ul>
  
<li><p>
If the header lines are not marked by a # or some other
recognizable marking character, <span class=program>IFEFFIT</span> will not be able to
recognize headers or column labels. As long as no text
follows the data, the columns will still be understood as
columns of data and the data can be imported by Athena.
</p></li>
<li><p>
If the line of dashes is missing, again the headers and
column labels will not be recognized, but the columns of
data will be.
</p></li>
<li><p>
If no headers are in the file, the columns of data will
still be understood as data.
</p></li>
</ul>

<p>

<span class=program>ATHENA</span> expects that the data are recorded as a function of energy and
that one of the columns contains energy values. The assumption is that
the first column is the energy column, but that can be changed in the
column selection dialog. <span class=program>ATHENA</span> works in eV. If data are recorded in
keV, there is a menu in the column selection dialog that must be set
accordingly.
</p>

<p>
Here are some operations that can be performed as data is imported.
</p>


<ol>
  
<li><p>
Data from a multi-element detector can be summed on the fly.
</p></li>
<li><p>
Data from a multi-element detector can be imported such that
each detector channel is imported into its own data group.
</p></li>
<li><p>
Data can be negated, i.e. multiplied by -1, or multiplied by an
arbitrary constant
</p></li>
<li><p>
A reference channel can be read from the the same file.
</p></li>
<li><p>
Data can be preprocessed. That is, data can be truncated,
deglitched, aligned to a standard, and have its parameters
constrained to a standard
</p></li>
</ol>

<p>

Here are some operations that can be handled using
<a href="../other/plugin.html">the Plugin architecture</a>.
</p>


<ol>
  
<li><p>
Data can be imported as a function of pixel position on an
area or linear detector.
</p></li>
<li><p>
Conversion from wavelength to energy.
</p></li>
<li><p>
Conversion from encoder reading or motor steps to energy.
</p></li>
<li><p>
Conversion of data in a binary format
</p></li>
<li><p>
Dead-time corrections using columns from the data file.
</p></li>
<li><p>
Any math expression more complicated than sums of columns in the
numerator and denominator, e.g. plugins allow you to multiply the
If column by 7 and divide by the sine of the I0 column, if that's
what you really want.
</p></li>
</ol>

<p>

If some of the criteria for the data file format are not met, for
example if there is text following the data columns or if you need to
perform one of the operations not yet supported, you will need to
process you data before trying to import into <span class=program>ATHENA</span>.
</p>

<p>
There are examples of data files that <span class=program>ATHENA</span> will process before
sending off to <span class=program>IFEFFIT</span> for import. An example is the data file format
from beamline X10C at NSLS. Files from that beamline cannot be
imported as written by <span class=program>IFEFFIT</span>'s
<tt>read_data()</tt> command. <span class=program>ATHENA</span> will
recognize such a file and process it as needed before importing
it. This can be done with other beamlines. You should contact Bruce if
you are the beamline scientist or a frequent user of some beamline
which writes data in a way that
<tt>read_data()</tt> cannot import.
</p>

<p>
As a final comment, I would encourage beamline scientists and the
authors of data acquisition software to consider their users when
designing data file formats. While I certainly will not say that
beamlines should be required to accommodate <span class=program>ATHENA</span> or even that
beamline staff have any obligation to recommend <span class=program>ATHENA</span> to their
users, the truth is that <span class=program>ATHENA</span> is becoming an increasingly
common tool in the EXAFS community.  The format that best serves
<span class=program>ATHENA</span> is actually a fine format that can be imported by a very
wide variety of EXAFS software, plotting software, spreadsheets, and
other programs. It's a good format and your users would be well served
by your adopting it.
</p>

</div>

<br />
<hr class=hide />
<hr class=bottomdivider />

<div class=bottombar>
  <div class=copyright>
  <table>
    <tr>
      <td colspan=2>
        <span class=program>DEMETER</span> is copyright &copy; 2009-2014 Bruce Ravel
        &mdash;
        This document is copyright &copy; 2014 Bruce Ravel
        <br />
      </td>
    </tr>
    <tr valign=middle>
      <td> 
           <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../../images/somerights20.png" width="88" height="31" alt="" border="0" /></a> &nbsp;&nbsp;&nbsp;
      </td>
      <td>
  	This document is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">
  	The Creative Commons Attribution-ShareAlike License</a>.
  	<br />
  	If <span class=program>DEMETER</span> and this document are useful to you, please consider
  	<a href="http://creativecommons.org/support/">supporting The Creative Commons</a>.
      </td>
    </tr>
  </table>
</div>
</div>
  </body>
</html>