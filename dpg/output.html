<!DOCTYPE HTMP PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Output formats</title>
    <link rel="stylesheet" href=./ab.css />
    <link rel="stylesheet" href=./ppi.css />
    <meta http-equiv="Content-Type" content="text/html"; charset=iso-8859-15 />
    <meta name="robots" contents="all" />
  </head>

  <body>
    <div class=topbar>
  <div class=navbar>
  <table class=navtable>
    <tr>
      <td align=left>
        [&nbsp;<a href="./index.html">Home</a>&nbsp;] &nbsp;&nbsp;
        [&nbsp;<a href="http://cars9.uchicago.edu/iffwiki/Demeter"><span class=programlink>DEMETER</span></a>&nbsp;] &nbsp;&nbsp;
        [&nbsp;<a href="http://cars9.uchicago.edu/iffwiki/Ifeffit"><span class=programlink>IFEFFIT</span></a>&nbsp;] &nbsp;&nbsp;
        [&nbsp;<a href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"><span class=programlink>FEFF</span></a>&nbsp;] &nbsp;&nbsp;
        [&nbsp;<a href="http://xafs.org">xafs.org</a>&nbsp;] &nbsp;&nbsp;
	[&nbsp;<a href="./demeter.pdf">PDF&nbsp;doc</a>&nbsp;]
      </td>
      <td align=right>
        Back: <a href="./ui.html" class="menu" >User interfaces</a> &nbsp;&nbsp;
        Next: <a href="./examples/index.html" class="menu" >Full examples</a>      </td>
    </tr>
  </table>
  </div>
  <h1>
  Output formats
</h1>
</div>

<hr class=hide />


<div class=sidebar>
  <a href="./ceres.html"><img src=./../images/Isis-Sothis-Demeter_sm.jpg
    width=100% border=0 alt='[Demeter logo]'></a>
  <br />
  <a href="./index.html" class="menu" >Home</a><br />
<a href="./intro.html" class="menu" >Introduction</a><br />
<a href="./data/index.html" class="menu" >Importing data</a><br />
<a href="./mue/index.html" class="menu" >Processing mu(E) data</a><br />
<a href="./xanes/index.html" class="menu" >Analysis of XANES data</a><br />
<a href="./highlevel/index.html" class="menu" >High level actions for Demeter objects</a><br />
<a href="./atoms/index.html" class="menu" >Atoms</a><br />
<a href="./feff/index.html" class="menu" >Feff</a><br />
<a href="./paths/index.html" class="menu" >Scattering paths</a><br />
<a href="./gds/index.html" class="menu" >Guess/Def/Set parameters</a><br />
<a href="./fit/index.html" class="menu" >Fitting EXAFS data</a><br />
<a href="./perl/index.html" class="menu" >Using perl to create a fitting model</a><br />
<a href="./lgcv.html" class="menu" >Local guess parameters and the characteristic value</a><br />
<a href="./pathlike/index.html" class="menu" >Path-like objects</a><br />
<a href="./su.html" class="menu" >Structural Units</a><br />
<a href="./ui.html" class="menu" >User interfaces</a><br />
<a href="./output.html" class="menuselect" >Output formats</a><br />
<a href="./examples/index.html" class="menu" >Full examples</a><br />
</div>

<p>

 <span class=program>DEMETER</span> offers a large number of output formats for the various
kinds of data handled by the various kinds of objects. 
</p>


<a name="singleobjectcolumndatafiles">

<h3>  Single object column data files</h3>
</a>
<p>

There are a number of ways to save Data, Path, and path-like objects
into column data files that can be plotted using other plotting
programs or imported into a spreadsheet program.
</p>

<p>
The available single object output types are:
</p>


<dl>
  
<dt>
  xmu
</dt>
<dd>
This file has 7 columns : energy, data as  &mu;(E)    , background,
pre-edge, post-edge line, derivative, and second derivative for a
Data object. 
  <br />
  <br />
</dd>
<dt>
  norm
</dt>
<dd>
This file has 7 columns: energy, data as normalized  &mu;(E)    ,
normalized background, flattened  &mu;(E)    , flattened background,
derivative of the normalized  &mu;(E)    , and second derivative of the
normalized  &mu;(E)     for a Data object.
  <br />
  <br />
</dd>
<dt>
  chi
</dt>
<dd>
This file has 6 columns: wavenumber,  &chi;(k)   ,  k&sdot;&chi;(k) , 
 k&sup2;&sdot;&chi;(k) ,  k&sup3;&sdot;&chi;(k) , and the  window function in k
for a Data, Path, or pathlike object.
  <br />
  <br />
</dd>
<dt>
  r
</dt>
<dd>
This file has 6 columns: R, real part of  &chi;(R)   , imaginary part,
magnitude, phase, and the window function in R for a Data, Path, or
pathlike object.  The current value of k-weighting in the Plot object
is used to generate the data for this file. 
  <br />
  <br />
</dd>
<dt>
  q
</dt>
<dd>
This file has 6 columns: q, real part of  &chi;(q)   , imaginary part,
magnitude, phase, and the window function in k for a Data, Path, or
pathlike object.  The current value of k-weighting in the Plot object
is used to generate the data for this file. 
  <br />
  <br />
</dd>
</dl>
<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$data_object</span> <span class="operator">-&gt;</span> <span class="word">save</span><span class="structure">(</span><span class="single">'xmu'</span><span class="operator">,</span>&nbsp;&nbsp;<span class="single">'myfit.dat'</span><span class="structure">)</span><br />
&nbsp;&nbsp;<span class="symbol">$path_object</span> <span class="operator">-&gt;</span> <span class="word">save</span><span class="structure">(</span><span class="single">'chir'</span><span class="operator">,</span> <span class="single">'mypath.dat'</span><span class="structure">)</span>
</ol>

<a name="columndatafileheaders">

<h4>  Column data file headers</h4>
</a>
<p>

The header of the fit and bkgsub file types is generated using the 
<tt>data_parameter_report</tt> method which, in
turn, takes its formatting from the 
<span class=file>data_report.tmpl</span> 
<a href="highlevel/dispose.html">template file</a>.
</p>

<p>

This line of code:
</p>

<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="word">print</span> <span class="symbol">$data_object</span> <span class="operator">-&gt;</span> <span class="word">data_parameter_report</span><span class="structure">;</span>
</ol>
<p>

generates this text:
</p>

<pre>
.  Element=Au   Edge=l3
Background parameters
.  E0=11919.166  Eshift=0  Rbkg=1.6
.  Standard=None
.  k-weight=1  Edge step=0.8548872
.  Fixed step=no    Flatten=yes
.  Pre-edge range: [ -150 : -30 ]
.  Pre-edge line: 2.404416 - 0.000174619 * energy
.  Normalization range: [ 150 : 869.877293080001 ]
.  Post-edge polynomial: 4.337632 - 0.000197019 * en - 5.71097e-09 * en^2
.  Spline range (energy): [ 0.000 : 969.877 ]   Clamps: 0/24
.  Spline range (k): [ 0.000 : 15.955 ]
Foreward FT parameters
.  Kweight=1   Window=kaiser-bessel   Phase correction=0
.  k-range: [ 2 : 13 ]   dk=1
Backward FT parameters
.  R-range: [ 1 : 3 ]
.  dR=0.2   Window=kaiser-bessel
Plotting parameters
.  Multiplier=1   Y-offset=0.0000
</pre>



<a name="fitresultcolumndatafiles">

<h3>  Fit result column data files</h3>
</a>
<p>

The results of a fit can be saved in one of two special column data files:
</p>

<dl>
  
<dt>
  fit
</dt>
<dd>
This file of 5 or 6 columns uses the fitting space for the first
column (i.e. wavenumber for a fit in k or q; distance for a fit in R),
followed by the data, the fit, the residual, the background if it was
fitted, and the appropriate window function.  This is only for a Data
object that has been used in a fit.
  <br />
  <br />
</dd>
<dt>
  bkgsub
</dt>
<dd>
This file has 3 columns: k,  &chi;(k)    with the background function
subtracted, and the k-space window.  This is only for a Data object
that has been used in a fit.
  <br />
  <br />
</dd>
</dl>

<p>

The <tt>save</tt> method takes an additional
argument used only for the fit type.  It specifies what form of the
data and the other parts to write to the file.  It can take a value of
<tt>k</tt>, 
<tt>k1</tt>, 
<tt>k2</tt>, 
<tt>k3</tt>, 
<tt>rmag</tt>, 
<tt>rre</tt>, 
<tt>rim</tt>, 
<tt>qmag</tt>, 
<tt>qre</tt>, or 
<tt>qim</tt> to indicate the space, the k-weighting
for k-space output, or the part of the complex function for R- or
q-space output.  The default (no argument) is <tt>k</tt>,
i.e. un-k-weighted  &chi;(k)   .
</p>

<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$dobject</span><span class="operator">-&gt;</span><span class="word">save</span><span class="structure">(</span><span class="double">&quot;fit&quot;</span><span class="operator">,</span> <span class="double">&quot;cufit.fit&quot;</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="symbol">$dobject</span><span class="operator">-&gt;</span><span class="word">save</span><span class="structure">(</span><span class="double">&quot;fit&quot;</span><span class="operator">,</span> <span class="double">&quot;rmag.fit&quot;</span><span class="operator">,</span> <span class="single">'rmag'</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="symbol">$dobject</span><span class="operator">-&gt;</span><span class="word">save</span><span class="structure">(</span><span class="double">&quot;fit&quot;</span><span class="operator">,</span> <span class="double">&quot;rre.fit&quot;</span><span class="operator">,</span> <span class="single">'rre'</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="symbol">$dobject</span><span class="operator">-&gt;</span><span class="word">save</span><span class="structure">(</span><span class="double">&quot;fit&quot;</span><span class="operator">,</span> <span class="double">&quot;rim.fit&quot;</span><span class="operator">,</span> <span class="single">'rim'</span><span class="structure">);</span>
</ol>

<a name="columndatafileheaders">

<h4>  Column data file headers</h4>
</a>
<p>

The header of the fit and bkgsub file types is generated using the 
<tt>fit_parameter_report</tt> method which, in
turn, takes its formatting from the 
<span class=file>fit_report.tmpl</span> 
<a href="highlevel/dispose.html">template file</a>.
</p>

<p>

This line of code:
</p>

<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="word">print</span> <span class="symbol">$data_object</span> <span class="operator">-&gt;</span> <span class="word">fit_parameter_report</span><span class="structure">;</span>
</ol>
<p>

generates this text:
</p>

<pre>
Demeter fit file -- Demeter 0.4.1
: file                = cu10k.chi
: name                = My copper data
: k-range             = 3.000 - 14.000
: dk                  = 1
: k-window            = hanning
: k-weight            = 1,2,3
: R-range             = 1.6 - 4.3
: dR                  = 0.0
: R-window            = hanning
: fitting space       = r
: background function = no
: phase correction    = 0
</pre>

<a name="multipleobjectcolumndatafiles">

<h3>  Multiple object column data files</h3>
</a>
<p>

 <span class=program>DEMETER</span> offers the <tt>save_many</tt> method
as a way to export many Data, Path, and pathlike objects to a single
column data file which can be easily imported into a plotting or
spreadsheet program.  The x-axis of the export space will be in the
first column, followed by one column for each object exported.  Those
columns will be in the order specified in the method call.
</p>


<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">save_many</span><span class="structure">(</span><span class="double">&quot;many.out&quot;</span><span class="operator">,</span> <span class="single">'chik3'</span><span class="operator">,</span> <span class="symbol">$paths</span><span class="structure">[</span><span class="number">0</span><span class="structure">]</span><span class="operator">,</span> <span class="symbol">$paths</span><span class="structure">[</span><span class="number">1</span><span class="structure">]</span><span class="operator">,</span> <span class="symbol">$carbon</span><span class="structure">);</span>
</ol>

<p>

The first argument is the output file name.  The second argument is
the kind of data to write out (see the list below).  The remaining
arguments are Data, Path, or pathlike objects to wrtie to the file.
The calling object (which san be any Data, Path, or pathlike object)
will be added to the front of the list of objects to export.  Care is
taken not to export the caller twice if it also appears in the
argument list and the caller appears in the second column of the
output file.
</p>

<p>
Every item in the list is interpolated (if necessary) to the grid of
the caller.
</p>

<p>
The available types are as follows (note that trying to write energy
data with Path or pathlike objects in the argument list will trigger
an error):
</p>


<ul>
  
<li>
<tt>xmu</tt>: save  &mu;(E)     for all objects in the
argument list. 
</li>
<li>
<tt>norm</tt>: save normalized  &mu;(E)     for all
objects in the argument list. 
</li>
<li>
<tt>der</tt>: save the derivative of  &mu;(E)     for
all objects in the argument list. 
</li>
<li>
<tt>nder</tt>: save the derivative of normalized 
 &mu;(E)     for all objects in the argument list. 
</li>
<li>
<tt>sec</tt>: save the second derivative of  &mu;(E)     for all objects in the argument list. 
</li>
<li>
<tt>nsec</tt>: save the second derivative of
normalized  &mu;(E)     for all objects in the argument list. 
</li>
<li>
<tt>chi</tt>: save unweighted  &chi;(k)    for all
objects in the argument list. 
</li>
<li>
<tt>chik</tt>: save  k&sup1;     -weighted  &chi;(k)   
for all objects in the argument list. 
</li>
<li>
<tt>chik2</tt>: save  k&sup2;     -weighted  &chi;(k)   
for all objects in the argument list. 
</li>
<li>
<tt>chik3</tt>: save  k&sup3;     -weighted  &chi;(k)   
for all objects in the argument list. 
</li>
<li>
<tt>chir_mag</tt>: save the magnitude of  &chi;(R)   
for all objects in the argument list. 
</li>
<li>
<tt>chir_re</tt>: save  the real part of  &chi;(R)   
for all objects in the argument list. 
</li>
<li>
<tt>chir_im</tt>: save the imaginary part of 
 &chi;(R)    for all objects in the argument list. 
</li>
<li>
<tt>chiq_mag</tt>: save the magnitude of  &chi;(q)   
for all objects in the argument list. 
</li>
<li>
<tt>chiq_re</tt>: save the real part of  &chi;(q)   
for all objects in the argument list. 
</li>
<li>
<tt>chiq_im</tt>: save the imaginary part of 
 &chi;(q)    for all objects in the argument list. 
</li>
</ul>

<a name="athenaprojectfiles">

<h3>  Athena  project files</h3>
</a>
<p>

You can export an  <span class=program>ATHENA</span> project files from a group of data
objects like so:
</p>


<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">write_athena</span><span class="structure">(</span><span class="double">&quot;myproject.prj&quot;</span><span class="operator">,</span> <span class="symbol">@list_of_data</span><span class="structure">);</span>
</ol>

<p>

The first argument is the filename for the project file. This is
followed by a list additional data objects to export. The caller will
be the first group in the project file, followed by the addition data
in the order supplied. If the caller is also in the list, it will not
be written twice to the project file. 
</p>

<p>
This is, in every way, a normal  <span class=program>ATHENA</span> project file that can be
imported by  <span class=program>ATHENA</span> or  <span class=program>ARTEMIS</span> (either the old version or
the new version).
</p>


<a name="serializationfiles">

<h3>  Serialization files</h3>
</a>
<p>

Every  <span class=program>DEMETER</span> object type has a serialization format.  The
purpose of this is to freeze the state of an object to disk in a form
that can be easily reimported to recover the state of the object.
</p>

<p>
These files use the 
<a href="http://www.yaml.org/">YAML data serialization</a>
format.  YAML is a fairly simple, text-only way of recording state of
an object.  Although you should never need to do so, you can examine
or even edit a YAML file with any text editor.  To save a little
space,  <span class=program>DEMETER</span> compresses the files using the same algorithm as the
<a href="http://www.gzip.org/">gzip program</a>.
This kind of compressed file can be read by most compression or
archiving programs on all platforms.
</p>

<p>
An object is written to a yaml file using the 
<tt>freeze</tt> method.  It's argument is the name
of the output file. 
</p>


<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">freeze</span><span class="structure">(</span><span class="double">&quot;data.yaml&quot;</span><span class="structure">);</span>
</ol>

<p>

You can import one of these serialization using the 
<tt>thaw</tt> method.  It's argument is the name
of the file to import.  It returns the object. 
</p>


<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">thaw</span><span class="structure">(</span><span class="double">&quot;data.yaml&quot;</span><span class="structure">);</span>
</ol>


<a name="logfiles">

<h3>  Log files</h3>
</a>
<p>

The Fit object has a <tt>logfile</tt> method.
</p>


<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$fitobject</span><span class="operator">-&gt;</span><span class="word">logfile</span><span class="structure">(</span><span class="double">&quot;myfit.log&quot;</span><span class="operator">,</span> <span class="symbol">$header</span><span class="operator">,</span> <span class="symbol">$footer</span><span class="structure">);</span>
</ol>


<a name="projectfiles">

<h3>  Project files</h3>
</a>
<p>

Project files are zip files filled with YAML files and other things.
</p>


<a name="atomsandfeffi/o">

<h3>  Atoms and feff I/O</h3>
</a>
<p>

 <span class=program>ATOMS</span> and  <span class=program>FEFF</span> I/O
</p>


<a name="scripts">

<h3>  Scripts</h3>
</a>
<p>

 <span class=program>DEMETER</span> and  <span class=program>IFEFFIT</span> scripts
</p>

<br />
<hr class=hide />

<div class=bottombar>
  <div class=navbar>
  <table class=navtable>
    <tr>
      <td align=left>
        [&nbsp;<a href="./index.html">Home</a>&nbsp;] &nbsp;&nbsp;
        [&nbsp;<a href="http://cars9.uchicago.edu/iffwiki/Demeter"><span class=programlink>DEMETER</span></a>&nbsp;] &nbsp;&nbsp;
        [&nbsp;<a href="http://cars9.uchicago.edu/iffwiki/Ifeffit"><span class=programlink>IFEFFIT</span></a>&nbsp;] &nbsp;&nbsp;
        [&nbsp;<a href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"><span class=programlink>FEFF</span></a>&nbsp;] &nbsp;&nbsp;
        [&nbsp;<a href="http://xafs.org">xafs.org</a>&nbsp;] &nbsp;&nbsp;
	[&nbsp;<a href="./demeter.pdf">PDF&nbsp;doc</a>&nbsp;]
      </td>
      <td align=right>
        Back: <a href="./ui.html" class="menu" >User interfaces</a> &nbsp;&nbsp;
        Next: <a href="./examples/index.html" class="menu" >Full examples</a>      </td>
    </tr>
  </table>
  </div>
  <div class=copyright>
   <span class=program>DEMETER</span> is copyright &copy; 2009-2010 Bruce Ravel
  <br />
  This document is copyright &copy; 2010 Bruce Ravel
  <br />
  email: (bravel |A|T| bnl |D|O|T| gov)
  <br />
  
  <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../images/somerights20.png" width="88" height="31" alt="" border="0" /></a> &nbsp;&nbsp;&nbsp;
  <br />
  This document is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">
  The Creative Commons Attribution-ShareAlike License</a>.
  <br />
  If  <span class=program>DEMETER</span> and this document are useful to you, please consider
  <a href="http://creativecommons.org/support/">supporting The Creative Commons</a>.
</div>
</div>
  </body>
</html>