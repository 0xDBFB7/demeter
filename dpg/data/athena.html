<!DOCTYPE HTMP PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Importing from Athena project files</title>
    <link rel="stylesheet" href=../dpg.css />
    <link rel="stylesheet" href=../ppi.css />
    <meta http-equiv="Content-Type" content="text/html"; charset=iso-8859-15 />
    <meta name="robots" contents="all" />
  </head>

  <body>
    <div class=topbar>
  <div class=navbar>
  <a class=navhead href="../index.html">The Demeter Programmer' Guide</a>
  <table class=navtable>
    <tr>
      <td align=left>
        &laquo;<a class=navtable href="http://bruceravel.github.com/demeter/"><span class=programlink>DEMETER</span></a>&raquo; &nbsp;
        &laquo;<a class=navtable href="http://cars9.uchicago.edu/iffwiki/Ifeffit"><span class=programlink>IFEFFIT</span></a>&raquo; &nbsp;
        <!-- [&nbsp;<a class=navtable href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"><span class=programlink>FEFF</span></a>&nbsp;] &nbsp; -->
        &laquo;<a class=navtable href="http://xafs.org">xafs.org</a>&raquo; &nbsp;
	<!-- [&nbsp;<a class=navtable href="../demeter.pdf">PDF&nbsp;doc</a>&nbsp;] -->
      </td>
      <td align=right>
        Back: <a class=navtable href="../data/columns.html" class="menu">Column data files</a> &nbsp;&nbsp;
        &nbsp;&nbsp;
        Up: <a class=navtable href="../data/index.html" class="menu">Importing data</a> &nbsp;&nbsp;
        Next: <a class=navtable href="../data/mc.html" class="menu">Multichannel data files</a>      </td>
    </tr>
  </table>
  </div>
</div>

<div class=sidebar>
  <a href="../ceres.html"><img src=../../images/Isis-Sothis-Demeter_sm.jpg
    width=90% border=0 alt='[Demeter logo]'></a>
  <br />
  <a href="../index.html"  class="menu">Home</a><br />
<a href="../intro.html"  class="menu">Introduction</a><br />
<a href="../data/index.html"  class="menuselect">Importing data</a><br />
&nbsp;&#8618;&nbsp;<a href="../data/mue.html"  class="menu">mu(E) data files</a><br />
&nbsp;&#8618;&nbsp;<a href="../data/chi.html"  class="menu">chi(k) data files</a><br />
&nbsp;&#8618;&nbsp;<a href="../data/columns.html"  class="menu">Column data files</a><br />
&nbsp;&#8618;&nbsp;<span style="font-style: italic;">Athena project files</span><br />
&nbsp;&#8618;&nbsp;<a href="../data/mc.html"  class="menu">Multichannel data files</a><br />
&nbsp;&#8618;&nbsp;<a href="../data/special.html"  class="menu">Special data types</a><br />
&nbsp;&#8618;&nbsp;<a href="../data/other.html"  class="menu">Handling arbitrary data</a><br />
&nbsp;&#8618;&nbsp;<a href="../data/plot.html"  class="menu">Basic plotting and data processing</a><br /><a href="../mue/index.html"  class="menu">Processing mu(E) data</a><br />
<a href="../xanes/index.html"  class="menu">Analysis of XANES data</a><br />
<a href="../highlevel/index.html"  class="menu">High level actions for Demeter objects</a><br />
<a href="../atoms/index.html"  class="menu">Atoms</a><br />
<a href="../feff/index.html"  class="menu">Feff</a><br />
<a href="../paths/index.html"  class="menu">Scattering paths</a><br />
<a href="../gds/index.html"  class="menu">Guess/Def/Set parameters</a><br />
<a href="../fit/index.html"  class="menu">Fitting EXAFS data</a><br />
<a href="../perl/index.html"  class="menu">Using perl to create a fitting model</a><br />
<a href="../lgcv.html"  class="menu">Local guess parameters and the characteristic value</a><br />
<a href="../pathlike/index.html"  class="menu">Path-like objects</a><br />
<a href="../su.html"  class="menu">Structural Units</a><br />
<a href="../ui.html"  class="menu">User interfaces</a><br />
<a href="../output.html"  class="menu">Output formats</a><br />
<a href="../examples/index.html"  class="menu">Full examples</a><br />
</div>

<div class=contentarea>


<h1>
  Importing from Athena project files
</h1>

<p>

The most convenient method for importing data into a <span class=program>DEMETER</span>
program is to import directly from an <span class=program>ATHENA</span> project file.
Presumably, you have already used <span class=program>ATHENA</span> to process you &mu;(E)
data into an analysis-ready form.  When data are imported from a
project file, all the attributes of the Data object will be set using
the values found in the project file.
</p>


<hr class=hide />
<a name="creatingdataobjects">

<h2>  Creating Data objects</h2>
</a>


<p>

Importing data from an <span class=program>ATHENA</span> project file is a two-step
process.  First a Data::Prj object must be created to store
information obtained from a lexical analysis of the project file.
Methods of the Data::Prj object are then used to generate Data
objects.  Here is a simple example of extracting the first record from
a project file and creating a Data object from that record.
</p>



<pre class=olscript>
<ol class=perlblock>
<li><span class="comment">#!/usr/bin/perl
<li></span><span class="keyword">use</span> <span class="word">Demeter</span><span class="structure">;</span>
<li>
<li><span class="keyword">my</span> <span class="symbol">$prj</span> <span class="operator">=</span> <span class="word">Demeter::Data::Prj</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">(</span><span class="word">file</span><span class="operator">=&gt;</span><span class="single">'iron_data.prj'</span><span class="structure">);</span>
<li><span class="keyword">my</span> <span class="symbol">$data</span> <span class="operator">=</span> <span class="symbol">$prj</span> <span class="operator">-&gt;</span> <span class="word">record</span><span class="structure">(</span><span class="number">1</span><span class="structure">);</span>
<li><span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">plot</span><span class="structure">(</span><span class="single">'E'</span><span class="structure">);</span>
</ol>
</pre>

<p>

The <tt>$data</tt> scalar contains a Data object.
Internally, the <tt>record</tt> method 
does the following
</p>


<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$data</span> <span class="operator">=</span> <span class="word">Demeter::Data</span><span class="operator">-&gt;</span><span class="word">new</span><span class="structure">();</span>
</ol>

<p>

setting attributes appropriately and pushing the associated data
arrays into <span class=program>IFEFFIT</span>.
</p>

<p>
You can import several records at a time by specifying a list of
record identifiers:
</p>


<pre class=olscript>
<ol class=perlblock>
<li><span class="comment">#!/usr/bin/perl
<li></span><span class="keyword">use</span> <span class="word">Demeter</span><span class="structure">;</span>
<li>
<li><span class="keyword">my</span> <span class="symbol">$prj</span> <span class="operator">=</span> <span class="word">Demeter::Data::Prj</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">(</span><span class="word">file</span><span class="operator">=&gt;</span><span class="single">'iron_data.prj'</span><span class="structure">);</span>
<li><span class="keyword">my</span> <span class="symbol">@several</span> <span class="operator">=</span> <span class="symbol">$prj</span> <span class="operator">-&gt;</span> <span class="word">records</span><span class="structure">(</span><span class="number">2</span><span class="operator">,</span> <span class="number">7</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">19</span><span class="structure">);</span>
<li><span class="magic">$_</span> <span class="operator">-&gt;</span> <span class="word">plot</span><span class="structure">(</span><span class="single">'E'</span><span class="structure">)</span> <span class="word">foreach</span> <span class="symbol">@several</span><span class="structure">;</span>
</ol>
</pre>

<p>

Note that <tt>records</tt> is just an alias for
<tt>record</tt>.  They point at the same method.
The two spellings are offered as a nod to English grammer.  The method
will recognize if it is called in scalar or list context and properly
return a single Data object or an array of Data objects.
</p>

<p>
You can import all records easily using the 
<tt>slurp</tt> method.
</p>


<pre class=olscript>
<ol class=perlblock>
<li><span class="comment">#!/usr/bin/perl
<li></span><span class="keyword">use</span> <span class="word">Demeter</span><span class="structure">;</span>
<li>
<li><span class="keyword">my</span> <span class="symbol">$prj</span> <span class="operator">=</span> <span class="word">Demeter::Data::Prj</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">(</span><span class="word">file</span><span class="operator">=&gt;</span><span class="single">'iron_data.prj'</span><span class="structure">);</span>
<li><span class="keyword">my</span> <span class="symbol">@all</span> <span class="operator">=</span> <span class="symbol">$prj</span> <span class="operator">-&gt;</span> <span class="word">slurp</span><span class="structure">;</span>
<li><span class="magic">$_</span> <span class="operator">-&gt;</span> <span class="word">plot</span><span class="structure">(</span><span class="single">'E'</span><span class="structure">)</span> <span class="word">foreach</span> <span class="symbol">@all</span><span class="structure">;</span>
</ol>
</pre>

<hr class=hide />
<a name="obtainingotherinformationfromprojectfiles">

<h2>  Obtaining other information from project files</h2>
</a>

<p>

You can query an <span class=program>ATHENA</span> project file for its content in several
ways.  To obtain a listing of contents of the project file, use the
<tt>list</tt> method.
</p>


<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="word">print</span> <span class="symbol">$prj</span> <span class="operator">-&gt;</span> <span class="word">list</span><span class="structure">;</span><br />
&nbsp;&nbsp;<span class="comment">&nbsp;&nbsp;&nbsp;## ==prints==&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;record<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;# -------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;1 : Iron foil<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;2 : Iron oxide<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;3 : Iron sulfide<br />
&nbsp;&nbsp;</span>
</ol>

<p>

To create a simple table of parameter values, supply a list of
attribute names to the <tt>list</tt> method.
</p>


<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="word">print</span> <span class="symbol">$prj</span> <span class="operator">-&gt;</span> <span class="word">list</span><span class="structure">(</span><span class="words">qw(bkg_rbkg fft_kmin)</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="comment">&nbsp;&nbsp;## ==prints==&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;record&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bkg_rbkg&nbsp;&nbsp;&nbsp;fft_kmin<br />
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;# -------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;1 : Iron foil&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0<br />
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;2 : Iron oxide&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0<br />
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;3 : Iron sulfide&nbsp;&nbsp;&nbsp;1.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0<br />
&nbsp;&nbsp;</span>
</ol>

<p>

The <tt>list</tt> method is used extensively by the 
<tt>lsprj</tt> program, which is distributed
with <span class=program>DEMETER</span>.
</p>

<p>
The <tt>allnames</tt> method will return an array
of record labels (the strings in the groups list in <span class=program>ATHENA</span>).
For complete details on these methods, see the
<span class=file>Demeter::Data::Prj</span> documentation.
</p>

</div>

<br />
<hr class=hide />
<hr class=bottomdivider />

<div class=bottombar>
  <div class=copyright>
  <table>
    <tr>
      <td colspan=2>
        <span class=program>DEMETER</span> is copyright &copy; 2009-2014 Bruce Ravel
        &mdash;
        This document is copyright &copy; 2014 Bruce Ravel
        <br />
      </td>
    </tr>
    <tr valign=middle>
      <td> 
           <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../../images/somerights20.png" width="88" height="31" alt="" border="0" /></a> &nbsp;&nbsp;&nbsp;
      </td>
      <td>
  	This document is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">
  	The Creative Commons Attribution-ShareAlike License</a>.
  	<br />
  	If <span class=program>DEMETER</span> and this document are useful to you, please consider
  	<a href="http://creativecommons.org/support/">supporting The Creative Commons</a>.
      </td>
    </tr>
  </table>
</div>
</div>
  </body>
</html>