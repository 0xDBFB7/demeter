<!DOCTYPE HTMP PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>The non-statistical happiness metric</title>
    <link rel="stylesheet" href=../dpg.css />
    <link rel="stylesheet" href=../ppi.css />
    <meta http-equiv="Content-Type" content="text/html"; charset=iso-8859-15 />
    <meta name="robots" contents="all" />
  </head>

  <body>
    <div class=topbar>
  <div class=navbar>
  <a class=navhead href="../index.html">The Demeter Programmer' Guide</a>
  <table class=navtable>
    <tr>
      <td align=left>
        &laquo;<a class=navtable href="http://bruceravel.github.com/demeter/"><span class=programlink>DEMETER</span></a>&raquo; &nbsp;
        &laquo;<a class=navtable href="http://cars9.uchicago.edu/iffwiki/Ifeffit"><span class=programlink>IFEFFIT</span></a>&raquo; &nbsp;
        <!-- [&nbsp;<a class=navtable href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"><span class=programlink>FEFF</span></a>&nbsp;] &nbsp; -->
        &laquo;<a class=navtable href="http://xafs.org">xafs.org</a>&raquo; &nbsp;
	<!-- [&nbsp;<a class=navtable href="../demeter.pdf">PDF&nbsp;doc</a>&nbsp;] -->
      </td>
      <td align=right>
        Back: <a class=navtable href="../fit/after.html" class="menu">After a fit finishes</a>
        &nbsp;&nbsp;
        Up: <a class=navtable href="../fit/index.html" class="menu">Fitting EXAFS data</a>      </td>
    </tr>
  </table>
  </div>
</div>

<div class=sidebar>
  <a href="../ceres.html"><img src=../../images/Isis-Sothis-Demeter_sm.jpg
    width=90% border=0 alt='[Demeter logo]'></a>
  <br />
  <a href="../index.html"  class="menu">Home</a><br />
<a href="../intro.html"  class="menu">Introduction</a><br />
<a href="../data/index.html"  class="menu">Importing data</a><br />
<a href="../mue/index.html"  class="menu">Processing mu(E) data</a><br />
<a href="../xanes/index.html"  class="menu">Analysis of XANES data</a><br />
<a href="../highlevel/index.html"  class="menu">High level actions for Demeter objects</a><br />
<a href="../atoms/index.html"  class="menu">Atoms</a><br />
<a href="../feff/index.html"  class="menu">Feff</a><br />
<a href="../paths/index.html"  class="menu">Scattering paths</a><br />
<a href="../gds/index.html"  class="menu">Guess/Def/Set parameters</a><br />
<a href="../fit/index.html"  class="menuselect">Fitting EXAFS data</a><br />
&nbsp;&#8618;&nbsp;<a href="../fit/collection.html"  class="menu">Setting up a fitting model</a><br />
&nbsp;&#8618;&nbsp;<a href="../fit/sanity.html"  class="menu">Sanity checking a fitting model</a><br />
&nbsp;&#8618;&nbsp;<a href="../fit/after.html"  class="menu">After a fit finishes</a><br />
&nbsp;&#8618;&nbsp;<span style="font-style: italic;">The non-statistical happiness parameter</span><br /><a href="../perl/index.html"  class="menu">Using perl to create a fitting model</a><br />
<a href="../lgcv.html"  class="menu">Local guess parameters and the characteristic value</a><br />
<a href="../pathlike/index.html"  class="menu">Path-like objects</a><br />
<a href="../su.html"  class="menu">Structural Units</a><br />
<a href="../ui.html"  class="menu">User interfaces</a><br />
<a href="../output.html"  class="menu">Output formats</a><br />
<a href="../examples/index.html"  class="menu">Full examples</a><br />
</div>

<div class=contentarea>


<h1>
  The non-statistical happiness metric
</h1>

<p>

One of the new fitting features introduced by <span class=program>DEMETER</span> that was
not available in earlier version of <span class=program>ARTEMIS</span> is the fit 
&ldquo;happiness&rdquo;.  This is a non-statistical
metric that evaluates the fit in a semantic sense.  As explained
elsewhere, <span class=program>IFEFFIT</span> uses a Levenberg-Marquardt fitting algorithm
and applies Gaussian statistics to the EXAFS analysis problem.  For a
host of reasons, the application of Gaussian statistics is troublesome
for EXAFS.  The most striking result is that the reduced &chi;&sup2;
of a good fit is rarely close to 1, as one would expect for a properly
conceived Gaussian problem.  Even for a very good fit to a metallic
standard which returns very sensible parameter values, the reduced 
&chi;&sup2; is likely to be in the 10s or 100s.
</p>

<p>
Although the Gaussian problem is ill-posed, years of experience
fitting EXAFS data has taught us much about what constitutes as a good
fit.  We expect that the R-factor is small.  We expect that S&sup2;&#8320;
and &sigma;&sup2; are non-negative.  We expact neither &Delta;R 
nor E&#8320; will be too large.  We know that we should not use too
many of the independent points contained in the data.
</p>

<p>
All of those are things that we consider when examining the results of
a fit.  When one or more of those things does not hold for a fit, we
are unhappy and thus wary of the fit.  If, however, all of them hold
true, then we might have confidence in the fit, thus making us happy.
</p>

<p>
<hr class=hide />
<a name="asemanticparameter">
</p>

<p>
<h2>  A semantic parameter</h2>
</a>
</p>

<p>
Discuss cognitive load here....
</p>

<p>
<span class=program>DEMETER</span> has a simple mechanism for parameterizing the results of
the fit to evaluate a semantic assessment of the fit.  Each fit starts
with a score of 100.  Each of those semantic evaluations of the fit
are subjected to the simple algorithm.  Each such evaluation is a
penalty which is subtracted from the score.  A fit with a score near
100 is &ldquo;happy&rdquo;, which a fit with a score of
60 or below is &ldquo;unhappy&rdquo;.  It is,
therefore, a tool to help you evaluate the result of your fit.
</p>


<p class=caution>
<img class=tinyfloatleft border=0 src="../../images/alert.png" alt="Caution!">
The word "happiness" was chosen for this paremeter because it is silly.
This is an ad-hoc, semantic metric.  It has no
basis in formal statistics.  It is, therefore, meaningless and should
never be published.
</p>

<hr class=hide />
<a name="howthehappinessiscalculated">

<h2>  How the happiness is calculated</h2>
</a>

<p>

The fit's happiness is computed using a bunch of
<a href="../highlevel/config.html">configuration parameters </a>
from the <tt>happiness</tt> configuration group.
Here is a summary of how the happiness is calculated.  All numbers
given in the following descriptions can be set using the configuration system.
</p>


<ol>
  
<li><p>
It should have a small R-factor.  An R-factor below 0.2 gives no
penalty.  An R-factor above 0.6 gives a penalty of 40.  R-factors
between those values scale linearly between 0 and 40.
</p></li>
<li><p>
If the number of guess parameters is fewer than 2/3 of the number of
independent points, no penalty is given.  As the number of guess
parameters approaches the number of independent points, the penalty
grows.
</p></li>
<li><p>
A penalty of 2 is given for each Path with a negative S&sup2;&#8320; or 
&sigma;&sup2; value.
</p></li>
<li><p>
A penalty of 2 is given for each
E&#8320;, &Delta;R, or &sigma;&sup2; path parameter of each Path that
is too big.
</p></li>
<li><p>
For each restraint that evaluates to something non-zero, a penalty is
given that is proportional to the value of the restraint divided by
the value of &chi;&sup2;.
</p></li>
</ol>

<p>

The Fit object's <tt>happiness</tt> attribute is
set to the evaluation of the happiness metric.  A color is also
computed based on this value for use as a semantic indicator in a GUI
or web program.  The idea behind the color is to serve as a sort of 
&ldquo;environmental indicator&rdquo; providing
immediate feedback as to the state of the most recent fit.  For
instance, a fit that looks good in the sense that the red line plots
nicely over the blue line but which displays the unhappy color will
induce the user to explore the problem making the fit unhappy.
Without that environmental indication, one might see a nice plot and
assume that the fit is, in fact, a good one.
</p>

<p>
The default values of the configuration parameters related to the
happiness calculation seems to be reasonable, but you are certainly
encouraged to tune those values to give you results that are more
useful for your experience.  If you do so, please share your work with
Bruce so that your experience can be folded back into <span class=program>DEMETER</span>.
</p>


<p class=todo>
<img class=tinyfloatleft border=0 src="../../images/todo.png" alt="To do!">
In a future version of <span class=program>DEMETER</span> it will be possible to define a
penalty parameter, which is a special kind of GDS object.  It will be
like an after parameter in the sense that it is evaluated at the end
of the fit.  Its evaluation will be used as an additional,
user-defined penalty to the happiness.  This will give a dynamic,
aspect to the happiness evaluation which is specific to the fitting
model.
</p>

<hr class=hide />
<a name="happinessisnotarealstatisticalparameter">

<h2>  Happiness is not a real statistical parameter</h2>
</a>

<p>

One final note about the happiness metric.  Use it to evaluate your
progress through a fitting project, but don't publish it.
Really.  If you do publish it, we will both look like twits.
</p>

</div>

<br />
<hr class=hide />
<hr class=bottomdivider />

<div class=bottombar>
  <div class=copyright>
  <table>
    <tr>
      <td colspan=2>
        <span class=program>DEMETER</span> is copyright &copy; 2009-2012 Bruce Ravel
        &mdash;
        This document is copyright &copy; 2012 Bruce Ravel
        <br />
      </td>
    </tr>
    <tr valign=middle>
      <td> 
           <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../../images/somerights20.png" width="88" height="31" alt="" border="0" /></a> &nbsp;&nbsp;&nbsp;
      </td>
      <td>
  	This document is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">
  	The Creative Commons Attribution-ShareAlike License</a>.
  	<br />
  	If <span class=program>DEMETER</span> and this document are useful to you, please consider
  	<a href="http://creativecommons.org/support/">supporting The Creative Commons</a>.
      </td>
    </tr>
  </table>
</div>
</div>
  </body>
</html>