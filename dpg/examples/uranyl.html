<!DOCTYPE HTMP PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Uranyl ion in solution</title>
    <link rel="stylesheet" href=../dpg.css />
    <link rel="stylesheet" href=../ppi.css />
    <meta http-equiv="Content-Type" content="text/html"; charset=iso-8859-15 />
    <meta name="robots" contents="all" />
  </head>

  <body>
    <div class=topbar>
  <div class=navbar>
  <a class=navhead href="../index.html">The Demeter Programmer' Guide</a>
  <table class=navtable>
    <tr>
      <td align=left>
        &laquo;<a class=navtable href="http://bruceravel.github.com/demeter/"><span class=programlink>DEMETER</span></a>&raquo; &nbsp;
        &laquo;<a class=navtable href="http://cars9.uchicago.edu/iffwiki/Ifeffit"><span class=programlink>IFEFFIT</span></a>&raquo; &nbsp;
        <!-- [&nbsp;<a class=navtable href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"><span class=programlink>FEFF</span></a>&nbsp;] &nbsp; -->
        &laquo;<a class=navtable href="http://xafs.org">xafs.org</a>&raquo; &nbsp;
	<!-- [&nbsp;<a class=navtable href="../demeter.pdf">PDF&nbsp;doc</a>&nbsp;] -->
      </td>
      <td align=right>
        Back: <a class=navtable href="../examples/agau.html" class="menu">Silver/gold alloy</a> &nbsp;&nbsp;
        &nbsp;&nbsp;
        Up: <a class=navtable href="../examples/index.html" class="menu">Full examples</a> &nbsp;&nbsp;
        Next: <a class=navtable href="../examples/histo.html" class="menu">Histogram</a>      </td>
    </tr>
  </table>
  </div>
</div>

<div class=sidebar>
  <a href="../ceres.html"><img src=../../images/Isis-Sothis-Demeter_sm.jpg
    width=90% border=0 alt='[Demeter logo]'></a>
  <br />
  <a href="../index.html"  class="menu">Home</a><br />
<a href="../intro.html"  class="menu">Introduction</a><br />
<a href="../data/index.html"  class="menu">Importing data</a><br />
<a href="../mue/index.html"  class="menu">Processing mu(E) data</a><br />
<a href="../xanes/index.html"  class="menu">Analysis of XANES data</a><br />
<a href="../highlevel/index.html"  class="menu">High level actions for Demeter objects</a><br />
<a href="../atoms/index.html"  class="menu">Atoms</a><br />
<a href="../feff/index.html"  class="menu">Feff</a><br />
<a href="../paths/index.html"  class="menu">Scattering paths</a><br />
<a href="../gds/index.html"  class="menu">Guess/Def/Set parameters</a><br />
<a href="../fit/index.html"  class="menu">Fitting EXAFS data</a><br />
<a href="../perl/index.html"  class="menu">Using perl to create a fitting model</a><br />
<a href="../lgcv.html"  class="menu">Local guess parameters and the characteristic value</a><br />
<a href="../pathlike/index.html"  class="menu">Path-like objects</a><br />
<a href="../su.html"  class="menu">Structural Units</a><br />
<a href="../ui.html"  class="menu">User interfaces</a><br />
<a href="../output.html"  class="menu">Output formats</a><br />
<a href="../examples/index.html"  class="menuselect">Full examples</a><br />
&nbsp;&#8618;&nbsp;<a href="../examples/methyltin.html"  class="menu">Methyltin chloride</a><br />
&nbsp;&#8618;&nbsp;<a href="../examples/agau.html"  class="menu">Silver/gold alloy</a><br />
&nbsp;&#8618;&nbsp;<span style="font-style: italic;">Uranyl complex in solution</span><br />
&nbsp;&#8618;&nbsp;<a href="../examples/histo.html"  class="menu">Histogram</a><br />
</div>

<div class=contentarea>


<h1>
  Uranyl ion in solution
</h1>
<h2>
  Using fuzzy degeneracy, virtual paths, and arbitrary single scattering paths 
</h2>

<p>
 
In this experiment, the control
sample was a buffered solution with a dissolved uranyl
acetate.  Following the example of 
S. Kelly, et al., <em>Geochem. Cosmo. Acta</em>, <strong>66:22</strong>, 
(2002) p.&nbsp;3875,
I will use a crystalline analogue of the solvated moiety as my
starting point for the Feff calculation. Here is the input data for
Atoms for crystalline sodium uranyl triacetate: 
</p>


<pre>title = Templeton et al.
title = Redetermination and Absolute configuration of Sodium Uranyl(VI) triacetate.
title = Acta Cryst 1985 C41 1439-1441
space = P 21 3
a     = 10.6890   b    = 10.6890    c    =  10.6890
core  =  U        edge =  L3        rmax =  7.0
atoms
! elem   x          y          z     tag  
  U     0.42940    0.42940    0.42940  U  
  Na    0.82860    0.82860    0.82860  Na 
  O     0.33430    0.33430    0.33430  Oax
  O     0.52420    0.52420    0.52420  Oax
  O     0.38340    0.29450    0.61100  Oeq
  O     0.54640    0.24430    0.50070  Oeq
  C     0.47860    0.22600    0.59500  C
  C     0.50880    0.12400    0.68620  C
</pre>

<table>
<tr>
<td>
<p>

This produces a complex crystal structure that includes the
uranyl complex onthe right.
</p>

</td>
<td width=553>
<a href="../../images/uranyl.png" target=_blank><img border=0 src="../../images/uranyl.png" alt="uranyl.png" width=100%></a>
</td>
</tr>
</table>


<p>
 
Following Shelly's example, I will take bits and pieces from this
crystalline analog and use them to understand the EXAFS from my
solution sample.  The rest of the crystal is simply unused.  I expect
that the solvated complex looks basically like this snippet of the
full crystal.
</p>

<p>
Note that there are two crystallographically distinct axial oxygen
sites and and two equatorial sites. When you run this through Feff's
pathfinder, you find that each site leads to a single scattering path
of a slightly different length than its partner. It is highly unlikely
that I can use an EXAFS measurement of medium quality to distinguish
two slightly different oxygen distances. In Shelly's paper, you can
see that she removes these slight degeneracies by using a subset of
the paths Feff generates and resetting their degeneracies
appropriately. For instance, she uses just one of the axial oxygen
paths and multiplies it by 2 to account for the two axial oxygen
atoms.
</p>

<p>
This example shows off several aspects of the new technology that
Demeter brings to bear on the EXAFS analysis problem, including fuzzy
degeneracy, virtual paths, and arbitrary single scattering paths. Read
on! 
</p>

<p>
In this first code example, <span class=program>FEFF</span> is run using a 
<span class=file>feff.inp</span> that is already on disk.  The
potential and path finder calculations are made, at lines 67.  Then
the first few paths are plotted at lines 8-13.  
</p>

<p>
Line 14 is a feature of the screen UI which is used to pause the
script until the user hits return, otherwise the plot made using
Gnuplot would blink off the screen.  The 
<tt>pause</tt> method is imported when the UI is
set to screen, as at line 3.  Without explicitly setting the screen
UI, attempting to call the <tt>pause</tt> method
will do nothing.
</p>


<pre class=olscript>
<ol class=perlblock>
<li><span class="comment">#!/usr/bin/perl
<li></span>
<li><span class="keyword">use</span> <span class="word">Demeter</span> <span class="words">qw(:plotwith=gnuplot :ui=screen)</span><span class="structure">;</span>
<li><span class="keyword">my</span> <span class="symbol">$feff</span> <span class="operator">=</span> <span class="word">Demeter::Feff</span><span class="operator">-&gt;</span><span class="word">new</span><span class="structure">(</span><span class="word">file</span><span class="operator">=&gt;</span><span class="single">'UAce/feff.inp'</span><span class="structure">);</span>
<li><span class="symbol">$feff</span> <span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="word">workspace</span><span class="operator">=&gt;</span><span class="single">'UAce'</span><span class="operator">,</span> <span class="word">screen</span><span class="operator">=&gt;</span><span class="number">0</span><span class="structure">);</span>
<li><span class="symbol">$feff</span> <span class="operator">-&gt;</span> <span class="word">potph</span><span class="structure">;</span>
<li><span class="symbol">$feff</span> <span class="operator">-&gt;</span> <span class="word">pathfinder</span><span class="structure">;</span>
<li><span class="keyword">my</span> <span class="symbol">@list</span> <span class="operator">=</span> <span class="cast">@</span><span class="structure">{</span> <span class="symbol">$feff</span><span class="operator">-&gt;</span> <span class="word">pathlist</span> <span class="structure">};</span>
<li><span class="keyword">foreach</span> <span class="structure">(</span><span class="symbol">@list</span><span class="structure">[</span><span class="number">0</span><span class="operator">..</span><span class="number">4</span><span class="structure">])</span> <span class="structure">{</span>
<li>&nbsp;&nbsp;<span class="keyword">my</span> <span class="symbol">$this</span> <span class="operator">=</span> <span class="word">Demeter::Path</span><span class="operator">-&gt;</span><span class="word">new</span><span class="structure">(</span><span class="word">parent</span><span class="operator">=&gt;</span><span class="symbol">$feff</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">sp</span><span class="operator">=&gt;</span><span class="magic">$_</span><span class="structure">);</span>
<li>&nbsp;&nbsp;<span class="symbol">$this</span><span class="operator">-&gt;</span> <span class="word">plot</span><span class="structure">(</span><span class="single">'r'</span><span class="structure">);</span>
<li><span class="structure">};</span>
<li><span class="symbol">$feff</span> <span class="operator">-&gt;</span> <span class="word">pause</span><span class="structure">(</span><span class="number">-1</span><span class="structure">);</span>
<li><span class="symbol">$feff</span> <span class="operator">-&gt;</span> <span class="word">freeze</span><span class="structure">(</span><span class="single">'UAce/uace.yaml'</span><span class="structure">);</span>
</ol>
</pre>

<p>
The state of the <span class=program>FEFF</span> calculation is frozen to disk at line 15
and will be used in the following example to import the paths.  This
is a handy trick that was not used in the previous examples.  By
freezing the <span class=program>FEFF</span> calculation, you do not have to run <span class=program>FEFF</span>
on the fly before your fit.  This will save a bit of time and,
perhaps, make development of a fitting model a bit less tedious.
</p>

<p>
Looking at the interpretation of the <span class=program>FEFF</span> calculation is
useful before launching into the fit.  This can be done with the
<tt>intrp</tt> command line tool (which has some
nice output options, including html, TeX, and ASCII-colored screen
text) or by using the 
<a href="../feff/intrp.html">intrp method</a>
in your script.
</p>

<p>
Note that, in sodium uranyl triacetate, the two dioxo scattering
paths differ in path length by about 0.006 &Aring; and the equatorial
oxygens are split into two groups of three that differ in distance
also by about 0.006 &Aring;.  In this case, the 
<a href="../feff/pathfinder.html">fuzzy degeneracy</a>
is quite helpful.  The fit is probably not so sensitive to such a
small difference in scattering length, which may not even exist in the
solution sample.  Because the degeneracy fuzz is set by default to
0.01 &Aring;, the two dioxo scatterers are made into a single
scattering path of degeneracy 2 and the 6 equatorial oxygens are made
into a single scattering path of degeneracy 6.  This simplifies the
bookkeeping aspects of creating the fitting model.
</p>

<p>
Here is the script that sets up the fitting model.
</p>


<pre class=olscript>
<ol class=perlblock>
<li><span class="comment">#!/usr/bin/perl
<li></span>
<li><span class="comment">## strict and warnings imported automatically with Demeter
<li></span><span class="keyword">use</span> <span class="word">Demeter</span> <span class="words">qw(:plotwith=gnuplot :ui=screen)</span><span class="structure">;</span>
<li>
<li><span class="word">unlink</span><span class="structure">(</span><span class="double">&quot;controlfit.iff&quot;</span><span class="structure">)</span> <span class="word">if</span> <span class="structure">(</span><span class="operator">-e</span> <span class="double">&quot;controlfit.iff&quot;</span><span class="structure">);</span>
<li>
<li><span class="keyword">my</span> <span class="symbol">$prj</span> <span class="operator">=</span> <span class="word">Demeter::Data::Prj</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">(</span><span class="word">file</span><span class="operator">=&gt;</span><span class="single">'U_DNA.prj'</span><span class="structure">);</span>
<li><span class="keyword">my</span> <span class="symbol">$data</span> <span class="operator">=</span> <span class="symbol">$prj</span> <span class="operator">-&gt;</span> <span class="word">record</span><span class="structure">(</span><span class="number">1</span><span class="structure">);</span>
<li><span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">set_mode</span><span class="structure">(</span><span class="word">screen</span>&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="number">0</span><span class="operator">,</span> <span class="word">backend</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span> <span class="word">file</span> <span class="operator">=&gt;</span> <span class="double">&quot;&gt;controlfit.iff&quot;</span><span class="structure">);</span>
<li>
<li><span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="word">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="single">'U control'</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">fft_kmin</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="float">3.0</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">fft_kmax</span>&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="float">10.5</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">bft_rmin</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">bft_rmax</span>&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="float">3.3</span><span class="operator">,</span> <span class="comment">#4.22,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">fit_space</span>&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="single">'r'</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">fit_k1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">fit_k2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">fit_k3</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">fit_do_bkg</span> <span class="operator">=&gt;</span> <span class="number">0</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li>
<li><span class="keyword">my</span> <span class="symbol">@gds</span> <span class="operator">=</span> <span class="structure">(</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess amp&nbsp;&nbsp;&nbsp;= 1&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess enot&nbsp;&nbsp;= 0&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess drax&nbsp;&nbsp;= 0&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess dreq&nbsp;&nbsp;= 0&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess drc&nbsp;&nbsp;&nbsp;= 0&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess ssax&nbsp;&nbsp;= 0.003&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess sseq&nbsp;&nbsp;= 0.003&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess ssc&nbsp;&nbsp;&nbsp;= 0.003&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess drhyd = 0&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$data</span><span class="operator">-&gt;</span><span class="word">simpleGDS</span><span class="structure">(</span><span class="double">&quot;guess sshyd = 0.003&quot;</span><span class="structure">)</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li>
<li><span class="keyword">my</span> <span class="symbol">$feff</span> <span class="operator">=</span> <span class="word">Demeter::Feff</span><span class="operator">-&gt;</span><span class="word">new</span><span class="structure">(</span><span class="word">yaml</span><span class="operator">=&gt;</span><span class="double">&quot;UAce/uace.yaml&quot;</span><span class="structure">);</span>
<li><span class="symbol">$feff</span> <span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="word">workspace</span><span class="operator">=&gt;</span><span class="double">&quot;UAce&quot;</span><span class="operator">,</span> <span class="word">screen</span><span class="operator">=&gt;</span><span class="number">0</span><span class="operator">,</span><span class="structure">);</span>
<li><span class="keyword">my</span> <span class="symbol">@list_of_paths</span> <span class="operator">=</span> <span class="cast">@</span><span class="structure">{</span> <span class="symbol">$feff</span><span class="operator">-&gt;</span><span class="word">pathlist</span> <span class="structure">};</span>
<li><span class="keyword">my</span> <span class="symbol">@paths</span> <span class="operator">=</span> <span class="structure">();</span>
<li><span class="keyword">my</span> <span class="symbol">$carbon</span>&nbsp;&nbsp;<span class="operator">=</span> <span class="word">Demeter::VPath</span><span class="operator">-&gt;</span><span class="word">new</span><span class="structure">(</span><span class="word">name</span><span class="operator">=&gt;</span><span class="double">&quot;carbon SS + MS&quot;</span><span class="structure">);</span>
<li><span class="keyword">my</span> <span class="symbol">$axialms</span> <span class="operator">=</span> <span class="word">Demeter::VPath</span><span class="operator">-&gt;</span><span class="word">new</span><span class="structure">(</span><span class="word">name</span><span class="operator">=&gt;</span><span class="double">&quot;axial MS&quot;</span><span class="structure">);</span>
<li><span class="keyword">my</span> <span class="symbol">$counter</span> <span class="operator">=</span> <span class="number">0</span><span class="structure">;</span>
<li><span class="keyword">my</span> <span class="symbol">@common</span> <span class="operator">=</span> <span class="structure">(</span><span class="word">parent</span> <span class="operator">=&gt;</span> <span class="symbol">$feff</span><span class="operator">,</span> <span class="word">data</span> <span class="operator">=&gt;</span> <span class="symbol">$data</span><span class="operator">,</span> <span class="word">s02</span> <span class="operator">=&gt;</span> <span class="double">&quot;amp&quot;</span><span class="operator">,</span> <span class="word">e0</span> <span class="operator">=&gt;</span> <span class="double">&quot;enot&quot;</span><span class="structure">);</span>
<li>
<li><span class="comment">## axial oxygen
<li></span><span class="keyword">my</span> <span class="symbol">$this_path</span> <span class="operator">=</span> <span class="word">Demeter::Path</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">()</span>
<li>&nbsp;&nbsp;<span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="symbol">@common</span><span class="operator">,</span> <span class="word">sp</span> <span class="operator">=&gt;</span> <span class="symbol">$list_of_paths</span><span class="structure">[</span><span class="symbol">$counter</span><span class="operator">++</span><span class="structure">]</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">name</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;axial oxygens&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">delr</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;drax&quot;</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">sigma2</span> <span class="operator">=&gt;</span> <span class="double">&quot;ssax&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li><span class="word">push</span> <span class="symbol">@paths</span><span class="operator">,</span> <span class="symbol">$this_path</span><span class="structure">;</span>
<li>
<li><span class="comment">## equatorial oxygen
<li></span><span class="symbol">$this_path</span> <span class="operator">=</span> <span class="word">Demeter::Path</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">()</span>
<li>&nbsp;&nbsp;<span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="symbol">@common</span><span class="operator">,</span> <span class="word">sp</span> <span class="operator">=&gt;</span> <span class="symbol">$list_of_paths</span><span class="structure">[</span><span class="symbol">$counter</span><span class="operator">++</span><span class="structure">]</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">name</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;equatorial oxygens&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">delr</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;dreq&quot;</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">sigma2</span> <span class="operator">=&gt;</span> <span class="double">&quot;sseq&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li><span class="word">push</span> <span class="symbol">@paths</span><span class="operator">,</span> <span class="symbol">$this_path</span><span class="structure">;</span>
<li>
<li><span class="comment">## carbon
<li></span><span class="symbol">$this_path</span> <span class="operator">=</span> <span class="word">Demeter::Path</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">()</span>
<li>&nbsp;&nbsp;<span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="symbol">@common</span><span class="operator">,</span> <span class="word">sp</span> <span class="operator">=&gt;</span> <span class="symbol">$list_of_paths</span><span class="structure">[</span><span class="symbol">$counter</span><span class="operator">++</span><span class="structure">]</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">name</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;C&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">delr</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;drc&quot;</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">sigma2</span> <span class="operator">=&gt;</span> <span class="double">&quot;ssc&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li><span class="word">push</span> <span class="symbol">@paths</span><span class="operator">,</span> <span class="symbol">$this_path</span><span class="structure">;</span>
<li><span class="symbol">$carbon</span><span class="operator">-&gt;</span><span class="word">include</span><span class="structure">(</span><span class="symbol">$this_path</span><span class="structure">);</span>
<li>
<li><span class="comment">## C-O triangle
<li></span><span class="symbol">$this_path</span> <span class="operator">=</span> <span class="word">Demeter::Path</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">()</span>
<li>&nbsp;&nbsp;<span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="symbol">@common</span><span class="operator">,</span> <span class="word">sp</span> <span class="operator">=&gt;</span> <span class="symbol">$list_of_paths</span><span class="structure">[</span><span class="symbol">$counter</span><span class="operator">++</span><span class="structure">]</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">name</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;C-O triangle&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">delr</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;(dreq+drc)/2&quot;</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;<span class="word">sigma2</span> <span class="operator">=&gt;</span> <span class="double">&quot;2*(sseq+ssc)/3&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li><span class="word">push</span> <span class="symbol">@paths</span><span class="operator">,</span> <span class="symbol">$this_path</span><span class="structure">;</span>
<li><span class="symbol">$carbon</span><span class="operator">-&gt;</span><span class="word">include</span><span class="structure">(</span><span class="symbol">$this_path</span><span class="structure">);</span>
<li>
<li><span class="comment">## axial oxygen rattle MS path
<li></span><span class="symbol">$this_path</span> <span class="operator">=</span> <span class="word">Demeter::Path</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">()</span>
<li>&nbsp;&nbsp;<span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="symbol">@common</span><span class="operator">,</span> <span class="word">sp</span> <span class="operator">=&gt;</span> <span class="symbol">$list_of_paths</span><span class="structure">[</span><span class="symbol">$counter</span><span class="operator">++</span><span class="structure">]</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">name</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;axial MS rattle&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">delr</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;drax*2&quot;</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;<span class="word">sigma2</span> <span class="operator">=&gt;</span> <span class="double">&quot;ssax*4&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li><span class="word">push</span> <span class="symbol">@paths</span><span class="operator">,</span> <span class="symbol">$this_path</span><span class="structure">;</span>
<li><span class="symbol">$axialms</span><span class="operator">-&gt;</span><span class="word">include</span><span class="structure">(</span><span class="symbol">$this_path</span><span class="structure">);</span>
<li>
<li><span class="comment">## axial oxygen non-forward scattering MS path
<li></span><span class="symbol">$this_path</span> <span class="operator">=</span> <span class="word">Demeter::Path</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">()</span>
<li>&nbsp;&nbsp;<span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="symbol">@common</span><span class="operator">,</span> <span class="word">sp</span> <span class="operator">=&gt;</span> <span class="symbol">$list_of_paths</span><span class="structure">[</span><span class="symbol">$counter</span><span class="operator">++</span><span class="structure">]</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">name</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;axial MS non-forward linear&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">delr</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;drax*2&quot;</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;<span class="word">sigma2</span> <span class="operator">=&gt;</span> <span class="double">&quot;ssax*2&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li><span class="word">push</span> <span class="symbol">@paths</span><span class="operator">,</span> <span class="symbol">$this_path</span><span class="structure">;</span>
<li><span class="symbol">$axialms</span><span class="operator">-&gt;</span><span class="word">include</span><span class="structure">(</span><span class="symbol">$this_path</span><span class="structure">);</span>
<li>
<li><span class="comment">## axial oxygen forward scattering through absorber MS path
<li></span><span class="symbol">$this_path</span> <span class="operator">=</span> <span class="word">Demeter::Path</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">()</span>
<li>&nbsp;&nbsp;<span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="symbol">@common</span><span class="operator">,</span> <span class="word">sp</span> <span class="operator">=&gt;</span> <span class="symbol">$list_of_paths</span><span class="structure">[</span><span class="symbol">$counter</span><span class="operator">++</span><span class="structure">]</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">name</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;axial MS forward linear&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">delr</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;drax*2&quot;</span><span class="operator">,</span>&nbsp;&nbsp;&nbsp;<span class="word">sigma2</span> <span class="operator">=&gt;</span> <span class="double">&quot;ssax*2&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li><span class="word">push</span> <span class="symbol">@paths</span><span class="operator">,</span> <span class="symbol">$this_path</span><span class="structure">;</span>
<li><span class="symbol">$axialms</span><span class="operator">-&gt;</span><span class="word">include</span><span class="structure">(</span><span class="symbol">$this_path</span><span class="structure">);</span>
<li>
<li>
<li><span class="comment">## make up a scatterer to act as the hydration sphere
<li></span><span class="keyword">my</span> <span class="symbol">$ss</span> <span class="operator">=</span> <span class="word">Demeter::SSPath</span> <span class="operator">-&gt;</span> <span class="word">new</span><span class="structure">(</span><span class="symbol">@common</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">name</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="double">&quot;hydration sphere&quot;</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">ipot</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="number">3</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">reff</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="float">3.35</span><span class="operator">,</span>
<li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">delr</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="single">'drhyd'</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">sigma2</span> <span class="operator">=&gt;</span> <span class="single">'sshyd'</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span>
<li><span class="word">push</span> <span class="symbol">@paths</span><span class="operator">,</span> <span class="symbol">$ss</span><span class="structure">;</span>
<li>
<li>
<li><span class="keyword">my</span> <span class="symbol">$fit</span> <span class="operator">=</span> <span class="word">Demeter::Fit</span><span class="operator">-&gt;</span><span class="word">new</span><span class="structure">(</span><span class="word">gds</span>&nbsp;&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="cast">\</span><span class="symbol">@gds</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">data</span>&nbsp;&nbsp;<span class="operator">=&gt;</span> <span class="structure">[</span><span class="symbol">$data</span><span class="structure">]</span><span class="operator">,</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">paths</span> <span class="operator">=&gt;</span> <span class="cast">\</span><span class="symbol">@paths</span><span class="operator">,</span> <span class="structure">);</span>
<li><span class="symbol">$fit</span> <span class="operator">-&gt;</span> <span class="word">fit</span><span class="structure">;</span>
<li><span class="symbol">$fit</span> <span class="operator">-&gt;</span> <span class="word">logfile</span><span class="structure">(</span><span class="double">&quot;controlfit.log&quot;</span><span class="operator">,</span> <span class="double">&quot;U control&quot;</span><span class="operator">,</span> <span class="literal">q{}</span><span class="structure">);</span>
<li>
<li><span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">po</span> <span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="word">kweight</span><span class="operator">=&gt;</span><span class="number">2</span><span class="operator">,</span> <span class="word">rmax</span><span class="operator">=&gt;</span><span class="number">6</span><span class="operator">,</span> <span class="word">r_pl</span><span class="operator">=&gt;</span><span class="single">'r'</span><span class="operator">,</span> <span class="word">plot_fit</span><span class="operator">=&gt;</span><span class="number">1</span><span class="structure">);</span>
<li><span class="keyword">my</span> <span class="structure">(</span><span class="symbol">$step</span><span class="operator">,</span> <span class="symbol">$jump</span><span class="structure">)</span> <span class="operator">=</span> <span class="structure">(</span><span class="number">0</span><span class="operator">,</span><span class="float">-0.3</span><span class="structure">);</span>
<li><span class="word">map</span> <span class="structure">{</span><span class="magic">$_</span><span class="operator">-&gt;</span><span class="word">data</span><span class="operator">-&gt;</span><span class="word">y_offset</span><span class="structure">(</span><span class="symbol">$step</span><span class="structure">);</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="magic">$_</span><span class="operator">-&gt;</span><span class="word">plot</span><span class="structure">(</span><span class="single">'r'</span><span class="structure">);</span>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$step</span><span class="operator">+=</span><span class="symbol">$jump</span><span class="structure">;</span>
<li>&nbsp;&nbsp;&nbsp;<span class="structure">}</span> <span class="structure">(</span><span class="symbol">$data</span><span class="operator">,</span> <span class="symbol">$paths</span><span class="structure">[</span><span class="number">0</span><span class="structure">]</span><span class="operator">,</span> <span class="symbol">$paths</span><span class="structure">[</span><span class="number">1</span><span class="structure">]</span><span class="operator">,</span> <span class="symbol">$carbon</span><span class="operator">,</span> <span class="symbol">$axialms</span><span class="operator">,</span> <span class="symbol">$ss</span><span class="structure">);</span>
<li>
<li><span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">pause</span><span class="structure">;</span>
</ol>
</pre>

<p>
 
There are a lot of interesting things going on in this fit:
</p>


<ol>
  
<li><p>
At line 4, I turn on the gnuplot plotting backend and enable
the screen UI features that make Demeter more pleasant to use at the 
<a href="../ui.html">command line</a>.
</p></li>
<li><p>
At lines 8-18, I import the uranyl data from an Athena project file
and set various data and plotting parameters. 
</p></li>
<li><p>
In lines 20-31, I define the guess parameters using a bit of syntactic
sugar. I could just as well have written have use the
<a href="../gds/index.html">normal interface</a>.
</p></li>
<li><p>
At lines 33-35, I import the results of a Feff calculation that I had
previously made using the first <span class=program>DEMETER</span> script on this page.
</p></li>
<li><p>
At line 37 and 38, I create two <a href="../pathlike/vpath.html">VPaths</a>, or virtual
paths. These get filled up at lines 65, 74, 83, 92, and 101. 
</p></li>
<li><p>
At line 40, I define some Path attributes that will be used in common
for all Path objects defined.
</p></li>
<li><p>
At lines 105-113, I create an arbitrary single scatering path from the
oxygen using the 
<a href="../pathlike/sspath.html">SSPath object</a>
at a distance where I consider it reasonable to see scattering from
the hydration sphere. This SSPath then gets included in the fit like a
normal Path.
</p></li>
<li><p>
At lines 122-127, I do a bit of trickery to make the spiffy stacked
plot shown below.  Note that the VPath and SSPath objects get plotted
in the same way as the Data and Paths.  Indeed, the plot is
accomplished by looping over all the objects that I want to display in
the plot.  Note the use of the <tt>data</tt>
attribute at line 124.  The <tt>y_offset</tt> is an
attribute of the Data object.  A path-like object gets its value of
<tt>y_offset</tt> from its associated Data object.
A Data object is its own <tt>data</tt> attribute.
This little idiom is the way of always setting something like
<tt>y_offset</tt> to what it needs to be to plot
the current object in a loop.
</p></li>
<li><p>
The last line pauses the script before terminating so
that you have time to examine the plot.  The Gnuplot process ends when
the script ends, making the plot window go away.
</p></li>
</ol>

<table>
<tr>
<td>
<p>

The fit as &chi;(k).  This was made by substituting lines 122-127 with:
<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">po</span> <span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="word">kweight</span><span class="operator">=&gt;</span><span class="number">2</span><span class="operator">,</span> <span class="word">plot_fit</span><span class="operator">=&gt;</span><span class="number">1</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="keyword">my</span> <span class="structure">(</span><span class="symbol">$step</span><span class="operator">,</span> <span class="symbol">$jump</span><span class="structure">)</span> <span class="operator">=</span> <span class="structure">(</span><span class="number">0</span><span class="operator">,</span><span class="float">-0.5</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="word">map</span> <span class="structure">{</span><span class="magic">$_</span><span class="operator">-&gt;</span><span class="word">data</span><span class="operator">-&gt;</span><span class="word">y_offset</span><span class="structure">(</span><span class="symbol">$step</span><span class="structure">);</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="magic">$_</span><span class="operator">-&gt;</span><span class="word">plot</span><span class="structure">(</span><span class="single">'k'</span><span class="structure">);</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$step</span><span class="operator">+=</span><span class="symbol">$jump</span><span class="structure">;}</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">(</span><span class="symbol">$data</span><span class="operator">,</span> <span class="symbol">$paths</span><span class="structure">[</span><span class="number">0</span><span class="structure">]</span><span class="operator">,</span> <span class="symbol">$paths</span><span class="structure">[</span><span class="number">1</span><span class="structure">]</span><span class="operator">,</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$carbon</span><span class="operator">,</span> <span class="symbol">$axialms</span><span class="operator">,</span> <span class="symbol">$ss</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">plot_window</span><span class="structure">(</span><span class="single">'k'</span><span class="structure">);</span>
</ol>
</p>

</td>
<td width=640>
<a href="../../images/uranyl_k.png" target=_blank><img border=0 src="../../images/uranyl_k.png" alt="uranyl_k.png" width=100%></a>
</td>
</tr>
</table>

<table>
<tr>
<td>
<p>

The fit as the magnitude of &chi;(R).  This was made by substituting lines 122-127 with:
<ol class=perlsample>
<br />
&nbsp;&nbsp;<span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">po</span> <span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="word">kweight</span><span class="operator">=&gt;</span><span class="number">2</span><span class="operator">,</span> <span class="word">plot_fit</span><span class="operator">=&gt;</span><span class="number">1</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">po</span> <span class="operator">-&gt;</span> <span class="word">set</span><span class="structure">(</span><span class="word">r_pl</span> <span class="operator">=&gt;</span> <span class="single">'m'</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="keyword">my</span> <span class="structure">(</span><span class="symbol">$step</span><span class="operator">,</span> <span class="symbol">$jump</span><span class="structure">)</span> <span class="operator">=</span> <span class="structure">(</span><span class="number">0</span><span class="operator">,</span><span class="float">-0.25</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="word">map</span> <span class="structure">{</span><span class="magic">$_</span><span class="operator">-&gt;</span><span class="word">data</span><span class="operator">-&gt;</span><span class="word">y_offset</span><span class="structure">(</span><span class="symbol">$step</span><span class="structure">);</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="magic">$_</span><span class="operator">-&gt;</span><span class="word">plot</span><span class="structure">(</span><span class="single">'r'</span><span class="structure">);</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$step</span><span class="operator">+=</span><span class="symbol">$jump</span><span class="structure">;}</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">(</span><span class="symbol">$data</span><span class="operator">,</span> <span class="symbol">$paths</span><span class="structure">[</span><span class="number">0</span><span class="structure">]</span><span class="operator">,</span> <span class="symbol">$paths</span><span class="structure">[</span><span class="number">1</span><span class="structure">]</span><span class="operator">,</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$carbon</span><span class="operator">,</span> <span class="symbol">$axialms</span><span class="operator">,</span> <span class="symbol">$ss</span><span class="structure">);</span><br />
&nbsp;&nbsp;<span class="symbol">$data</span> <span class="operator">-&gt;</span> <span class="word">plot_window</span><span class="structure">(</span><span class="single">'r'</span><span class="structure">);</span>
</ol>
</p>

</td>
<td width=640>
<a href="../../images/uranyl_rmag.png" target=_blank><img border=0 src="../../images/uranyl_rmag.png" alt="uranyl_rmag.png" width=100%></a>
</td>
</tr>
</table>

<table>
<tr>
<td>
<p>

The fit as the real part of &chi;(R).  This is the plot that is made
by lines 122-127.
</p>

</td>
<td width=640>
<a href="../../images/uranyl_rre.png" target=_blank><img border=0 src="../../images/uranyl_rre.png" alt="uranyl_rre.png" width=100%></a>
</td>
</tr>
</table>

</div>

<br />
<hr class=hide />
<hr class=bottomdivider />

<div class=bottombar>
  <div class=copyright>
  <table>
    <tr>
      <td colspan=2>
        <span class=program>DEMETER</span> is copyright &copy; 2009-2012 Bruce Ravel
        &mdash;
        This document is copyright &copy; 2012 Bruce Ravel
        <br />
      </td>
    </tr>
    <tr valign=middle>
      <td> 
           <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../../images/somerights20.png" width="88" height="31" alt="" border="0" /></a> &nbsp;&nbsp;&nbsp;
      </td>
      <td>
  	This document is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">
  	The Creative Commons Attribution-ShareAlike License</a>.
  	<br />
  	If <span class=program>DEMETER</span> and this document are useful to you, please consider
  	<a href="http://creativecommons.org/support/">supporting The Creative Commons</a>.
      </td>
    </tr>
  </table>
</div>
</div>
  </body>
</html>