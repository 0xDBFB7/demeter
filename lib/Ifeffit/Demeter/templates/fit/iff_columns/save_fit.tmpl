{ # -*- ifm -*-
  # save fit template
  #   {$D} returns the ifeffit group name
  #   {$D->get("parameter")} returns the value of that parameter
  # the filename and titles were passed to the template method
  # $titles should contain a string that Ifeffit will be able to
  # interpret as a set of title lines already set in Ifeffit.  one
  # common way of doing this is with a glob structure, like
  # $dem_data_*
  # example:
  #   $string = $self->template("process", "save_chik",
  #                             {filename=>$filename, titles=>"\$dem_data_*"});
}
{
  ($bkg, $label) = ($D->get('fit_do_bkg'))
                 ? ($D."_bkg.chi,\n           ", "k chi fit residual background window")
                 : (q{}, "k chi fit residual win");
  q{}
}
write_data(file  = "{$filename}",
           label = "{$label}",
           ${$titles},
	   ${$D}_title_*,
           {$D}.k,
	   {$D}.chi,
	   {$D}_fit.chi,
	   {$D}_res.chi,
	   {$bkg}{$D}.win)
