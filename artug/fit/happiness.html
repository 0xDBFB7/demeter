<!DOCTYPE HTMP PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>The heuristic happiness parameter</title>
    <link rel="stylesheet" href=../ab.css />
    <link rel="stylesheet" href=../ppi.css />
    <meta http-equiv="Content-Type" content="text/html"; charset=iso-8859-15 />
    <meta name="robots" contents="all" />
  </head>

  <body>
    <div class=topbar>
  <div class=navbar>
  <a class=navhead href="../index.html">The Artemis Users' Guide</a>
  <table class=navtable>
    <tr>
      <td align=left>
        [&nbsp;<a class=navtable href="http://bruceravel.github.com/demeter/"><span class=programlink>DEMETER</span></a>&nbsp;] &nbsp;
        [&nbsp;<a class=navtable href="http://cars9.uchicago.edu/iffwiki/Ifeffit"><span class=programlink>IFEFFIT</span></a>&nbsp;] &nbsp;
        <!-- [&nbsp;<a class=navtable href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"><span class=programlink>FEFF</span></a>&nbsp;] &nbsp; -->
        [&nbsp;<a class=navtable href="http://xafs.org">xafs.org</a>&nbsp;] &nbsp;
	<!-- [&nbsp;<a class=navtable href="../demeter.pdf">PDF&nbsp;doc</a>&nbsp;] -->
      </td>
      <td align=right>
        Back: <a class=navtable href="../fit/sanity.html" class="menu">Sanity checking your model</a> &nbsp;&nbsp;
        &nbsp;&nbsp;
        Up: <a class=navtable href="../fit/index.html" class="menu">Running a fit</a> &nbsp;&nbsp;
        Next: <a class=navtable href="../fit/pathlike.html" class="menu">Using path-like objects</a>      </td>
    </tr>
  </table>
  </div>
</div>

<div class=sidebar>
  <a href="../diana.html"><img src=../../images/Artemis_logo.jpg
    width=90% border=0 alt='[Demeter logo]'></a>
  <br />
  <a href="../index.html"  class="menu">Home</a><br />
<a href="../intro.html"  class="menu">Introduction</a><br />
<a href="../startup/index.html"  class="menu">Starting Artemis</a><br />
<a href="../data.html"  class="menu">The Data window</a><br />
<a href="../feff/index.html"  class="menu">The Atoms/Feff window</a><br />
<a href="../path/index.html"  class="menu">The Path page</a><br />
<a href="../gds.html"  class="menu">The GDS window</a><br />
<a href="../fit/index.html"  class="menuselect">Running a fit</a><br />
&nbsp;&#8618;&nbsp;<a href="../fit/sanity.html"  class="menu">Sanity checking your model</a><br />
&nbsp;&#8618;&nbsp;<span style="font-style: italic;">The happiness parameter</span><br />
&nbsp;&#8618;&nbsp;<a href="../fit/pathlike.html"  class="menu">Using path-like objects</a><br /><a href="../plot/index.html"  class="menu">The Plot window</a><br />
<a href="../logjournal.html"  class="menu">The Log & Journal windows</a><br />
<a href="../history.html"  class="menu">The History window</a><br />
<a href="../monitor.html"  class="menu">Monitoring things</a><br />
<a href="../prefs.html"  class="menu">Managing preferences</a><br />
<a href="../examples/index.html"  class="menu">Worked examples</a><br />
<a href="../extended/index.html"  class="menu">Extended topics</a><br />
</div>

<div class=contentarea>


<h1>
  The heuristic happiness parameter
</h1>

<p>
<span class=program>ARTEMIS</span> evaluates a variety of statistical parameters relevant to
the evaluation of your fit.  These include the fitting metric
&chi;&sup2;, the fitting metric normalized by the degrees of freedom in
the fit &chi;&sup2<sub>&nu;</sub>, an R-factor, and uncertainties on and correlations
between the variable parameters.
</p>

<p>
In a formal sense, the most important of these parameters is
&chi;&sup2<sub>&nu;</sub>, which is the statistical parameter allowing you to
distinguish between different fitting models applied to the same data.
Unfortunately, &chi;&sup2<sub>&nu;</sub> is difficult to interpret directly.  In
practice, the EXAFS analysis problem using <span class=program>FEFF</span> is not a
well-posed problem in the sense required by Gaussian statistics.  This
is true for a variety of reasons.  In EXAFS, the signal is not ideally
packed &ndash; that is, the signal is not composed of pure sine waves.  In
general, you cannot guarantee that errors in your fitting parameters
are normally distributed.  In general, we cannot actually identify and
enumerate all sources of measurement error, many of which are complex
and systematic, such as sample inhomogeneity, detector non-linearity,
and so on.  Finally, we do not know the true line shape of our signal
&ndash; instead we use <span class=program>FEFF</span> to approximate the lineshape.
</p>

<p>
For all those reasons, &chi;&sup2<sub>&nu;</sub> is rarely &ndash; if ever &ndash; close to 1 as
expected for a good fit.  Although &chi;&sup2<sub>&nu;</sub> for different fitting
models can be compared effectively, it is, generally speaking, not a
sufficient criterion for evaluating the quality of an individual fit.
</p>

<p>
Happily, this is not an insolvable problem.  After decades of
analyzing EXAFS data, using <span class=program>FEFF</span>, and using <span class=program>IFEFFIT</span>, we know a
lot about what constitutes a good fit.  For instance, a good fit has a
small R-factor, which is a measure of the percentage misfit between
the data and theory.  We know things about individual parameter types,
e.g. that an E&#8320; is rarely more than 10 eV or less than -10 eV,
that S&sup2;&#8320; and &sigma;&sup2; should never be negative.  We know that a
robust fit does not have excessive correlation between variable
parameters.
</p>

<p>
<span class=program>ARTEMIS</span> offers a heuristic tool called &ldquo;happiness&rdquo; which is an attempt to enumerate the knowledge and
experience we bring to a fit.  After a fit, this heuristic parameter
is evaluated and reported in the log file.  It has no meaning other
that to give you a general sense of how the fit came out.
</p>

<p>
<p class=caution>
<img class=tinyfloatleft border=0 src="../../images/alert.png" alt="Caution!">
The word &ldquo;happiness&rdquo; was chosen for this
parameter because it is a silly word in a statistics context.
Happiness is an ad-hoc, semantic metric.  It has no basis in formal
statistics.  It is essentially meaningless and should <strong>NEVER</strong> be published.  <strong>NEVER</strong>!
</p>
</p>




<hr class=hide />
<a name="evaluationofthehappinessparameter">

<h2>  Evaluation of the happiness parameter</h2>
</a>

<p>
The happiness parameter begins with a value of 100, indicating
complete happiness.  After the fit is evaluated, a series of tests are
run against the fitting results.  If a test hits, it removes points
from the happiness.  The final evaluation is reported in the log file
and used to color the Fit and plot buttons.
</p>


<dl>
  
<dt>
  R-factor
</dt>
<dd>
Assess a penalty for an R-factor that is larger than 0.02.  That is,
any fit which has 2% or less misfit between data and theory is not
assessed a penalty.  Above that, the penalty scales linearly in
R-factor up to a maximum penalty of 40.
  <br />
  <br />
</dd>
<dt>
  Parameter values
</dt>
<dd>
After every path parameter for every path is evaluated, assess a
penalty of 2 for each path parameter that fails a sanity check.  The
sanity checks include checking that E&#8320; is not too large either
positively or negatively, checking that neither of S&sup2;&#8320; or
&sigma;&sup2; is negative, and checking that neither of &sigma;&sup2; or
&Delta;R is too large.
  <br />
  <br />
</dd>
<dt>
  Restraints
</dt>
<dd>
If any restraints are placed upon the fit, assess a penalty for every
restraint which evaluates to something non-zero.  The penalty scales
linearly with the size of the evaluated restraint.
  <br />
  <br />
</dd>
<dt>
  Number of independent points
</dt>
<dd>
Assess a penalty if the number of guess parameters is larger than 2/3
of the total number of independent points as evaluated by the Nyquist
criterion.  Above the 2/3 threshold, the penalty scales linearly.
  <br />
  <br />
</dd>
<dt>
  Correlations
</dt>
<dd>
Assess a penalty for each correlation that exceeds a cutoff value.
  <br />
  <br />
</dd>
<dt>
  Penalty parameters
</dt>
<dd>
Assess a penalty equal to the evaluation of a penalty parameter.
<p class=todo>
<img class=tinyfloatleft border=0 src="../../images/todo.png" alt="To do!">
Penalty parameters have not yet been implemented.
</p>
  <br />
  <br />
</dd>
</dl> 




<hr class=hide />
<a name="configuringthehappinessevaluation">

<h2>  Configuring the happiness evaluation</h2>
</a>

<p>
Note that everything above is something that Bruce made up out of
whole cloth, inlcuding the parametrization.  That said, every part of
the happiness calculation is configurable.  That means that you, the
user, can tune the happiness evaluation to report on fit quality in a
way that is meaningful and useful for your data and your fits.
</p>

<p>
The configuration parameters are spread over <a href="../prefs.html">two configuration groups</a>.  The
parameters in the Happiness group control the evaluation of the
penalties.  Those in the Warning group control the assessment of path
parameter values.
</p>

<p>
For example, to tune the assessment of the penalty for an excessive
number of guess parameters, you can change two configuration parameters.
<span class=pref>&diams;Happiness&nbsp;&rarr;&nbsp;nidp_cutoff</span>
default to 2/3 and sets the cutoff below which no penalty is
assessed.  This parameter is interpreted as a fraction of total number
of independent points in the fit. 
<span class=pref>&diams;Happiness&nbsp;&rarr;&nbsp;nidp_scale</span>
sets the maximum penalty to assess for using up all the independent points.
</p>

<p>
The path parameter penalties can also be fine tuned.  A couple examples: the
value above which a penalty is assessed for an excessively large
E&#8320; is set with 
<span class=pref>&diams;Warnings&nbsp;&rarr;&nbsp;e0_max</span> and the
assessment of a penalty for a negative &sigma;&sup2; can be turned off by
toggling <span class=pref>&diams;Warnings&nbsp;&rarr;&nbsp;ss2_neg</span>.
</p>

<p>
Since this happiness thing is an artificial and statistically
meaningless creation, it can be changed as you like.  Do you have any
ideas for penalty assessments?  Let Bruce know!  Do you have a
suggestion for how the existing penalties should be tuned?  Send your
configuration parameter values to Bruce!
</p>

</div>

<br />
<hr class=hide />
<hr class=bottomdivider />

<div class=bottombar>
  <div class=copyright>
  <table>
    <tr>
      <td colspan=2>
        <span class=program>DEMETER</span> is copyright &copy; 2009-2012 Bruce Ravel
        &mdash;
        This document is copyright &copy; 2012 Bruce Ravel
        <br />
      </td>
    </tr>
    <tr valign=middle>
      <td> 
           <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../../images/somerights20.png" width="88" height="31" alt="" border="0" /></a> &nbsp;&nbsp;&nbsp;
      </td>
      <td>
  	This document is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">
  	The Creative Commons Attribution-ShareAlike License</a>.
  	<br />
  	If <span class=program>DEMETER</span> and this document are useful to you, please consider
  	<a href="http://creativecommons.org/support/">supporting The Creative Commons</a>.
      </td>
    </tr>
  </table>
</div>
</div>
  </body>
</html>