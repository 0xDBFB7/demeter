<!DOCTYPE HTMP PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>The Paths tab</title>
    <link rel="stylesheet" href=../artug.css />
    <link rel="stylesheet" href=../ppi.css />
    <meta http-equiv="Content-Type" content="text/html"; charset=iso-8859-15 />
    <meta name="robots" contents="all" />
  </head>

  <body>
    <div class=topbar>
  <div class=navbar>
  <a class=navhead href="../index.html">The Artemis Users' Guide</a>
  <table class=navtable>
    <tr>
      <td align=left>
        &laquo;<a class=navtable href="http://bruceravel.github.io/demeter/"><span class=programlink>DEMETER</span></a>&raquo; &nbsp;
        &laquo;<a class=navtable href="https://github.com/newville/ifeffit"><span class=programlink>IFEFFIT</span></a>&raquo; &nbsp;
        <!-- [&nbsp;<a class=navtable href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"><span class=programlink>FEFF</span></a>&nbsp;] &nbsp; -->
        &laquo;<a class=navtable href="http://xafs.org">xafs.org</a>&raquo; &nbsp;
	<!-- [&nbsp;<a class=navtable href="../demeter.pdf">PDF&nbsp;doc</a>&nbsp;] -->
      </td>
      <td align=right>
        Back: <a class=navtable href="../feff/feff.html" class="menu">The Feff tab</a> &nbsp;&nbsp;
        &nbsp;&nbsp;
        Up: <a class=navtable href="../feff/index.html" class="menu">The Atoms/Feff window</a> &nbsp;&nbsp;
        Next: <a class=navtable href="../feff/pathlike.html" class="menu">The Path-like tab</a>      </td>
    </tr>
  </table>
  </div>
</div>

<div class=sidebar>
  <a href="../diana.html"><img src=../../images/Artemis_logo.jpg
    width=90% border=0 alt='[Artemis logo]'></a>
  <br />
  <a href="../index.html"  class="menu">Home</a><br />
<a href="../intro.html"  class="menu">Introduction</a><br />
<a href="../startup/index.html"  class="menu">Starting Artemis</a><br />
<a href="../data.html"  class="menu">The Data window</a><br />
<a href="../feff/index.html"  class="menuselect">The Atoms/Feff window</a><br />
&nbsp;&#8618;&nbsp;<a href="../feff/feff.html"  class="menu">The Feff tab</a><br />
&nbsp;&#8618;&nbsp;<span style="font-style: italic;">The Paths tab</span><br />
&nbsp;&#8618;&nbsp;<a href="../feff/pathlike.html"  class="menu">The Path-like tab</a><br />
&nbsp;&#8618;&nbsp;<a href="../feff/console.html"  class="menu">The Console tab</a><br />
&nbsp;&#8618;&nbsp;<a href="../feff/aggregate.html"  class="menu">Aggregate calculation</a><br /><a href="../path/index.html"  class="menu">The Path page</a><br />
<a href="../gds.html"  class="menu">The GDS window</a><br />
<a href="../fit/index.html"  class="menu">Running a fit</a><br />
<a href="../plot/index.html"  class="menu">The Plot window</a><br />
<a href="../logjournal.html"  class="menu">The Log & Journal windows</a><br />
<a href="../history.html"  class="menu">The History window</a><br />
<a href="../monitor.html"  class="menu">Monitoring things</a><br />
<a href="../prefs.html"  class="menu">Managing preferences</a><br />
<a href="../examples/index.html"  class="menu">Worked examples</a><br />
<a href="../atoms/index.html"  class="menu">Crystallography for EXAFS</a><br />
<a href="../extended/index.html"  class="menu">Extended topics</a><br />
</div>

<div class=contentarea>


<h1>
  The Paths tab
</h1>

<p>
When you click the &ldquo;Run Feff&rdquo; button on
the <span class=program>FEFF</span> tab, the <span class=program>FEFF</span> calculation is run.  Once finished, a
succinct summary of the calculation is displayed on the Paths tab.
</p>


<div class=figure style="max-width: 597px; min-width: 7em;">
<a name=feff-paths>
<img src=../../images/feff-paths.png width=100%>
</a>
<p align=center>
The Paths tab.
</p>
</div>

<p>
Some statistics about the <span class=program>FEFF</span> calculation are shown in the
Description text box.  Below that is the summary of the paths found in
the <span class=program>FEFF</span> calculation.  This summary is presented in the form of a
table.  Each row describes a scattering path.  The columns contain the
following information:
</p>

<p>
<ol>
  
<li><p>
The first column shows a path index, similar to the index that
<span class=program>FEFF</span> uses when run by hand from the command line.
</p></li>
<li><p>
The second column shows the degeneracy of the path.  
</p></li>
<li><p>
The third column
shows its nominal path length, R<sub>eff</sub>.  That is value that will be
used in any 
<a href="../path/mathexp.html">path parameter math expression</a>
containing the 
<tt>reff</tt> token.
</p></li>
<li><p>
The fourth column shows a simple view of the scattering path.  The 
<tt>@</tt> token represents the absorber, thus
appears as  the first and last token in each description.  The tokens
representing the scattering atoms are taken from the tags on the
<span class=program>FEFF</span> tab.  You can change the absorber token by setting the
<span class=pref>&diams;Pathfinder&nbsp;&rarr;&nbsp;token</span>
configuration parameter.
</p></li>
<li><p>
The fifth column contains the rank of the path.  This is an attempt
to predict how important of each path will be to your fitting model.
Paths with large spectral weight have a large rank and paths with
little spectral weight have small rank.  Highly ranked paths are
colored <span style="color:#046a15; background-color:white">green</span>, mid-rank
paths are colored <span style="color:#78670e; background-color:white">yellow</span>,
and low-rank paths are <span style="color:#787878; background-color:white">grey</span>.
Don't  put too much faith in this assessment of importance.  You
should explicitly check all paths to decide if they should be included
in a fit.
</p></li>
<li><p>
The sixth column gives the number of legs in each path.  
</p></li>
<li><p>
The final
column is a simple explanation of the shape of the scattering
geometry.
</p></li>
</ol>
</p>

<p>
The rows in this table are selectable by mouse click.  Left clicking
on a row selects that row.  Control clicking on another row adds it to
the selection.  Shift clicking adds to the selection all rows between
the one clicked upon and the previously clicked upon row.
</p>

<p>
Much of the functionality of this page rests upon the set of selected
paths.  Most importantly, selecting paths is the first step to using
paths in a fitting model.  This will be explained in the 
<a href="../path/index.html">next chapter</a>.
</p>

<p>
At the top of the page is a bar of buttons used to perform tasks
specific to the path list.  The &ldquo;Doc&rdquo;
button will open a browser displaying this documentation for the
interpretation page.  The &ldquo;Rank&rdquo; button is
described below.  The remaining buttons are related to making plots of
the selected paths.
</p>


<hr class=hide />
<a name="pathplottingandpathgeometry">
<p>&nbsp;</p>
</a>

<h2>  Path plotting and path geometry</h2>


<p>
<a class=floatleft href="../../images/feff-plot.png" target=_blank><img border=0 src="../../images/feff-plot.png"   alt="feff-plot.png"></a>
This is a plot of paths from the raw <span class=program>FEFF</span> calculation.  In this
example, the first three single scattering paths from the sodium
uranyl triacetate calculation were selected along with a low-rank
multiple scattering path.  Then the &ldquo;Plot
selection&rdquo; button was pressed.  In this plot, we see that the three
single scattering paths are, indeed, quite large.  The multiple
scattering path can barely be seen on this scale.  It truly is a low
importance path.
</p>

<p>
The meaning of a &ldquo;raw&rdquo; <span class=program>FEFF</span> calculation
is that it is displayed as &chi;(k) with S&sup2;&#8320; set to 1.0 and each
of E&#8320;, &Delta;R, and &sigma;&sup2; set to 0.  A plot of &chi;(R) for
the &ldquo;raw&rdquo; <span class=program>FEFF</span> calculation, then,
displays the Fourier transform of &chi;(k) parameterized with those
values.
</p>

<p>
It is, therefore, very quick and easy to examine the results of a
<span class=program>FEFF</span> calculation.  The other four buttons are used to select how
the plot of paths is made.  The options are &chi;(k), |&chi;(R)|,
Re[&chi;(R)], and Im[&chi;(R)].  The k-weight selected in the Plot
window is used to make the plot of paths.
</p>

<p>
Right clicking on an entry in the paths list will post a menu.  The
first item on the menu opens a dialog window with more details about
the geomtery of the selected scattering path.  In the following
figure, the selected path (0006) was right-clicked on, opening the
dialog depicted below.
</p>

<p>
The other context menu options are used to set the path select on the
basis of distance, ranking, or scattering geometry.  These options are
useful for selecting groups of paths to drag and drop onto the Data
window.
</p>

<div class=figure style="max-width: 548px; min-width: 7em;">
<a name=feff-pathsinfo>
<img src=../../images/feff-pathsinfo.png width=100%>
</a>
<p align=center>
Information about the geometry of a scattering path.
</p>
</div>

<p>
The contents of the path interpretation can be filtered after running
the <span class=program>FEFF</span> calculation by setting the 
<span class=pref>&diams;Pathfinder&nbsp;&rarr;&nbsp;postcrit</span>
parameter.  By default, it is set to 3, which means that only paths
with a ranking above 3 will be displayed in the path interpretation.
Resetting this parameter allows you tune how many paths get displayed
after the calculation.
</p>


<hr class=hide />
<a name="pathranking">
<p>&nbsp;</p>
</a>

<h2>  Path ranking</h2>

<p>
<span class=program>FEFF</span> provides a crude evaluation of the importance of each path
called the &ldquo;curved wave importance factor&rdquo;.
This is computed as a very sparse &ndash; computed at four points
between 0 &Aring;&#8315;&sup1; and 20 &Aring;&#8315;&sup1; &ndash; trapezoidal integration of
|&chi;(k)|.  This amplitude is then expressed as a percentage
with the largest path having an amplitude of 100.  
</p>

<p>
There are a few shortcomings of <span class=program>FEFF</span>'s amplitude factor.  
First, the percentages are computed serially.  So the frist path is
always given as 100%.  If a subsequent path is larger than the first
path, it, so, will be given as 100%.  All following paths will be
scaled to size of the later path.  This is somewhat confusing.
</p>

<p>
Second, the integration is very sparse.  This made sense back in the
mid-90s, when computers were slower and had less memory.  But it means
the amplitude is not very accurate.
</p>

<p>
Finally, the integration is over a much wider range in k-space than is
typically measured in a real experiment.  It would make more sense to
evaluate a measure of the importance of a path over a range in k that
is expressed in a real measurement or, at least, a range that is more
typical of a normal experiment.
</p>

<p>
To this end, <span class=program>ARTEMIS</span> offers a variety of new ways to rank the
importance of a path.  Some use &chi;(k) and some use &chi;(R) of the
paths.  All are evaluated over a restricted range in k or R.  By
default, the range in k is 3 &Aring;&#8315;&sup1; and 12 &Aring;&#8315;&sup1; and in R it is 1
&Aring; and 4 &Aring;.  All are evaluated using the full k or R grid
which is used internally.  Some consider k-weighting.
</p>

<p>
They all have funny acronyms:
<dl>
  
<dt>
  akc
</dt>
<dd>
This is the sum over the k-range of the absolute value of k&middot;&chi;(k).
  <br />
  <br />
</dd>
<dt>
  aknc
</dt>
<dd>
This is the sum over the k-range of the absolute value of
k<sup>n</sup>&middot;&chi;(k) where the plotting k-weight is used for n.
  <br />
  <br />
</dd>
<dt>
  sqkc
</dt>
<dd>
This is the square root of the sum over the k-range of the square of k&middot;&chi;(k).
  <br />
  <br />
</dd>
<dt>
  sqknc
</dt>
<dd>
This is the square root of the sum over the k-range of the square of k<sup>n</sup>&middot;&chi;(k)
where the plotting k-weight is used for n.
  <br />
  <br />
</dd>
<dt>
  mkc
</dt>
<dd>
This is the sum over the k-range of k&middot;|&chi;(k)|.
  <br />
  <br />
</dd>
<dt>
  mknc
</dt>
<dd>
This is the sum over the k-range of k<sup>n</sup>&middot;|&chi;(k)|
where the plotting k-weight is used for n.
  <br />
  <br />
</dd>
<dt>
  mft
</dt>
<dd>
This is the maximum value of |&chi;(R)| within the R-range
where the plotting k-weight is used for the Fourier transform.
  <br />
  <br />
</dd>
<dt>
  sft
</dt>
<dd>
This is the sum over the R-range of |&chi;(R)|
where the plotting k-weight is used for the Fourier transform.
  <br />
  <br />
</dd>
</dl>
</p>

<p>
These new ranking criteria tend to do a better job of correctly
predicting which paths are important to a fit.  That's a good
thing.  The bad thing is that they take quite a bit longer to compute
than simply relying on <span class=program>FEFF</span>'s amplitude ratios.
</p>

<p>
The full suite of options are provided in order to replicate the
analysis shown in the paper by K. Provost, et al.  The 
&ldquo;akc&rdquo; and &ldquo;aknc&rdquo;
choices tend to be reliable.
</p>

<p>
You can select which criterion to use on the interpretation page by
setting the
<span class=pref>&diams;Pathfinder&nbsp;&rarr;&nbsp;rank</span>
configuration parameter to &ldquo;feff&rdquo; or to one
of the acronyms above.
</p>

<p>
You can compare the evaluations of the ranking criteria by pressing
the &ldquo;Rank&rdquo; button in the toolbar.  This
calculation takes about a third of a second per path.  If there are a
lot of paths in the interpretation, this can be a bit time consuming.
At the end, a text dialog with the various rankings for each path is
displayed.  As can be seen in the figure below, there is some
variation between the criteria, but all of them differ substantially
from <span class=program>FEFF</span>'s importance factors.
</p>

<p>
<div class=figure style="max-width: 481px; min-width: 7em;">
<a name=feff-rank>
<img src=../../images/feff-rank.png width=100%>
</a>
<p align=center>
The report on the path ranking calculation.
</p>
</div>
</p>

<p>
This improvement upon <span class=program>FEFF</span>'s path selection tool is
adapted from 
K. Provost et al., <em>J. Synchrotron Radiat.</em>, <strong></strong>
(2014), <em>submitted</em>.
</p>

<p>
None of the path ranking criteria currently use &sigma;&sup2; when they
are being evaluated, but that would be an interesting consideration.
</p>

</div>

<br />
<hr class=hide />
<hr class=bottomdivider />

<div class=bottombar>
  <div class=copyright>
  <table>
    <tr>
      <td colspan=2>
        <span class=program>DEMETER</span> is copyright &copy; 2009-2015 Bruce Ravel
        &mdash;
        This document is copyright &copy; 2015 Bruce Ravel
        <br />
      </td>
    </tr>
    <tr valign=middle>
      <td> 
           <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../../images/somerights20.png" width="88" height="31" alt="" border="0" /></a> &nbsp;&nbsp;&nbsp;
      </td>
      <td>
  	This document is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">
  	The Creative Commons Attribution-ShareAlike License</a>.
  	<br />
  	If <span class=program>DEMETER</span> and this document are useful to you, please consider
  	<a href="http://creativecommons.org/support/">supporting The Creative Commons</a>.
      </td>
    </tr>
  </table>
</div>
</div>
  </body>
</html>