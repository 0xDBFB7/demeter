<!DOCTYPE HTMP PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>The GDS window</title>
    <link rel="stylesheet" href=./artug.css />
    <link rel="stylesheet" href=./ppi.css />
    <meta http-equiv="Content-Type" content="text/html"; charset=iso-8859-15 />
    <meta name="robots" contents="all" />
  </head>

  <body>
    <div class=topbar>
  <div class=navbar>
  <a class=navhead href="./index.html">The Artemis Users' Guide</a>
  <table class=navtable>
    <tr>
      <td align=left>
        &laquo;<a class=navtable href="http://bruceravel.github.com/demeter/"><span class=programlink>DEMETER</span></a>&raquo; &nbsp;
        &laquo;<a class=navtable href="http://cars9.uchicago.edu/iffwiki/Ifeffit"><span class=programlink>IFEFFIT</span></a>&raquo; &nbsp;
        <!-- [&nbsp;<a class=navtable href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"><span class=programlink>FEFF</span></a>&nbsp;] &nbsp; -->
        &laquo;<a class=navtable href="http://xafs.org">xafs.org</a>&raquo; &nbsp;
	<!-- [&nbsp;<a class=navtable href="./demeter.pdf">PDF&nbsp;doc</a>&nbsp;] -->
      </td>
      <td align=right>
        Back: <a class=navtable href="./path/index.html" class="menu">The Path page</a> &nbsp;&nbsp;
        
        &nbsp;&nbsp;
        Next: <a class=navtable href="./fit/index.html" class="menu">Running a fit</a>      </td>
    </tr>
  </table>
  </div>
</div>

<div class=sidebar>
  <a href="./diana.html"><img src=./../images/Artemis_logo.jpg
    width=90% border=0 alt='[Artemis logo]'></a>
  <br />
  <a href="./index.html"  class="menu">Home</a><br />
<a href="./intro.html"  class="menu">Introduction</a><br />
<a href="./startup/index.html"  class="menu">Starting Artemis</a><br />
<a href="./data.html"  class="menu">The Data window</a><br />
<a href="./feff/index.html"  class="menu">The Atoms/Feff window</a><br />
<a href="./path/index.html"  class="menu">The Path page</a><br />
<span style="font-style: italic;">The GDS window</span><br />
<a href="./fit/index.html"  class="menu">Running a fit</a><br />
<a href="./plot/index.html"  class="menu">The Plot window</a><br />
<a href="./logjournal.html"  class="menu">The Log & Journal windows</a><br />
<a href="./history.html"  class="menu">The History window</a><br />
<a href="./monitor.html"  class="menu">Monitoring things</a><br />
<a href="./prefs.html"  class="menu">Managing preferences</a><br />
<a href="./examples/index.html"  class="menu">Worked examples</a><br />
<a href="./atoms/index.html"  class="menu">Crystallography for EXAFS</a><br />
<a href="./extended/index.html"  class="menu">Extended topics</a><br />
</div>

<div class=contentarea>


<h1>
  The GDS window
</h1>

<p>

This is the big trick in <span class=program>ARTEMIS</span>: <p class=premise>
    The parameters of the EXAFS equation are not the parameters of the
    fit.  The parameters of the EXAFS equation are written <em>in terms
    of</em> the parameters of the fit.
</p> As
a consequence, path parameter values are <em>math
expressions</em>.  These math expressions are functions of the actual
fitting parameters.
</p>

<p>
Some of these math expressions are quite simple.  For example, in the
gold metal example in 
<a href="path/mathexp.html">the previous chapter</a>,
the math expressions for
S&sup2;&#8320; and E&#8320; were simple function of a single parameter.  The
math expression for &Delta;R, however, was a function of 
<tt>alpha</tt> and <tt>reff</tt>,
while the &sigma;&sup2; math expression used the 
<tt>debye</tt> function and two parameters.
</p>

<p>
All of these parameters must be defined in the GDS window.  This
window contains a grid with a series of buttons down the right side.
It is displayed and hidden using the GDS button on the left side of
the Main window.  Here are the contents of the GDS window from the
gold metal example.  The four variable parameters in the fit along
with the fixed sample temperature needed by the 
<tt>debye</tt> function are shown.  A new variable
parameter is being defined in line 6.
</p>

<p>
The second, third, and fourth columns in the grid are filled by simple
text boxes.  The first column contains a drop down menu from which the
parameter types can be chosen.
</p>


<div class=figure style="max-width: 849px; min-width: 7em;">
<a name=gds>
<img src=../images/gds.png width=100%>
</a>
<p align=center>
The <span class=program>ARTEMIS</span> GDS window.
</p>
</div>


<hr class=hide />
<a name="parametertypes">

<h2>  Parameter types</h2>
</a>

<p>
Every parameter of any type used in any math expression must be
defined on the GDS widow.  Any variable parameter defined on the GDS
window must be used in a math expression.
</p>

<p>
There are 9 types of parameters in <span class=program>ARTEMIS</span>.  They are color coded
in the grid to give you a visual indication of each parameter's 
type. 
<dl>
  
<dt>
  guess
</dt>
<dd>
(<span style="color:#a300a3; background-color:white">purple</span>) This is a
parameter of the fit.  Its value will be adjusted 
to find the best fit of the model to your data.
  <br />
  <br />
</dd>
<dt>
  def
</dt>
<dd>
(<span style="color:#008b00; background-color:white">green</span>) This is a
parameter that is defined as a math expression 
dependent upon other guess, def, or set parameters.  Its value is
updated throughout the fit.  As discussed elsewhere in this manual,
sophisticated use of def parameters is key to successful model
building and effective use of <span class=program>ARTEMIS</span>. 
  <br />
  <br />
</dd>
<dt>
  set
</dt>
<dd>
(<span style="color:#000000; background-color:white">black</span>) A set parameter
is one that is evaluated at the beginning of 
the fit, but not evaluated subsequently.  Although a set parameter can
take a math expression as its value, it is more typically used to
represent a constant value used elsewhere in the fitting model.
  <br />
  <br />
</dd>
<dt>
  lguess
</dt>
<dd>
(<span style="color:#3e1c8f; background-color:white">dark purple</span>) An lguess
parameter is a tool used to simplify model 
creation for a multiple data set fit.  It can be used in math
expressions for two or more data sets.  When the fit started, an
actual guess parameter will be created for each data set in which the
lguess is used.  As an example, suppose your multiple data set fit
includes data on a series of binary alloys.  If <tt>x</tt> is a mixing parameter between the two alloys and is different
for each sample, you might then use math expressions containing <tt>x</tt> and <tt>(1-x)</tt> for
S&sup2;&#8320; parameters of paths representing the two metallic species in
each fit.  With  <tt>x</tt> an lguess parameter,
independent mixing parameters will be floated for each data set.  The
point, then, of an lguess is to facilitate the chore of editing path
parameter math expressions using <span class=program>ARTEMIS</span>'  tools for pushing
path parameter values across paths.  This is discussed in more detail
in <a href="extended/cv.html#useinlguessparameters">the discussion of the characteristic value</a>.
  <br />
  <br />
</dd>
<dt>
  skip
</dt>
<dd>
(<span style="color:#b2b2b2; background-color:white">gray</span>) A skip parameter
is one that is not used in any capacity in the 
fit, but which you do not want to discard from your fitting project.
  <br />
  <br />
</dd>
<dt>
  restrain
</dt>
<dd>
(<span style="color:#cd9b1d; background-color:white">dark yellow</span>) A restraint
is a math expression that is evaluated and 
added in quadrature to &chi;&sup2; to evaluate the fit.  That is, the
fit is optimized in the presence of the restraint.  The point of this
is to add prior knowledge to a fit.  Restraints will be discussed in
more detail later in this document.
  <br />
  <br />
</dd>
<dt>
  after
</dt>
<dd>
(<span style="color:#4a708b; background-color:white">blue</span>) An after parameter
is very similar to a def parameter in that 
it takes a math expression that depends on other parameters.  It is
not, however, used in any way in the fit.  Instead, it is evaluated at
the end of the fit and reported to the log file.  This is used to make
interesting calculations based on other parameters as part of the
record of the fit.
  <br />
  <br />
</dd>
<dt>
  penalty
</dt>
<dd>
(<span style="color:#8b5a2b; background-color:white">brown</span>) This takes a math
expression representing a user defined 
penalty to the happiness calculation.  This feature has not yet been
implemented in <span class=program>ARTEMIS</span>.
  <br />
  <br />
</dd>
<dt>
  merge
</dt>
<dd>
(<span style="color:#ffffff; background-color:white">white on red</span>) A merge parameter is a parameter which has been 
multiply defined under the same name as part of combining fitting
projects or importing structural units.  A fit cannot proceed with any
parameters in this state.  This feature has not yet been implemented
in <span class=program>ARTEMIS</span>.
  <br />
  <br />
</dd>
</dl> 
</p>

<p>
<p class=todo>
<img class=tinyfloatleft border=0 src="../images/todo.png" alt="To do!">
Penalty and merge parameters have not been implemented.
</p>
</p>



<hr class=hide />
<a name="userinteraction">

<h2>  User interaction</h2>
</a>

<p class=todo>
<img class=tinyfloatleft border=0 src="../images/todo.png" alt="To do!">
Explain drag and drop
</p>

<hr class=hide />
<a name="buttonbar">

<h3>  Button bar</h3>
</a>

<p>
The stack of buttons on the right side of the GDS window contains many
of the main functions of the GDS window.  
<dl>
  
<dt>
  Use best fit
</dt>
<dd>
This button makes the most recent best fit value into the initial
guess for every guess parameter in the grid.
  <br />
  <br />
</dd>
<dt>
  Reset all
</dt>
<dd>
This button tells<span class=program>IFEFFIT</span> to reset all parameters to their initial
values.
  <br />
  <br />
</dd>
<dt>
  Highlight
</dt>
<dd>
This button prompts you for a string.  All parameters with names or
math expressions matching the string provided will be highlighted with
a yellow background.  This feature is particularly useful in large
fitting models with many parameters.  In the image above, you can see
that all parameters matching &ldquo;brc1&rdquo; have
been highlighted.  The string to match can actually be any valid Perl
regular expression.
  <br />
  <br />
</dd>
<dt>
  Evaluate
</dt>
<dd>
Clicking this button will evaluate all parameters and insert their
evaluations into the fourth column of the grid.  This is used to 
&ldquo;spell-check&rdquo; your math expressions for
<span style="color:#008b00; background-color:white">def</span> and other parameters.  In the image above, this button has
been clicked and the evaluations have been inserted into the fourth
column. 
  <br />
  <br />
</dd>
<dt>
  Import/export
</dt>
<dd>
The next two buttons are used to import or export a simple text file
with the names and definitions of all the parameters.
  <br />
  <br />
</dd>
<dt>
  Discard all
</dt>
<dd>
This button does just that, after prompting to be sure that is what
you want to do.  
  <br />
  <br />
</dd>
<dt>
  Add a site
</dt>
<dd>
This button appends a blank row to the end of the grid.
  <br />
  <br />
</dd>
</dl>
</p>


<hr class=hide />
<a name="keyboardshortcuts">

<h3>  Keyboard shortcuts</h3>
</a>

<p>
When one or more rows are selected, you can use the following keyboard
shortcuts to change the parameter type of that set of parameters.
</p>

<ul>
  
<li><p>
<span class=key>Alt</span>-<span class=key>g</span>: convert to guess
</p></li>
<li><p>
<span class=key>Alt</span>-<span class=key>d</span>: convert to def
</p></li>
<li><p>
<span class=key>Alt</span>-<span class=key>s</span>: convert to set
</p></li>
<li><p>
<span class=key>Alt</span>-<span class=key>l</span>: convert to lguess
</p></li>
<li><p>
<span class=key>Alt</span>-<span class=key>k</span>: convert to skip
</p></li>
<li><p>
<span class=key>Alt</span>-<span class=key>r</span>: convert to restrain
</p></li>
<li><p>
<span class=key>Alt</span>-<span class=key>a</span>: convert to after
</p></li>
<li><p>
<span class=key>Alt</span>-<span class=key>p</span>: convert to penalty
</p></li>
</ul> 


<hr class=hide />
<a name="contextmenu">

<h3>  Context menu</h3>
</a>

<p>

</td>
<td width=210>
<a class=floatright href="../images/gds-menu.png"  title=The Artemis Users' Guide target=_blank><img border=0 src="../images/gds-menu.png"  title="The Artemis Users' Guide"  alt="gds-menu.png"></a>
Clicking on a line in the grid selects the entire line.  Control
clicking of a line adds that line to the selection.  Shift clicking
adds all lines between the selected and clicked upon lines.
</p>

<p>
Right clicking on any line in the grid, including the label containing
the line number, will post the menu shown on the right.
</p>

<p>
<dl>
  
<dt>
  Copy, cut, paste
</dt>
<dd>
These three options copy, cut, and paste lines from or to the GDS
grid. The cut function is one way of discarding a parameter.
Another is to simply delete the name in the second column.
  <br />
  <br />
</dd>
<dt>
  Insert blank lines
</dt>
<dd>
The insertion options complement the &ldquo;Add a site&rdquo;
button by adding blank rows to the middle of the grid.
  <br />
  <br />
</dd>
<dt>
  Change parameter type of selected lines
</dt>
<dd>
This sub-menu provides yet
another way of changing the parameter type of the selected lines of
the grid.  If you have more than one line selected, they will all get
changed to the option you choose from the submenu.
  <br />
  <br />
</dd>
<dt>
  Grab best fit
</dt>
<dd>
This changes theinitial guess of the selected lines to the most 
recent best fit value(s).
  <br />
  <br />
</dd>
<dt>
  Build restraint
</dt>
<dd>
<p>
</p>

<p>
</td>
<td width=251>
<a class=floatright href="../images/gds-restraint.png"  title=The Artemis Users' Guide target=_blank><img border=0 src="../images/gds-restraint.png"  title="The Artemis Users' Guide"  alt="gds-restraint.png"></a></p>
This posts a dialog
that helps you name and define a restraint based upon the value of the
parameter in the line clicked upon.  This will use <span class=program>IFEFFIT</span>'s
<tt>penalty</tt> function with the lower and upper
bounds as its arguments and multiplied by the scaling factor.  The
example shown will make this restraint:
<pre>
restrain res_enot = 1000 * penalty(enot, -5, 5)
</pre>
and add it to the end of the grid.
The penalty function will evaluate to 0 when enot stays between -5 and
5.  As the value of enot strays outside that range, the restraint will
evaluate to a value of 100 times the distance outside the range.
This, then, is added in quadrature to &chi;&sup2; when the fit is minimized.
You can read more about this,
including how to choose the value of the scaling parameter, in the 
<a href="extended/constraints.html">discussion of restraints</a>.
  <br />
  <br />
</dd>
<dt>
  Annotate
</dt>
<dd>
This prompts you for a text string to describe the parameter in the
line clicked upon.  The intent is to allow you document the role of
the parameter in your fitting model.  This annotation is displayed in
the GDS window's status bar when that line is selected.
  <br />
  <br />
</dd>
<dt>
  Find parameter
</dt>
<dd>
This posts a small window with a text box reporting all GDS parameters
and path parameters which have math expressions containing this parameter.
  <br />
  <br />
</dd>
<dt>
  Rename parameter globally
</dt>
<dd>
This allows you to rename a parameter and have its new name inserted
every place in the fit where that parameter is used.  All instances in
other parameters on the GDS page and in the math expressions for
parameters of all paths will be changed.  Essentially, this is a
global search and replace.
  <br />
  <br />
</dd>
<dt>
  Explain
</dt>
<dd>
Finally, the items in this submenu  write a short text to the status
bar explaining the various parameter types.
  <br />
  <br />
</dd>
</dl>
</p>

</div>

<br />
<hr class=hide />
<hr class=bottomdivider />

<div class=bottombar>
  <div class=copyright>
  <table>
    <tr>
      <td colspan=2>
        <span class=program>DEMETER</span> is copyright &copy; 2009-2013 Bruce Ravel
        &mdash;
        This document is copyright &copy; 2013 Bruce Ravel
        <br />
      </td>
    </tr>
    <tr valign=middle>
      <td> 
           <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../images/somerights20.png" width="88" height="31" alt="" border="0" /></a> &nbsp;&nbsp;&nbsp;
      </td>
      <td>
  	This document is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">
  	The Creative Commons Attribution-ShareAlike License</a>.
  	<br />
  	If <span class=program>DEMETER</span> and this document are useful to you, please consider
  	<a href="http://creativecommons.org/support/">supporting The Creative Commons</a>.
      </td>
    </tr>
  </table>
</div>
</div>
  </body>
</html>