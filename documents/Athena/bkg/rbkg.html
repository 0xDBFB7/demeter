<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4.2. The AUTOBK Algorithm and the Rbkg Parameter &mdash; Athena 0.9.25 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.25',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/wheat.ico"/>
    <link rel="top" title="Athena 0.9.25 documentation" href="../index.html" />
    <link rel="up" title="4. Normalization and background removal" href="index.html" />
    <link rel="next" title="4.3. Spline clamps and k-weight in background removal" href="kweight.html" />
    <link rel="prev" title="4.1. Normalization" href="norm.html" />

    <link rel="stylesheet" type="text/css" href="../_static/demeter.css" />
    <link rel="stylesheet" type="text/css" href="../_static/keys.css" />
    <link rel="stylesheet" type="text/css" href="../_static/program.css" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="kweight.html" title="4.3. Spline clamps and k-weight in background removal"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="norm.html" title="4.1. Normalization"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Athena 0.9.25 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">4. Normalization and background removal</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-autobk-algorithm-and-the-rbkg-parameter">
<span id="rbkg-sec"></span><h1>4.2. The AUTOBK Algorithm and the Rbkg Parameter<a class="headerlink" href="#the-autobk-algorithm-and-the-rbkg-parameter" title="Permalink to this headline">¶</a></h1>
<p>The frequency cutoff between the background and the data discussed in
the previous section is determined by the <tt><font color="#387A38">«rbkg»</font></tt>
parameter. This is the second parameter displayed in the background
removal section of the main window.</p>
<p>When data are imported into <font size=-1 color="#8C4112">ATHENA</font>, <tt><font color="#387A38">«rbkg»</font></tt> is
set to its <a class="reference external" href="../params/defaults.html">default value</a>, normally 1.</p>
<p>This example, like many of the examples in this Users' Guide, can be
found <a class="reference external" href="http://bruceravel.github.io/XAS-Education/">among the examples at my XAS-Education
site</a>.</p>
<p>Among these example files is one called <code class="file docutils literal"><span class="pre">fe.060</span></code>, which contains a
spectrum from an iron foil measured at 60 K. Import this by selecting
<span class="menuselection">File ‣ Import data</span> or by pressing
<kbd class="dark">Control</kbd>-<kbd class="dark">o</kbd>. Navigate to the location of your example
files and select <code class="file docutils literal"><span class="pre">fe.060</span></code>. The <a class="reference external" href="../import/columns.html">column selection dialog</a> then appears. For now, just click OK.</p>
<p>The data is imported and <tt><font color="#387A38">«rbkg»</font></tt> is set to its default value
of 1. The data and the background function found using the default
parameter values can be found by pressing the <kbd class="orange">E</kbd>
button. This is shown here on the left.</p>
<div class="figure compound align-center" id="_fig-rbkginitial">
<div style="width: 45%" class="subfigure" id="id1">
<span id="fig-rbkginitial1"></span><a class="reference external image-reference" href="../_images/rbkg_initial.png"><img alt="../_images/rbkg_initial.png" src="../_images/rbkg_initial.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.12 </span><span class="caption-text">The <code class="file docutils literal"><span class="pre">fe.060</span></code> data and its default background function.</span></p>
</div>
<div style="width: 45%" class="subfigure" id="id2">
<span id="fig-rbkginitial-k"></span><a class="reference external image-reference" href="../_images/rbkg_initial_k.png"><img alt="../_images/rbkg_initial_k.png" src="../_images/rbkg_initial_k.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.13 </span><span class="caption-text">The <code class="file docutils literal"><span class="pre">fe.060</span></code> χ(k) data with its default background function.</span></p>
</div>
<div style="width: 45%" class="subfigure" id="id3">
<span id="fig-rbkginitial-r"></span><a class="reference external image-reference" href="../_images/rbkg_initial_r.png"><img alt="../_images/rbkg_initial_r.png" src="../_images/rbkg_initial_r.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.14 </span><span class="caption-text">The <code class="file docutils literal"><span class="pre">fe.060</span></code> χ(R) data with its default background function.</span></p>
</div>
</div><p id="_fig-rbkginitial">The background function is subtracted from the data and normalized,
resulting in a χ(k) function. Press the <kbd class="orange">k</kbd> button to
see χ(k), shown in the right panel above.</p>
<p>When you press the <kbd class="orange">R</kbd> button, the Fourier transform is
plotted, as in the bottom panel above.</p>
<p>So <tt><font color="#387A38">«rbkg»</font></tt> is the value below which the <font size=-1 color="#8C4112">AUTOBK</font>
algorithm removes Fourier components. As you can see, below 1 the
χ(R) function is essentially 0, but above 1 the spectrum is
non-zero.</p>
<p>Now let's examine the effect of choosing different values for
<tt><font color="#387A38">«rbkg»</font></tt>.  First, make a copy of the data so we can directly
compare different values. Do that by selecting <span class="menuselection">Group
‣ Copy current group</span> or by pressing
<kbd class="dark">Alt</kbd>-<kbd class="dark">y</kbd>. <font size=-1 color="#8C4112">ATHENA</font> now looks like this.</p>
<div class="figure align-center" id="id4">
<span id="fig-rbkg"></span><a class="reference external image-reference" href="../_images/rbkg.png"><img alt="../_images/rbkg.png" src="../_images/rbkg.png" /></a>
<p class="caption"><span class="caption-number">Fig. 4.15 </span><span class="caption-text">The original <code class="file docutils literal"><span class="pre">fe.060</span></code> data and a copy of that data.</span></p>
</div>
<p>Click on the group <em>Copy of fe.060</em> to display its parameters in the
main window. Change <tt><font color="#387A38">«rbkg»</font></tt> to 0.2. Now we want to directly
compare these two ways of removing the background. The way of plotting
multiple items in the groups list involves the row of purple plotting
buttons and the little check buttons next to the items in the group
list. Click on the little check buttons next to <span class="guilabel">fe.060</span> and
<span class="guilabel">Copy 1 of fe.060</span>, as shown in the screenshot above. Now
plot these two items by clicking the <kbd class="purple">R</kbd> button. It should
look something like this.</p>
<div class="figure compound align-center" id="_fig-rbkg10">
<div style="width: 45%" class="subfigure" id="id5">
<span id="fig-rbkg102"></span><a class="reference external image-reference" href="../_images/rbkg_1_0_2.png"><img alt="../_images/rbkg_1_0_2.png" src="../_images/rbkg_1_0_2.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.16 </span><span class="caption-text">Comparing χ(R) for the data and its copy with
<tt><font color="#387A38">«rbkg»</font></tt> values of 1 and 0.2.</span></p>
</div>
<div style="width: 45%" class="subfigure" id="id6">
<span id="fig-rbkg102k"></span><a class="reference external image-reference" href="../_images/rbkg_1_0_2k.png"><img alt="../_images/rbkg_1_0_2k.png" src="../_images/rbkg_1_0_2k.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.17 </span><span class="caption-text">Comparing χ(k) for the data and its copy with
<tt><font color="#387A38">«rbkg»</font></tt> values of 1 and 0.2.</span></p>
</div>
<div style="width: 45%" class="subfigure" id="id7">
<span id="fig-rbkg02e"></span><a class="reference external image-reference" href="../_images/rbkg_0_2e.png"><img alt="../_images/rbkg_0_2e.png" src="../_images/rbkg_0_2e.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.18 </span><span class="caption-text">μ(E) and the background for the copy with an <tt><font color="#387A38">«rbkg»</font></tt>
value 0.2.</span></p>
</div>
</div><p id="_fig-rbkg10">I suspect the blue spectrum is something like what you expect EXAFS data
to look like, while the red one seems somehow worse. In fact, it is easy
to understand why the red one looks the way it does. The <tt><font color="#387A38">«rbkg»</font></tt>
parameter specifies the R value below which the data is removed from the
μ(E) spectrum. That is exactly what has happened in the red spectrum --
below 0.2 the signal is very small and the first big peak is, in fact,
above 0.2.</p>
<p>Those two, plotted as χ(k), are shown above on the right.</p>
<p>The blue spectrum oscillates around the zero axis, as one would expect.
The red one has an obvious, long-wavelength oscillation. It is that
oscillation that gives rise to the low-R peak in the χ(R) spectrum.</p>
<p>The background function, computed using 0.2 as the value of
<tt><font color="#387A38">«rbkg»</font></tt> and plotted in energy, is shown above in the bottom
panel.</p>
<p>Using an <tt><font color="#387A38">«rbkg»</font></tt> value of 0.2 yields a background function
that is not able to follow the actual shape of the data.</p>
<p>What happens if the value of <tt><font color="#387A38">«rbkg»</font></tt> is set to a very large
value? The χ(R) data for the values 1 and 2.5 are shown here.</p>
<div class="figure compound align-center" id="_fig-rbkg125">
<div style="width: 45%" class="subfigure" id="id8">
<span id="fig-rbkg125k"></span><a class="reference external image-reference" href="../_images/rbkg_1_2_5.png"><img alt="../_images/rbkg_1_2_5.png" src="../_images/rbkg_1_2_5.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.19 </span><span class="caption-text">Comparing χ(R) for the data and its copy with
<tt><font color="#387A38">«rbkg»</font></tt> values of 1 and 2.5.</span></p>
</div>
<div style="width: 45%" class="subfigure" id="id9">
<span id="fig-rbkg125ee"></span><a class="reference external image-reference" href="../_images/rbkg_2_5e.png"><img alt="../_images/rbkg_2_5e.png" src="../_images/rbkg_2_5e.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.20 </span><span class="caption-text">μ(E) and the background for the copy with an <tt><font color="#387A38">«rbkg»</font></tt>
value 2.5.</span></p>
</div>
</div><p id="_fig-rbkg125">Using a very large value of <tt><font color="#387A38">«rbkg»</font></tt> results in significant change to the
first peak in χ(R). We can see why by looking at the background function
in energy . With such a large value of <tt><font color="#387A38">«rbkg»</font></tt>, the background function
has enough freedom to oscillate with frequencies that resemble the data.
This results in a reduction of intensity under the first peak.</p>
<p>The spline used to compute the background function has a limited amount
of freedom to oscillate. The number of spline knots is determined by the
Nyquist criterion. This number is proportional to the extent of the data
in k-space multiplied by <tt><font color="#387A38">«rbkg»</font></tt>. These knots are spaced evenly in
wavenumber. Thus the spline function can only have frequency components
below <tt><font color="#387A38">«rbkg»</font></tt>.</p>
<p>So where does that leave us? We want to make <tt><font color="#387A38">«rbkg»</font></tt> as big as possible
so that the low-R peaks are as well suppressed as possible. On the other
hand, too large of a value will result in damage to the data. The trick
is to find a balance.</p>
<p>A good rule of thumb is that <tt><font color="#387A38">«rbkg»</font></tt> should be about half the distance to
the nearest neighbor. But that is only a rule of thumb. Real data can be
really difficult. Noisy data, data with strong white lines, data
truncated by the appearance of another edge – all of these require
careful consideration. While <tt><font color="#387A38">«rbkg»</font></tt> is the primary background removal
parameter, several others should be investigated to yield a good
background removal. Several of these are the subjects of the following
sections.</p>
<p>The literature reference for the <font size=-1 color="#8C4112">AUTOBK</font> algorithm is:</p>
<ul class="simple" id="bibtex-bibliography-bkg/rbkg-0">
<li>M.&nbsp;Newville, P.&nbsp;Livins, Y.&nbsp;Yacoby, J.&nbsp;J. Rehr, and E.&nbsp;A. Stern. Near-edge x-ray-absorption fine structure of Pb: A comparison of theory and experiment. <em>Phys. Rev. B</em>, 47:14126–14131, Jun 1993. <a class="reference external" href="https://doi.org/10.1103/PhysRevB.47.14126">doi:10.1103/PhysRevB.47.14126</a>.</li>
</ul>

<br>

<br>
<hr class="docutils" />
<p><font size=-1 color="#8C4112">DEMETER</font> is copyright © 2009-2016 Bruce Ravel – This document is
copyright © 2016 Bruce Ravel</p>
<p>This document is licensed under <a class="reference external" href="http://creativecommons.org/licenses/by-sa/3.0/">The Creative Commons Attribution-ShareAlike License</a>.</p>
<p>If <font size=-1 color="#8C4112">DEMETER</font> and this document are useful to you, please
consider <a class="reference external" href="http://creativecommons.org/support/">supporting The Creative Commons</a>.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/pallas_athene_thumb.png" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../forward.html">1. Forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">2. Introduction to ATHENA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import/index.html">3. Data import</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">4. Normalization and background removal</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="norm.html">4.1. Normalization</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">4.2. The AUTOBK Algorithm and the Rbkg Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="kweight.html">4.3. Spline clamps and k-weight in background removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="range.html">4.4. Spline range in background removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="ednorm.html">4.5. Energy-dependent normalization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plot/index.html">5. Plotting Your Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui/index.html">6. User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../params/index.html">7. Setting parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output/index.html">8. Data export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">9. Data processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis/index.html">10. Data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other/index.html">11. Other main window chores</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">12. Worked examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hephaestus.html">13. Hephaestus</a></li>
</ul>
<h3>Helpful Links</h3>
<p>Current version: <b>0.9.25</b></p>

<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/">Demeter homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/bruceravel/demeter/">Demeter @ github</a>
  <li>&nbsp; &nbsp; <a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">Ifeffit mailing list</a>
  <li>&nbsp; &nbsp; <a href="http://xraypy.github.io/xraylarch/">Larch homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/newville/ifeffit">Ifeffit @ github</a>
  <li>&nbsp; &nbsp; <a href="http://xafs.org/">xafs.org</a>
</ul>
<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Athena/index.html">Athena manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Artemis/index.html">Artemis manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/bugs.html">Bug reporting hints</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/help.html">How to ask a good question</a>
</ul>
<p>
<h3>Translations</h3>
<ul>
  <li>&nbsp; &nbsp; <a href="http://www.moleng.kyoto-u.ac.jp/~moleng_04/asakura/ja/others/aug/index.html">日本語 (Japanese)</a>
</ul>
<p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/bkg/rbkg.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="kweight.html" title="4.3. Spline clamps and k-weight in background removal"
             >next</a></li>
        <li class="right" >
          <a href="norm.html" title="4.1. Normalization"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Athena 0.9.25 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >4. Normalization and background removal</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Bruce Ravel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>