<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>9.9. Self-absorption approximations &mdash; Athena 0.9.24 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.24',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/wheat.ico"/>
    <link rel="top" title="Athena 0.9.24 documentation" href="../index.html" />
    <link rel="up" title="9. Data processing" href="index.html" />
    <link rel="next" title="9.10. Dispersive XAS" href="pixel.html" />
    <link rel="prev" title="9.8. Deconvoluting data groups" href="deconv.html" />

    <link rel="stylesheet" type="text/css" href="../_static/subfig.css" />
    <link rel="stylesheet" type="text/css" href="../_static/keys.css" />
    <link rel="stylesheet" type="text/css" href="../_static/program.css" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="pixel.html" title="9.10. Dispersive XAS"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="deconv.html" title="9.8. Deconvoluting data groups"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Athena 0.9.24 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">9. Data processing</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="self-absorption-approximations">
<h1>9.9. Self-absorption approximations<a class="headerlink" href="#self-absorption-approximations" title="Permalink to this headline">¶</a></h1>
<p><img alt="bend!" src="../_static/bend.png" align="left" hspace="5"></a> The statement that μ(E) measured in fluorescence
is the ratio of the signals on the fluorescence and incident ion
chambers is only true in the limit of very thin samples or very dilute
samples. For thick, concentrated samples, the depth into which the
incident beam can penetrate changes as fine structure of μ(E)
changes. As the oscillatory part wiggles up, the penetration depth
diminishes. As it wiggles down, the depth increases. This serves to
attenuate the oscillatory structure.</p>
<p>Ideally, all your samples that must be measured in fluorescence should
be either sufficiently thin or sufficiently dilute that your data is
unaffected by this self-absorption effect. Sometimes, the constraints of
the sample are such that self-absorption cannot be avoided. In that
case, you need to figure out what to do at the level of the data
analysis to find the correct answer in the face of this problem. One
solution is presented here.</p>
<p>The self-absorption correction tool offers four different algorithms to
approximate the effect of self-absorption using tables of x-ray
absorption coefficients. One of them works on XANES data, while all four
can be used to correct EXAFS data. One of the algorithms works well for
samples that are not in the infinitely thick limit. These various
algorithms are taken from the available literature and are offered to
allow you to compare.</p>
<p>The examples I show here are particularly well suited to this sort of
correction. In both cases, we have a way to evaluate the success of the
correction. In general, it can be difficult to guarantee the success of
the correction, particularly if the entire composition of the sample is
not well known. That means that, in practice, this sort of correction
may not be useful or reliable.</p>
<p>It is also important to understand that the self-absorption effect only
effects the amplitude of your EXAFS data, not the phase. Thus even if
you are unable to properly correct, you can still analyze your EXAFS
data for bond lengths.</p>
<p><a class="reference external" href="https://speakerdeck.com/bruceravel/understanding-self-absorption-in-%0Afluorescence-xas">Here is my presentation on self-absorption
corrections.</a>
There I discuss the applicability of this tool in more detail. You will
find that, in general, the self-absorption tool is very hard to apply to
real data. There is quite a bit of useful information on this topic at
<a class="reference external" href="http://xafs.org/Experiment/OverAbsorption">XAFS.org</a>.</p>
<div class="section" id="correcting-xanes-data">
<h2>9.9.1. Correcting XANES data<a class="headerlink" href="#correcting-xanes-data" title="Permalink to this headline">¶</a></h2>
<p>The self-absorption tool below allows you to choose between the four
algorithms and to provide the parameters of the correction.</p>
<div class="figure align-center" id="id1">
<span id="fig-selfabs"></span><a class="reference external image-reference" href="../_images/selfabs.png"><img alt="../_images/selfabs.png" src="../_images/selfabs.png" style="width: 65%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.24 </span><span class="caption-text">The self-absorption tool.</span></p>
</div>
<p>In this example of correcting XANES data, ammonium sulfate was dissolved
in water at three different molarities: 0.1, 0.47, and 0.94. The
correction algorithm requires a complete description of the sample, so
we need to determine the ratio of water to ammonium sulfate.</p>
<div class="highlight-python"><div class="highlight"><pre>1 amu = 1.6605 x 10^-27 kg

1 mole = 6.0221 x 10^23 particles

1 water molecule is 18 amu = 2.988 x 10^-26 kg

1 mole of water is .01800 kg

1 liter of water = 1 kg water, so 1 liter is 55.5555 moles
</pre></div>
</div>
<p>Adjusted for the density change upon adding the solute, there are about
54.8 moles of water in the solution</p>
<p>So the formulas for these three molar solution are
((NH<sub>4</sub>)<sub>2</sub>SO<sub>4</sub>)<sub>0.10</sub>(H<sub>2</sub>O)<sub>54.8</sub>,
((NH<sub>4</sub>)<sub>2</sub>SO<sub>4</sub>)<sub>0.47</sub>(H<sub>2</sub>O)<sub>54.8</sub>, and
((NH<sub>4</sub>)<sub>2</sub>SO<sub>4</sub>)<sub>0.94</sub>(H<sub>2</sub>O)<sub>54.8</sub>.</p>
<p>The uncorrected and corrected data for the 0.94M sample are shown here
on the right. The three uncorrected spectra are shown on the left and
the corrected spectra are shown on the bottom.</p>
<div class="figure compound align-center" id="_fig-sa">
<div style="width: 45%" class="subfigure" id="id2">
<span id="fig-saplot"></span><a class="reference external image-reference" href="../_images/selfabs_plot.png"><img alt="../_images/selfabs_plot.png" src="../_images/selfabs_plot.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.25 </span><span class="caption-text">This is the 0.94M data corrected by this algorithm.</span></p>
</div>
<div style="width: 45%" class="subfigure" id="id3">
<span id="fig-sabefore"></span><a class="reference external image-reference" href="../_images/selfabs_before.png"><img alt="../_images/selfabs_before.png" src="../_images/selfabs_before.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.26 </span><span class="caption-text">Here is the raw data for the three samples. You can see the effect
of self-absorption growing for the more concentrated samples.</span></p>
</div>
<div style="width: 45%" class="subfigure" id="id4">
<span id="fig-saafter"></span><a class="reference external image-reference" href="../_images/selfabs_after.png"><img alt="../_images/selfabs_after.png" src="../_images/selfabs_after.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.27 </span><span class="caption-text">The corrected data. Not bad, eh?</span></p>
</div>
</div><p id="_fig-sa">Thanks to Dani Haskel and Zhang Ghong for these data.</p>
</div>
<div class="section" id="correcting-exafs-data">
<h2>9.9.2. Correcting EXAFS data<a class="headerlink" href="#correcting-exafs-data" title="Permalink to this headline">¶</a></h2>
<p>Of the four algorithms, only the Booth algorithm as shown in this figure
is suitable for samples of finite thickness. The other three all assume
that samples are infinitely thick.</p>
<div class="figure align-center" id="id5">
<span id="fig-sabooth"></span><a class="reference external image-reference" href="../_images/selfabs_booth.png"><img alt="../_images/selfabs_booth.png" src="../_images/selfabs_booth.png" style="width: 65%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.28 </span><span class="caption-text">The self-absorption tool with copper data for correction using the
Booth algorithm.</span></p>
</div>
<p>After selecting an algorithm, you can use the other controls to enter
the incident and outgoing angles in degree and the thickness of the
sample in microns. All algorithms require that you specify the formula
of the sample with stoichiometries in atomic percent.</p>
<p>These two data groups were measured from the same thin copper foil, one
in transmission and the other in fluorescence. These data were provided
by Corwin Booth and are the data from the paper where he and Bud Bridges
presented their algorithm (citation below).</p>
<p>Since this is a thin film, only the Booth algorithm is appropriate.
(Although you might want to compare it to the other algorithms, if only
to see how the others overestimate the size of the correction due to the
fact that they do not consider film thickness.)</p>
<p>The formula for copper is Cu and Corwin reports that the thickness of
the sample is 4.6, the incident was 49 degrees and the outgoing angle
was 41 degrees. Enter these values and plot the correction. Save the
corrected data group and compare it to the transmission data, as shown
in the plot below.</p>
<div class="figure align-center" id="id6">
<span id="fig-saboothplot"></span><a class="reference external image-reference" href="../_images/selfabs_boothplot.png"><img alt="../_images/selfabs_boothplot.png" src="../_images/selfabs_boothplot.png" style="width: 45%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.29 </span><span class="caption-text">It works pretty well. The green trace is the corrected fluorescence
spectrum, which compares well to the transmission data, albeit a little
too big.</span></p>
</div>
<p>There are several things that can effect the comparison of the corrected
fluorescence data and the transmission data. These include how the two
data sets were normalized, the incident and outgoing angles, and the
thickness. Try changing all those things to see how they effect the
correction.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">The Booth algorithm has been updated and corrected. It now
requires that the density of the material be provided.</p>
</div>
</div>
<div class="section" id="information-depth">
<h2>9.9.3. Information depth<a class="headerlink" href="#information-depth" title="Permalink to this headline">¶</a></h2>
<p>For any sample, you can plot the information depth as a function of
wavenumber. This quantity was defined by Troger et al. (citation
below) and represents the depth into the sample probed by the incident
beam for a given sample geometry as a function of energy. In that
depth, 68 percent of the incident photons are absorbed and 68 percent
of the fluorescence photons are generated. The information depth
provides a useful metric for whether a film sample can be considered
“thick” in a particular experiment.</p>
<div class="figure compound align-center" id="_fig-sainfo">
<div style="width: 45%" class="subfigure" id="id7">
<span id="fig-sainfoe"></span><a class="reference external image-reference" href="../_images/sa_info_e.png"><img alt="../_images/sa_info_e.png" src="../_images/sa_info_e.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.30 </span><span class="caption-text">The information depth for an iron/gallium alloy, plotted in energy.</span></p>
</div>
<div style="width: 45%" class="subfigure" id="id8">
<span id="fig-sainfok"></span><a class="reference external image-reference" href="../_images/sa_info_k.png"><img alt="../_images/sa_info_k.png" src="../_images/sa_info_k.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.31 </span><span class="caption-text">The same plot, but in wavenumber.</span></p>
</div>
</div></div>
<div class="section" id="algorithm-references">
<span id="_fig-sainfo"></span><h2>9.9.4. Algorithm references<a class="headerlink" href="#algorithm-references" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>Fluo algorithm</strong></dt>
<dd>The program documentation for Fluo can be found at Dani's web site
and includes the mathematical derivation:
<a class="reference external" href="http://www.aps.anl.gov/xfd/people/haskel/fluo.html">http://www.aps.anl.gov/xfd/people/haskel/fluo.html</a></dd>
<dt><strong>Booth Algorithm</strong></dt>
<dd><ul class="first simple" id="bibtex-bibliography-process/sa-0">
<li>C&nbsp;H Booth and F&nbsp;Bridges. Improved self-absorption correction for fluorescence measurements of extended x-ray absorption fine-structure. <em>Physica Scripta</em>, 2005(T115):202, 2005. <a class="reference external" href="http://dx.doi.org/10.1238/Physica.Topical.115a00202">doi:10.1238/Physica.Topical.115a00202</a>.</li>
</ul>
<p class="last">See also Corwin's web site: <a class="reference external" href="http://lise.lbl.gov/RSXAP/">http://lise.lbl.gov/RSXAP/</a></p>
</dd>
<dt><strong>Troger Algorithm</strong></dt>
<dd><ul class="first last simple" id="bibtex-bibliography-process/sa-1">
<li>L.&nbsp;Tröger, D.&nbsp;Arvanitis, K.&nbsp;Baberschke, H.&nbsp;Michaelis, U.&nbsp;Grimm, and E.&nbsp;Zschech. Full correction of the self-absorption in soft-fluorescence extended x-ray-absorption fine structure. <em>Phys. Rev. B</em>, 46:3283–3289, Aug 1992. <a class="reference external" href="http://dx.doi.org/10.1103/PhysRevB.46.3283">doi:10.1103/PhysRevB.46.3283</a>.</li>
</ul>
</dd>
<dt><strong>Pfalzer Algorithm</strong></dt>
<dd><p class="first">Another interesting approach to correcting self-absorption is
presented in</p>
<ul class="simple" id="bibtex-bibliography-process/sa-2">
<li>P.&nbsp;Pfalzer, J.-P. Urbach, M.&nbsp;Klemm, S.&nbsp;Horn, Marten&nbsp;L. denBoer, Anatoly&nbsp;I. Frenkel, and J.&nbsp;P. Kirkland. Elimination of self-absorption in fluorescence hard-x-ray absorption spectra. <em>Phys. Rev. B</em>, 60:9335–9339, Oct 1999. <a class="reference external" href="http://dx.doi.org/10.1103/PhysRevB.60.9335">doi:10.1103/PhysRevB.60.9335</a>.</li>
</ul>
<p class="last">This is not implemented in <font size=-1 color="#033B0A">ATHENA</font> because the main result requires
an integral over the solid angle subtended by the detector. This
could be implemented, but the amount of solid angle subtended it is
not something one typically writes in the lab notebook.</p>
</dd>
<dt><strong>Atoms Algorithm</strong></dt>
<dd><ul class="first simple" id="bibtex-bibliography-process/sa-3">
<li>Bruce Ravel. ATOMS: crystallography for the X-ray absorption spectroscopist. <em>Journal of Synchrotron Radiation</em>, 8(2):314–316, Mar 2001. <a class="reference external" href="http://dx.doi.org/10.1107/S090904950001493X">doi:10.1107/S090904950001493X</a>.</li>
</ul>
<p class="last">See also the documentation for Atoms at Bruce's website for more
details about it's fluorescence correction calculations.</p>
</dd>
<dt><strong>Elam tables of absorption coefficients</strong></dt>
<dd><ul class="first last simple" id="bibtex-bibliography-process/sa-4">
<li>W.&nbsp;T. Elam, B.&nbsp;D. Ravel, and J.&nbsp;R. Sieber. A new atomic database for X-ray spectroscopic calculations. <em>Radiation Physics and Chemistry</em>, 63:121–128, February 2002. <a class="reference external" href="http://dx.doi.org/10.1016/S0969-806X(01)00227-4">doi:10.1016/S0969-806X(01)00227-4</a>.</li>
</ul>
</dd>
</dl>

<br>

<br>
<hr class="docutils" />
<p><font size=-1 color="#033B0A">DEMETER</font> is copyright © 2009-2015 Bruce Ravel – This document is
copyright © 2015 Bruce Ravel</p>
<p>This document is licensed under <a class="reference external" href="http://creativecommons.org/licenses/by-sa/3.0/">The Creative Commons Attribution-ShareAlike License</a>.</p>
<p>If <font size=-1 color="#033B0A">DEMETER</font> and this document are useful to you, please
consider <a class="reference external" href="http://creativecommons.org/support/">supporting The Creative Commons</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/pallas_athene_thumb.png" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../forward.html">1. Forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">2. Introduction to ATHENA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import/index.html">3. Data import</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bkg/index.html">4. Normalization and the AUTOBK Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plot/index.html">5. Plotting Your Data in ATHENA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui/index.html">6. ATHENA's User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../params/index.html">7. Setting parameters in ATHENA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output/index.html">8. Data export</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">9. Data processing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cal.html">9.1. Calibrating data groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="align.html">9.2. Aligning data groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="merge.html">9.3. Merging data groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="rebin.html">9.4. Rebinning data groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="deg.html">9.5. Deglitching and truncating data</a></li>
<li class="toctree-l2"><a class="reference internal" href="smooth.html">9.6. Smoothing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="conv.html">9.7. Convoluting data groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="deconv.html">9.8. Deconvoluting data groups</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">9.9. Self-absorption approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixel.html">9.10. Dispersive XAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="mee.html">9.11. Multi-electron excitation removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="series.html">9.12. Copy series</a></li>
<li class="toctree-l2"><a class="reference internal" href="sum.html">9.13. Data summation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../analysis/index.html">10. Data analysis in ATHENA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other/index.html">11. Other main window chores</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">12. Worked examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hephaestus.html">13. Hephaestus</a></li>
</ul>
<h3>Links</h3>
<p>Current version: <b>0.9.24</b></p>

<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/">Demeter homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/bruceravel/demeter/">Demeter @ github</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/newville/ifeffit">Ifeffit</a>
  <li>&nbsp; &nbsp; <a href="http://xraypy.github.io/xraylarch/">Larch</a>
  <li>&nbsp; &nbsp; <a href="http://xafs.org/">xafs.org</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.com/demeter/pods/bugs.pod.html">Bug reporting hints</a>
</ul>
<p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/process/sa.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="pixel.html" title="9.10. Dispersive XAS"
             >next</a> |</li>
        <li class="right" >
          <a href="deconv.html" title="9.8. Deconvoluting data groups"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Athena 0.9.24 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >9. Data processing</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Bruce Ravel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>