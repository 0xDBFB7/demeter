<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>14.3. A worked example (in text!) &mdash; Artemis 0.9.24 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.24',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/wheat.ico"/>
    <link rel="top" title="Artemis 0.9.24 documentation" href="../index.html" />
    <link rel="up" title="14. Crystallography for EXAFS" href="index.html" />
    <link rel="next" title="15. Extended discussions" href="../extended/index.html" />
    <link rel="prev" title="14.2. Absorption calculations and experimental corrections" href="abs.html" />

    <link rel="stylesheet" type="text/css" href="../_static/demeter.css" />
    <link rel="stylesheet" type="text/css" href="../_static/keys.css" />
    <link rel="stylesheet" type="text/css" href="../_static/program.css" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../extended/index.html" title="15. Extended discussions"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="abs.html" title="14.2. Absorption calculations and experimental corrections"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Artemis 0.9.24 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">14. Crystallography for EXAFS</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="a-worked-example-in-text">
<h1>14.3. A worked example (in text!)<a class="headerlink" href="#a-worked-example-in-text" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-atoms-input-file">
<h2>14.3.1. The Atoms input file<a class="headerlink" href="#the-atoms-input-file" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of <font size=-1 color="#8C4112">ATOMS</font> in action. The material is lead
titanate, PbTiO<sub>3</sub>. The crystallographic literature places this
material in the tetragonal space group <code class="docutils literal"><span class="pre">P</span> <span class="pre">4</span> <span class="pre">M</span> <span class="pre">M</span></code>. Let's suppose tha
the data were taken in fluorescence at the titanium K-edge. Since the
edge energy is around 5 KeV and the sample was very thick, the I<sub>0</sub> and self-absorption corrections are expected to be
significant. That titanium is the central atom is indicated by the
keyword <code class="docutils literal"><span class="pre">core</span></code>. <font size=-1 color="#8C4112">ATOMS</font> assumes the K-edge of the titanium
was probed because the atomic number of titanium is less than 57 and
the edge was not otherwise chosen with the <code class="docutils literal"><span class="pre">edge</span></code> keyword.  The I<sub>0</sub>
chamber was filled with 50% helium and 50% nitrogen by pressure.  This
is indicated by the <code class="docutils literal"><span class="pre">nitrogen</span></code> keyword. The size of the cluster to
be printed in <code class="file docutils literal"><span class="pre">feff.inp</span></code> is chosen with the <code class="docutils literal"><span class="pre">rmax</span></code> keyword. The
<code class="docutils literal"><span class="pre">rpath</span></code> keyword is used to set the value of <code class="docutils literal"><span class="pre">RMAX</span></code> in the <code class="file docutils literal"><span class="pre">feff.inp</span></code>
file, which indicates the length of the longest path to be calculated.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>title PbTiO3 10K,a=3.885,c=4.139
space P 4 m m
a=3.885         c=4.139         nitrogen = 0.5
rmax=5.0        rpath=4.2       core=ti
atom
* At      x    y    z      tag
  Pb     0.0  0.0  0.0
  Ti     0.5  0.5  0.5377
  O      0.5  0.5  0.1118 axial
  O      0.0  0.5  0.6174 planar
</pre></div>
</div>
<p>Note that CIF files can also be used as the input to <font size=-1 color="#8C4112">ATOMS</font>
and will, in many cases, work just fine. The code that reads the CIF
files is rather incomplete and a bit buggy, though. Also,
<font size=-1 color="#8C4112">DEMETER</font> will refuse to attempt to import data from a CIF
file that contains multiple occupancy for a crystallographic site.</p>
<ul class="simple" id="bibtex-bibliography-atoms/example-0">
<li>R.J. Nelmes and W.F. Kuhs. The crystal structure of tetragonal PbTiO3 at room temperature and at 700 K. <em>Solid State Communications</em>, 54(8):721 – 723, 1985. <a class="reference external" href="https://doi.org/10.1016/0038-1098(85)90595-2">doi:10.1016/0038-1098(85)90595-2</a>.</li>
</ul>
</div>
<div class="section" id="the-feff-input-file">
<h2>14.3.2. The Feff input file<a class="headerlink" href="#the-feff-input-file" title="Permalink to this headline">¶</a></h2>
<p><font size=-1 color="#8C4112">ATOMS</font> produces the output reproduced below. The absorption
and correction calculations are at the top of the file. All the
<code class="docutils literal"><span class="pre">CONTROL</span></code> cards are set to 1 and the <code class="docutils literal"><span class="pre">PRINT</span></code> cards are set
to 0. This will run all four modules of <font size=-1 color="#8C4112">FEFF</font> and produce
the default output files. Several other useful <font size=-1 color="#8C4112">FEFF</font> cards
are printed but commented out by an asterisk (<code class="docutils literal"><span class="pre">*</span></code>). The unique
potential list is constructed in a simple fashion -- the core atom is
potential 0 and each different atomic species has a single
potential. The atom list is printed in the format required by
<font size=-1 color="#8C4112">FEFF</font>. The atom list has two comment columns. The indexed
atomic symbol and radial distance are written by <font size=-1 color="#8C4112">ATOMS</font> for
your use when reading <code class="file docutils literal"><span class="pre">feff.inp</span></code> and are ignored by
<font size=-1 color="#8C4112">FEFF</font>.</p>
<p><font size=-1 color="#8C4112">FEFF</font> will run to completion using the input file generated
by <font size=-1 color="#8C4112">ATOMS</font>. It is still likely that the user will want to
edit <code class="file docutils literal"><span class="pre">feff.inp</span></code>. Several assumptions are made by <font size=-1 color="#8C4112">ATOMS</font> that
might not hold true. The assignment of unique potentials is made by a
simple algorithm and may not adequately reflect the physics of the
problem. The <code class="docutils literal"><span class="pre">CONTROL</span></code> cards are such that all four modules of
<font size=-1 color="#8C4112">FEFF</font> will be run. The <font size=-1 color="#8C4112">FEFF</font> user might want to
run the modules separately. Values for other cards have been assumed
and might not be desired. Other cards have been left out entirely.
Always check your <code class="file docutils literal"><span class="pre">feff.inp</span></code> file to be sure it is just what you
want.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>* This feff6 file was generated by Demeter 0.9.13
* Demeter written by and copyright (c) Bruce Ravel, 2006-2012

* --*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--
* title = PbTiO3 10K,a=3.885,c=4.139
* space = P 4 m m
* a     =   3.88500    b    =   3.88500    c     =   4.13900
* alpha =  90.00000    beta =  90.00000    gamma =  90.00000
* rmax  =   5.00000    core  = ti
* shift =
* atoms
* # el.     x           y           z        tag
*   Pb     0.00000     0.00000     0.00000   Pb
*   Ti     0.50000     0.50000     0.53770   Ti
*   O      0.50000     0.50000     0.11180   axial
*   O      0.00000     0.50000     0.61740   planar
* --*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--

TITLE PbTiO3 10K,a=3.885,c=4.139

HOLE      1   1.0   * FYI: (Ti K edge @ 4966 eV, second number is S0^2)
*         mphase,mpath,mfeff,mchi
CONTROL   1      1     1     1
PRINT     1      0     0     0

RMAX      4.2
*NLEG      4

POTENTIALS
 * ipot   Z      tag
    0     22     Ti
    1     82     Pb
    2     22     Ti
    3     8      O


ATOMS                  * this list contains 94 atoms
*   x          y          z     ipot tag           distance
   0.00000    0.00000    0.00000  0  Ti            0.00000
   0.00000    0.00000   -1.76280  3  axial.1       1.76280
   1.37355    1.37355    0.32988  3  planar.1      1.97031
  -1.37355    1.37355    0.32988  3  planar.1      1.97031
   1.37355   -1.37355    0.32988  3  planar.1      1.97031
  -1.37355   -1.37355    0.32988  3  planar.1      1.97031
   0.00000    0.00000    2.37620  3  axial.2       2.37620
   2.74711    0.00000    1.91346  1  Pb.1          3.34783
  -2.74711    0.00000    1.91346  1  Pb.1          3.34783
   0.00000    2.74711    1.91346  1  Pb.1          3.34783
   0.00000   -2.74711    1.91346  1  Pb.1          3.34783
   2.74711    0.00000   -2.22554  1  Pb.2          3.53548
  -2.74711    0.00000   -2.22554  1  Pb.2          3.53548
   0.00000    2.74711   -2.22554  1  Pb.2          3.53548
   0.00000   -2.74711   -2.22554  1  Pb.2          3.53548
   2.74711    2.74711    0.00000  2  Ti.1          3.88500
  -2.74711    2.74711    0.00000  2  Ti.1          3.88500
   2.74711   -2.74711    0.00000  2  Ti.1          3.88500
  -2.74711   -2.74711    0.00000  2  Ti.1          3.88500
   0.00000    0.00000    4.13900  2  Ti.2          4.13900
   0.00000    0.00000   -4.13900  2  Ti.2          4.13900
   2.74711    2.74711   -1.76280  3  axial.3       4.26623
  -2.74711    2.74711   -1.76280  3  axial.3       4.26623
   2.74711   -2.74711   -1.76280  3  axial.3       4.26623
  -2.74711   -2.74711   -1.76280  3  axial.3       4.26623
   1.37355    1.37355   -3.80912  3  planar.2      4.27583
  -1.37355    1.37355   -3.80912  3  planar.2      4.27583
   1.37355   -1.37355   -3.80912  3  planar.2      4.27583
  -1.37355   -1.37355   -3.80912  3  planar.2      4.27583
   4.12066    1.37355    0.32988  3  planar.3      4.35607
  -4.12066    1.37355    0.32988  3  planar.3      4.35607
   1.37355    4.12066    0.32988  3  planar.3      4.35607
  -1.37355    4.12066    0.32988  3  planar.3      4.35607
   4.12066   -1.37355    0.32988  3  planar.3      4.35607
  -4.12066   -1.37355    0.32988  3  planar.3      4.35607
   1.37355   -4.12066    0.32988  3  planar.3      4.35607
  -1.37355   -4.12066    0.32988  3  planar.3      4.35607
   2.74711    2.74711    2.37620  3  axial.4       4.55407
  -2.74711    2.74711    2.37620  3  axial.4       4.55407
   2.74711   -2.74711    2.37620  3  axial.4       4.55407
  -2.74711   -2.74711    2.37620  3  axial.4       4.55407
   1.37355    1.37355    4.46888  3  planar.4      4.87280
  -1.37355    1.37355    4.46888  3  planar.4      4.87280
   1.37355   -1.37355    4.46888  3  planar.4      4.87280
  -1.37355   -1.37355    4.46888  3  planar.4      4.87280

END
</pre></div>
</div>
</div>
<div class="section" id="modifying-the-feff-input-file">
<h2>14.3.3. Modifying the Feff input file<a class="headerlink" href="#modifying-the-feff-input-file" title="Permalink to this headline">¶</a></h2>
<p>There are many reasons why you may want to edit the <code class="file docutils literal"><span class="pre">feff.inp</span></code> before
running <font size=-1 color="#8C4112">FEFF</font>. Here are some examples.</p>
<dl class="docutils">
<dt><strong>Change the absorber</strong></dt>
<dd><p class="first">Suppose your absorber is a very dilute dopant such that you do not
expect, on the average, that another example of the dopant resides
anywhere near the absorber. In that case, you would want to leave
the atoms list untouched but change the atomic species of the
absorber.</p>
<p>In the example above, let's consider that the dilute absorber is
Nb. To make it the absorber, we must modify the <code class="file docutils literal"><span class="pre">feff.inp</span></code>
file like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>POTENTIALS
 * ipot   Z      tag
    0     41     Nb
    1     82     Pb
    2     22     Ti
    3     8      O

ATOMS                  * this list contains 94 atoms
*   x          y          z     ipot tag           distance
   0.00000    0.00000    0.00000  0  Nb            0.00000
</pre></div>
</div>
<p class="last">Note that the labels (i.e. the instances of the string “Nb”) are
for the benefit of the human reader of the file and are also used
by <font size=-1 color="#8C4112">DEMETER</font> to provide some information for the
user. The essential edit is to change the Z number of the absorber
in the <code class="docutils literal"><span class="pre">POTENTIALS</span></code> list.</p>
</dd>
<dt><strong>Change a scatterer</strong></dt>
<dd><p class="first">Again, consider the situation of a Nb dopant in this crystal. With
Ti as the absorber, we need to consider the possibility of a Nb atom
in the third coordination shell. To do this, we must adit the
<code class="docutils literal"><span class="pre">POTENTIALS</span></code> list to include Nb:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>POTENTIALS
 * ipot   Z      tag
    0     22     Ti
    1     82     Pb
    2     22     Ti
    3     8      O
    4     41     Nb
</pre></div>
</div>
<p>We must then replace one or more of the atoms in the third
coordination shell with the new unique potential. Here is one
example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>2.74711    2.74711    0.00000  4  Nb            3.88500
</pre></div>
</div>
<p class="last">Again, the “Nb” label is not used by <font size=-1 color="#8C4112">FEFF</font> in
any capacity, but is used by <font size=-1 color="#8C4112">DEMETER</font>.</p>
</dd>
<dt><strong>Add an unique potential</strong></dt>
<dd><p class="first">You may choose to consider the possibility that the <font size=-1 color="#8C4112">FEFF</font>
calculation might be improved by allowing the axial and planar
oxygen atoms to have their own unique potentials. This probably
won't make much of a difference in this case, but in the case of an
double bonded oxygenyl ligand (as in a uranyl or vanadyl species),
it almost certainly will.</p>
<p>First you must add a unique potential</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>POTENTIALS
 * ipot   Z      tag
    0     22     Ti
    1     82     Pb
    2     22     Ti
    3     8      axial
    4     8      planar
</pre></div>
</div>
<p>Then you must modify the potential indeces in the to use the new
potential index: <code class="docutils literal"><span class="pre">ATOMS</span></code> list:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span> 0.00000    0.00000   -1.76280  4  axial.1       1.76280
 1.37355    1.37355    0.32988  3  planar.1      1.97031
-1.37355    1.37355    0.32988  3  planar.1      1.97031
 1.37355   -1.37355    0.32988  3  planar.1      1.97031
-1.37355   -1.37355    0.32988  3  planar.1      1.97031
 0.00000    0.00000    2.37620  4  axial.2       2.37620
</pre></div>
</div>
</dd>
<dt><strong>Modify feff's parameters</strong></dt>
<dd><font size=-1 color="#8C4112">FEFF</font> has lots of options that can be used to control
the calculation of the muffin tin potentials, to alter the
self-energy model, or to enable other features of the
code. <font size=-1 color="#8C4112">ATOMS</font> directly supports few of these additional
features. Should you wish to use them, you must edit the
<code class="file docutils literal"><span class="pre">feff.inp</span></code> accordingly.</dd>
</dl>

<br>

<br>
<hr class="docutils" />
<p><font size=-1 color="#8C4112">DEMETER</font> is copyright © 2009-2016 Bruce Ravel – This document is
copyright © 2016 Bruce Ravel</p>
<p>This document is licensed under <a class="reference external" href="http://creativecommons.org/licenses/by-sa/3.0/">The Creative Commons Attribution-ShareAlike License</a>.</p>
<p>If <font size=-1 color="#8C4112">DEMETER</font> and this document are useful to you, please
consider <a class="reference external" href="http://creativecommons.org/support/">supporting The Creative Commons</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Artemis_logo.jpg" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../forward.html">1. Forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../startup/index.html">2. Starting Artemis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">3. The Data window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feff/index.html">4. The Atoms and Feff Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../path/index.html">5. The Path page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gds.html">6. The GDS window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fit/index.html">7. Running a fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plot/index.html">8. Plotting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logjournal.html">9. The Log and Journal windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">10. The History window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitor.html">11. Monitoring things</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prefs.html">12. Managing preferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">13. Worked examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">14. Crystallography for EXAFS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="space.html">14.1. Understanding and denoting space groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="abs.html">14.2. Absorption calculations and experimental corrections</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">14.3. A worked example (in text!)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extended/index.html">15. Extended discussions</a></li>
</ul>
<h3>Helpful Links</h3>
<p>Current version: <b>0.9.24</b></p>

<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/">Demeter homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/bruceravel/demeter/">Demeter @ github</a>
  <li>&nbsp; &nbsp; <a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">Ifeffit mailing list</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/newville/ifeffit">Ifeffit @ github</a>
  <li>&nbsp; &nbsp; <a href="http://xraypy.github.io/xraylarch/">Larch homepage</a>
  <li>&nbsp; &nbsp; <a href="http://xafs.org/">xafs.org</a>
</ul>
<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Athena/index.html">Athena manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Artemis/index.html">Artemis manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/bugs.html">Bug reporting hints</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/help.html">How to ask a good question</a>
</ul>
<p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/atoms/example.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../extended/index.html" title="15. Extended discussions"
             >next</a></li>
        <li class="right" >
          <a href="abs.html" title="14.2. Absorption calculations and experimental corrections"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Artemis 0.9.24 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >14. Crystallography for EXAFS</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Bruce Ravel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>