<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>15.9. Fuzzy degeneracy &mdash; Artemis 0.9.26 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.26',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/wheat.ico"/>
    <link rel="top" title="Artemis 0.9.26 documentation" href="../index.html" />
    <link rel="up" title="15. Extended discussions" href="index.html" />
    <link rel="next" title="15.10. Handling dopants" href="dopants.html" />
    <link rel="prev" title="15.8. Unique potential styles" href="ipots.html" />

    <link rel="stylesheet" type="text/css" href="../_static/demeter.css" />
    <link rel="stylesheet" type="text/css" href="../_static/keys.css" />
    <link rel="stylesheet" type="text/css" href="../_static/program.css" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="dopants.html" title="15.10. Handling dopants"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="ipots.html" title="15.8. Unique potential styles"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Artemis 0.9.26 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">15. Extended discussions</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fuzzy-degeneracy">
<h1>15.9. Fuzzy degeneracy<a class="headerlink" href="#fuzzy-degeneracy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="how-the-path-finder-works">
<h2>15.9.1. How the path finder works<a class="headerlink" href="#how-the-path-finder-works" title="Permalink to this headline">¶</a></h2>
<p>Given a list of atomic coordinates for a cluster of atoms, multiple
scattering paths can be found from those atoms.</p>
<div class="figure align-center" id="id1">
<span id="fig-pathfinder"></span><a class="reference external image-reference" href="../_images/pathfinder.png"><img alt="../_images/pathfinder.png" src="../_images/pathfinder.png" /></a>
<p class="caption"><span class="caption-number">Fig. 15.32 </span><span class="caption-text">Constructing generations of multiple scattering paths.</span></p>
</div>
<p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Heap_%28data_structure%29">heap</a> is
a tree-shaped data structure. Each node is guaranteed to represent a
shorter path length than all nodes below it.  The top node is, thus,
guaranteed to be the shortest path.  For more details, see</p>
<ul class="simple" id="bibtex-bibliography-extended/fuzzy-0">
<li>S.&nbsp;I. Zabinsky, J.&nbsp;J. Rehr, A.&nbsp;Ankudinov, R.&nbsp;C. Albers, and M.&nbsp;J. Eller. Multiple-scattering calculations of x-ray-absorption spectra. <em>Phys. Rev. B</em>, 52:2995–3009, Jul 1995. <a class="reference external" href="https://doi.org/10.1103/PhysRevB.52.2995">doi:10.1103/PhysRevB.52.2995</a>.</li>
</ul>
<ol class="arabic simple">
<li>Find all paths (<span class="blueatom">0</span> <span class="redatom">i</span> <span class="blueatom">0</span>),
<span class="redatom">i</span> ≠ <span class="blueatom">0</span> in the cluster. These paths are
represented by the two-leg diagram in <a class="reference internal" href="#fig-pathfinder"><span>Fig. 15.32</span></a>.  Put each such path in a heap.</li>
<li>For each such path, add a leg with <span class="yellowatom">j</span> ≠
<span class="redatom">i</span> and <span class="yellowatom">j</span> ≠ <span class="blueatom">0</span>. Put all
(<span class="blueatom">0</span> <span class="redatom">i</span> <span class="yellowatom">j</span> <span class="blueatom">0</span>) in the
heap. These paths are represented by the three-leg diagram in
<a class="reference internal" href="#fig-pathfinder"><span>Fig. 15.32</span></a>.</li>
<li>Up to some order of scattering, populate the heap with
(<span class="blueatom">0</span> <span class="redatom">i</span> ... x <span class="blueatom">0</span>)</li>
<li>Test each path (<span class="blueatom">0</span> <span class="redatom">i</span> ... x <span class="blueatom">0</span>)
for magnitude. If small, discard
and do not consider any
(<span class="blueatom">0</span> <span class="redatom">i</span> ... x y <span class="blueatom">0</span>)</li>
<li>Use up all atoms in the cluster and up to some order of scattering
(<font size=-1 color="#8C4112">FEFF</font>'s default is 7 legs).</li>
</ol>
<div class="figure align-center" id="id2">
<span id="fig-heap"></span><a class="reference external image-reference" href="../_images/heap.png"><img alt="../_images/heap.png" src="../_images/heap.png" /></a>
<p class="caption"><span class="caption-number">Fig. 15.33 </span><span class="caption-text">A schematic of a heap.</span></p>
</div>
<p>Construct the path list by repeatedly pulling the top path from the
heap until the heap is empty. When the top node is removed, the
remaining nodes rearrange themselves such that heap retains the
property that each node represents a shorter path than all those below
it.</p>
<p>The resulting path list is guaranteed to be sorted by increasing path
length. The list is then examined to find “degenerate”
paths. Degenerate paths are ones that contribute identically to the
EXAFS. A simple example would be the single scattering paths from the
various atoms in the first coordination shell. Since each atom is the
same distance away from the absorber, each contributes identically to
the EXAFS. Thus these paths are degenerate. After being screened for
degeneracy, the path list is presented to the user.</p>
</div>
<div class="section" id="the-pathfinder-in-feff-and-artemis">
<h2>15.9.2. The pathfinder in Feff and Artemis<a class="headerlink" href="#the-pathfinder-in-feff-and-artemis" title="Permalink to this headline">¶</a></h2>
<p>One of the features of <font size=-1 color="#8C4112">ARTEMIS</font> is a rewrite of <font size=-1 color="#8C4112">FEFF</font>'s pathfinder.</p>
<p>The new path finder has two huge advantages over <font size=-1 color="#8C4112">FEFF</font>'s:</p>
<ol class="arabic simple">
<li>User configurable fuzzy degeneracy. <font size=-1 color="#8C4112">FEFF</font> considers paths
that differ in length by 0.00001 Å to be non-degenerate.
<font size=-1 color="#8C4112">ARTEMIS</font> can group together these nearly degenerate
paths.</li>
<li>The scattering geometries of the degenerate paths are stored and
are available for use and examination.  <font size=-1 color="#8C4112">FEFF</font> discards
the details of the degenerate paths.</li>
</ol>
<p>The first point – the use of fuzzy degeneracy – is the topic of
this section.</p>
<p><font size=-1 color="#8C4112">FEFF</font>'s path finder, however, has its advantages over
<font size=-1 color="#8C4112">ARTEMIS</font>':</p>
<ol class="arabic simple">
<li>As it is written in a compiled language, it is considerably faster.
Fortunately, the path finder does not need to be run very often.</li>
<li><font size=-1 color="#8C4112">FEFF</font> uses its fast plane wave calculation to approximate
the importance of path. Low importance paths can be removed from
consideration, as can all higher order paths built from that path.
<font size=-1 color="#8C4112">ARTEMIS</font> does not have access to the plane wave
calculation, so it must consider rather more paths than
<font size=-1 color="#8C4112">FEFF</font>'s pathfinder.  <font size=-1 color="#8C4112">ARTEMIS</font> relies instead on
some simple heuristics to trim the tree of paths.</li>
<li><font size=-1 color="#8C4112">FEFF</font>'s path finder considers up to seven-legged
paths. <font size=-1 color="#8C4112">ARTEMIS</font> can do five- and six-legged paths, but it
is slow.  In any case, it is rather unusual to need more than
four-legged paths in an EXAFS analysis.  (Cubic metals analyzed
beyond about 6 Å and cyanide bridged structures like prussian
blue are two examples.)</li>
</ol>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last"><font size=-1 color="#8C4112">ARTEMIS</font>' path finder does not currently handle
ellipticity.  So that's another advantage at the moment for
<font size=-1 color="#8C4112">FEFF</font>'s path finder.</p>
</div>
</div>
<div class="section" id="an-example-of-using-fuzzy-degeneracy">
<h2>15.9.3. An example of using fuzzy degeneracy<a class="headerlink" href="#an-example-of-using-fuzzy-degeneracy" title="Permalink to this headline">¶</a></h2>
<p>As the path finder organizes all the scattering geometries it finds
among the atoms in the input atoms list, it will make a fuzzy
comparison to sort the paths into nearly-degenerate bins. That is, all
paths whose lengths are within a small margin will be considered
degenerate. The width of this bin is set by the
<font color="#636A24">♦Pathfinder→fuzz</font> preference.</p>
<p>Consider this <code class="file docutils literal"><span class="pre">feff.inp</span></code> file (made from <a class="reference external" href="https://raw.githubusercontent.com/bruceravel/XAS-Education/master/Examples/Xtal/PbFe12O19.inp">this crystal data</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>TITLE magnetoplumbite  PbFe_12O_19

HOLE      4   1.0   * FYI: (Pb L3 edge @ 13035 eV, second number is S0^2)
*         mphase,mpath,mfeff,mchi
CONTROL   1      1     1     1
PRINT     1      0     0     0

RMAX      5.0
*NLEG      4

POTENTIALS
 * ipot   Z      tag
    0     82     Pb
    1     82     Pb
    2     26     Fe
    3     8      O


ATOMS                  * this list contains 84 atoms
*   x          y          z     ipot tag           distance
   0.00000    0.00000    0.00000  0  Pb1           0.00000
   1.65468    0.00003    2.30070  3  O.1           2.83394
  -0.82737   -1.43298    2.30070  3  O.1           2.83394
   1.65468    0.00003   -2.30070  3  O.1           2.83394
  -0.82737   -1.43298   -2.30070  3  O.1           2.83394
  -0.82737    1.43304    2.30070  3  O.1           2.83397
  -0.82737    1.43304   -2.30070  3  O.1           2.83397
   2.63123   -1.31552    0.00000  3  O.2           2.94176
  -0.17634   -2.93647    0.00000  3  O.2           2.94176
   2.63123    1.31558    0.00000  3  O.2           2.94179
  -2.45494   -1.62092    0.00000  3  O.2           2.94179
  -2.45494    1.62098    0.00000  3  O.2           2.94182
  -0.17634    2.93653    0.00000  3  O.2           2.94182
   1.69537   -2.93647    0.00000  2  Fe2.1         3.39074
  -3.39080    0.00003    0.00000  2  Fe2.1         3.39079
   1.69537    2.93653    0.00000  2  Fe2.1         3.39079
   0.83581   -1.44767    3.24399  2  Fe5.1         3.64935
   0.83581   -1.44767   -3.24399  2  Fe5.1         3.64935
  -1.67167    0.00003    3.24399  2  Fe5.1         3.64937
   0.83581    1.44772    3.24399  2  Fe5.1         3.64937
  -1.67167    0.00003   -3.24399  2  Fe5.1         3.64937
   0.83581    1.44772   -3.24399  2  Fe5.1         3.64937
   3.39074    0.00006    1.38042  2  Fe4.1         3.66097
  -1.69542   -2.93644    1.38042  2  Fe4.1         3.66097
   3.39074    0.00006   -1.38042  2  Fe4.1         3.66097
  -1.69542   -2.93644   -1.38042  2  Fe4.1         3.66097
  -1.69542    2.93656    1.38042  2  Fe4.1         3.66107
  -1.69542    2.93656   -1.38042  2  Fe4.1         3.66107
           ... (more atoms follow)
END
</pre></div>
</div>
<p>Using the default <font color="#636A24">♦Pathfinder→fuzz</font> parameter of 0.03
Å, will give these paths. Note that the <code class="docutils literal"><span class="pre">Fe4</span></code> and <code class="docutils literal"><span class="pre">Fe5</span></code>
scatterers, which differ by about 0.11 Å, get merged into a single
scattering path. This path has a value of R<sub>eff</sub> that is the
average of the constituent paths and a degenaracy that is the sum of
the constituent paths.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>#     degen   Reff       scattering path    I   Rank  legs   type
 0001   6    2.834  ----  @ O.1    @        2  100.00  2  single scattering
 0002   6    2.942  ----  @ O.2    @        2   89.88  2  single scattering
 0003   3    3.391  ----  @ Fe2.1  @        2   34.83  2  single scattering
 0004  12    3.655  ----  @ Fe5.1  @        2  100.00  2  single scattering
</pre></div>
</div>
<p>Resetting the <font color="#636A24">♦Pathfinder→fuzz</font> to 0.01 separates those
two nearly degenerate paths into separate scattering paths.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>#     degen   Reff       scattering path    I   Rank  legs   type
 0001   6    2.834  ----  @ O.1    @        2  100.00  2  single scattering
 0002   6    2.942  ----  @ O.2    @        2   89.88  2  single scattering
 0003   3    3.391  ----  @ Fe2.1  @        2   34.83  2  single scattering
 0004   6    3.649  ----  @ Fe5.1  @        2   57.63  2  single scattering
 0005   6    3.661  ----  @ Fe4.1  @        2   57.15  2  single scattering
</pre></div>
</div>
<p>To make the pathfinder neglect fuzzy degeneracy, thus behaving like
<font size=-1 color="#8C4112">FEFF</font>'s pathfinder, set <font color="#636A24">♦Pathfinder→fuzz</font> to 0.</p>
<p>Fuzzy degeneracy is discussed in</p>
<ul class="simple" id="bibtex-bibliography-extended/fuzzy-1">
<li>B.&nbsp;Ravel. Path degeneracy and EXAFS analysis of disordered materials. <em>Journal of Synchrotron Radiation</em>, 21(6):1269–1274, Nov 2014. <a class="reference external" href="https://doi.org/10.1107/S1600577514014982">doi:10.1107/S1600577514014982</a>.</li>
</ul>

<br>

<br>
<hr class="docutils" />
<p><font size=-1 color="#8C4112">DEMETER</font> is copyright © 2009-2016 Bruce Ravel – This document is
copyright © 2016 Bruce Ravel</p>
<p>This document is licensed under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/3.0/">The Creative Commons Attribution-ShareAlike License</a>.</p>
<p>If <font size=-1 color="#8C4112">DEMETER</font> and this document are useful to you, please
consider <a class="reference external" href="https://creativecommons.org/donate/">supporting The Creative Commons</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Artemis_logo.jpg" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../forward.html">1. Forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../startup/index.html">2. Starting Artemis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">3. The Data window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feff/index.html">4. The Atoms and Feff Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../path/index.html">5. The Path page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gds.html">6. The GDS window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fit/index.html">7. Running a fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plot/index.html">8. Plotting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logjournal.html">9. The Log and Journal windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">10. The History window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitor.html">11. Monitoring things</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prefs.html">12. Managing preferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">13. Worked examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atoms/index.html">14. Crystallography for EXAFS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">15. Extended discussions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="qfs.html">15.1. Quick first shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="cv.html">15.2. Characteristic value</a></li>
<li class="toctree-l2"><a class="reference internal" href="delr.html">15.3. Geometric parametrization of bond length</a></li>
<li class="toctree-l2"><a class="reference internal" href="ss.html">15.4. Modeling disorder</a></li>
<li class="toctree-l2"><a class="reference internal" href="constraints.html">15.5. Constraints and restraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="bvs.html">15.6. Bond valence sums</a></li>
<li class="toctree-l2"><a class="reference internal" href="empirical.html">15.7. Empirical standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipots.html">15.8. Unique potential styles</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">15.9. Fuzzy degeneracy</a></li>
<li class="toctree-l2"><a class="reference internal" href="dopants.html">15.10. Handling dopants</a></li>
<li class="toctree-l2"><a class="reference internal" href="fivesix.html">15.11. 5 &amp; 6 legged paths</a></li>
</ul>
</li>
</ul>
<h3>Helpful Links</h3>
<p>Current version: <b>0.9.26</b></p>

<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/">Demeter homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/bruceravel/demeter/">Demeter @ github</a>
  <li>&nbsp; &nbsp; <a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">Ifeffit mailing list</a>
  <li>&nbsp; &nbsp; <a href="http://xraypy.github.io/xraylarch/">Larch homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/newville/ifeffit">Ifeffit @ github</a>
  <li>&nbsp; &nbsp; <a href="http://xafs.org/">xafs.org</a>
</ul>
<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Athena/index.html">Athena manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Artemis/index.html">Artemis manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/bugs.html">Bug reporting hints</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/help.html">How to ask a good question</a>
</ul>
<p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/extended/fuzzy.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="dopants.html" title="15.10. Handling dopants"
             >next</a></li>
        <li class="right" >
          <a href="ipots.html" title="15.8. Unique potential styles"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Artemis 0.9.26 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >15. Extended discussions</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Bruce Ravel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>