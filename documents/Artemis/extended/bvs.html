<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>15.6. Bond valence sums &#8212; Artemis 0.9.26 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.26',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/wheat.ico"/>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15.7. Empirical standards" href="empirical.html" />
    <link rel="prev" title="15.5. Constraints and restraints" href="constraints.html" />

    <link rel="stylesheet" type="text/css" href="../_static/demeter.css" />
    <link rel="stylesheet" type="text/css" href="../_static/keys.css" />
    <link rel="stylesheet" type="text/css" href="../_static/program.css" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="empirical.html" title="15.7. Empirical standards"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="constraints.html" title="15.5. Constraints and restraints"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Artemis 0.9.26 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">15. Extended discussions</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="bond-valence-sums">
<h1>15.6. Bond valence sums<a class="headerlink" href="#bond-valence-sums" title="Permalink to this headline">¶</a></h1>
<p>The concept of a bond in inorganic or crystal chemistry is a bit
ambiguous. In two seminal pair of papers, Brown and Altermatt proposed
this definition “All neighboring cation-anion distances are
considered to be bonds although not all of equal strength.” In this
model, each bond between atoms i and j has a number – the bond
valence – s<sub>ij</sub> which is inversely proportional to bond
distance. The bond valence is defined as
s<sub>ij</sub>= exp((R<sub>0,ij</sub> - R<sub>ij</sub>)/B),
where R<sub>ij</sub> is the contact distance
and R<sub>0,ij</sub> and B are empirically determined parameters.</p>
<ul class="simple" id="bibtex-bibliography-extended/bvs-0">
<li>D.&nbsp;Altermatt and I.&nbsp;D. Brown. The automatic searching for chemical bonds in inorganic crystal structures. <em>Acta Crystallographica Section B</em>, 41(4):240–244, Aug 1985. <a class="reference external" href="https://doi.org/10.1107/S0108768185002051">doi:10.1107/S0108768185002051</a>.</li>
<li>I.&nbsp;D. Brown and D.&nbsp;Altermatt. Bond-valence parameters obtained from a systematic analysis of the Inorganic Crystal Structure Database. <em>Acta Crystallographica Section B</em>, 41(4):244–247, Aug 1985. <a class="reference external" href="https://doi.org/10.1107/S0108768185002063">doi:10.1107/S0108768185002063</a>.</li>
</ul>
<p>They searched through the Inorganic Crystal Structures Database to
determine empirical values for s<sub>ij</sub> for over 150 cation/anion
pairs. Other authors have supplemented this work with additional
anion/cation pairs. Most of these are for common cations, such as
oxygen, nitrogen, or sulfur. Interestingly, B is nearly constant across
all bonds and equal to 0.37. For some anions such as K and U, the value
of B can be as high as about 0.6. R<sub>0,ij</sub> depends on the contact
pair and has been tabulated along with B in a database.</p>
<p>The bond valance sum, then, is the sum of s<sub>ij</sub> over all pairs in
a coordination shell: V= Σs<sub>ij</sub>. The bond valence sum V should be
equal to the formal valence of the absorber cation. This provides a way
of relating coordination number, bond distance, and formal valence in a
way that is useful and directly applicable to EXAFS analysis.</p>
<div class="section" id="computing-a-bond-valence-sum-from-a-fit">
<h2>15.6.1. Computing a bond valence sum from a fit<a class="headerlink" href="#computing-a-bond-valence-sum-from-a-fit" title="Permalink to this headline">¶</a></h2>
<p><font size=-1 color="#8C4112">ARTEMIS</font> provides a tool for computing a bond valence sum
from a list of paths included in a fit. A set of paths to be included
in the sum can be marked in a path list.  Selecting
<span class="menuselection">Actions ‣ Compute bond valence sum</span> will display this
dialog.</p>
<div class="figure align-center" id="id1">
<span id="fig-bvs"></span><a class="reference external image-reference" href="../_images/bvs.png"><img alt="../_images/bvs.png" src="../_images/bvs.png" /></a>
<p class="caption"><span class="caption-number">Fig. 15.16 </span><span class="caption-text">The bond valence sum dialog.</span></p>
</div>
<p>Some care is taken to verify that your selection of paths is sensible.
<font size=-1 color="#8C4112">ARTEMIS</font> will notice if you have marked multiple scattering
paths or have marked paths with absorber/scatterer pairs that are not
in the bond valence database. Although it will proceed with a
calculation, <font size=-1 color="#8C4112">ARTEMIS</font> will warn you if it seems as though
you have included paths that do not seem to be a part of the first
coordination shell.</p>
<p><font size=-1 color="#8C4112">ARTEMIS</font> also tries to make good guesses about the formal
valences of the absorber and scatterer, althoguh it will often guess
wrongly. It is, therefore, essential that you set the valences
correctly using the choice menus at the top of the bond valence
dialog. It is much more likely that the absorber valence will be
guessed incorrectly.</p>
<p>You will notice that one of the valence options for many absorber
species is “9”, an obviously wrong value of valence. The bond
valence database says “Bond valence parameters for atoms whose
oxidation state is given as 9 do not have an oxidation state specified
in the original citation. They may apply to a particular, but
unspecified, oxidation state or they may be intended to apply to all
oxidation states.”</p>
<p>In order to make the bond valence summation, the degeneracy of each
path included in the sum must be multiplied by its evaluation of s<sub>ij</sub> (which also uses the evaluation of R=R<sub>0</sub>+ ΔR
as the value of R<sub>ij</sub>). Because path degeneracy might need to
consider quite complicated parameterization of the S<sub>0</sub><sup>2</sup> path parameter as well as the N path parameter,
<font size=-1 color="#8C4112">ARTEMIS</font> will multiply the evaluations of the N and S<sub>0</sub><sup>2</sup> path parameters together to use as the evaluation
of degeneracy in the summmation. It is up to you, the user, to supply
a value for the actual amplitude reduction factor, S<sub>0</sub><sup>2</sup> to be divided out of the summation.</p>
<p>Pressing the <kbd class="light">Compute</kbd> button will make the bond valence
sum, reporting its value in the text box. Any feedback will be written
in the larger text control. For a successful calculation, the values
of R<sub>ij</sub> and B obtained from the database will be
displayed. Any warnings about the path selection will be printed in
the feedback box in bold red text.</p>
</div>
<div class="section" id="using-a-bond-valance-sum-as-a-restraint">
<h2>15.6.2. Using a bond valance sum as a restraint<a class="headerlink" href="#using-a-bond-valance-sum-as-a-restraint" title="Permalink to this headline">¶</a></h2>
<p>The bond valence sum can be used a <span class="restrain">restraint</span> on a
fit. That is, the relationship between formal valence, coordination
number, and bond distance can be used as prior knowledge guiding the
fit. If the absorber/scatterer pair are in the bond valence database,
values for R<sub>0,ij</sub>, B, and the formal valence of the obsorber
can be defined as set parameters. The bond valence sum is expressed as
a def parameter.  Finally, the difference between the bond valence sum
and the formal valence are expressed as a <span class="restrain">restrain</span>
parameter. These are shown below for the Fe-O bond in FeO. In FeO the
iron atom is of valence 2+ and the oxygen is 2-.</p>
<div class="figure align-center" id="id2">
<span id="fig-bvsrestrain"></span><a class="reference external image-reference" href="../_images/bvs_restrain.png"><img alt="../_images/bvs_restrain.png" src="../_images/bvs_restrain.png" /></a>
<p class="caption"><span class="caption-number">Fig. 15.17 </span><span class="caption-text">Defining a group of parameters to make a <span class="restrain">restraint</span>
based on a bond valence sum.</span></p>
</div>
<p>When the fit is evaluated, the <span class="restrain">restrain</span> parameter will be
added in quadrature to the evaluation of χ<sup>2</sup>. This sum
will be minimized in the fit. In a fit to FeO, the coordination number
is fixed to 6, the value known from crystallography. By using this
<span class="restrain">restraint</span>, the value of ΔR will be encouraged to
assume a value that results in a bond valence sum of 2. By increasing
the value of the scale parameter, the strength of the
<span class="restrain">restraint</span> is increased. For a very large value of scale,
ΔR will constrained to a value that forces the bond valence sum
to 2. For a very small value of scale, the <span class="restrain">restraint</span> will
be weak and ΔR will be given more freedom to deviate from a
value that casues a bond valence sum of 2.</p>
<p>This example shows the simplest case of a single scattering path
contributing to the bond valence sum. The math expressions to establish
the <span class="restrain">restraint</span> would be more complicated for a more disrodered first
shell, but those math expressions would follow the same pattern as this
example.</p>
</div>
<div class="section" id="using-a-bond-valance-sum-as-an-after-parameter">
<h2>15.6.3. Using a bond valance sum as an after parameter<a class="headerlink" href="#using-a-bond-valance-sum-as-an-after-parameter" title="Permalink to this headline">¶</a></h2>
<p>The last <font size=-1 color="#8C4112">ARTEMIS</font> trick related to evaluations of bond
valence sums is to use an <a class="reference external" href="../gds.html#parameter-types">after parameter</a> to record the bond valence sum to the
<a class="reference external" href="../logjournal.html">log file</a>.  Using the same set of parameters
as in the <span class="restrain">restraint</span> example, set the BVS formula instead to an
<span class="after">after</span> parameter.</p>
<div class="figure align-center" id="id3">
<span id="fig-bvsafter"></span><a class="reference external image-reference" href="../_images/bvs_after.png"><img alt="../_images/bvs_after.png" src="../_images/bvs_after.png" /></a>
<p class="caption"><span class="caption-number">Fig. 15.18 </span><span class="caption-text">Defining an <span class="after">after</span> parameter which reports the evaluated
bond valence sum to the log file.</span></p>
</div>
<p>At the end of the fit, the BVS will be evaluated and reported in the
log file just below the <span class="guess">guess</span>, <span class="def">def</span>, and <span class="set">set</span>
parameters, like so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">after</span> <span class="n">parameters</span><span class="p">:</span>
  <span class="n">bvs</span>                <span class="o">=</span>   <span class="mf">2.04154071</span>    <span class="c1"># [6*exp( (rij-(2.139+delr)) / b)]</span>
</pre></div>
</div>

<br>

<br>
<hr class="docutils" />
<p><font size=-1 color="#8C4112">DEMETER</font> is copyright © 2009-2016 Bruce Ravel – This document is
copyright © 2016 Bruce Ravel</p>
<p>This document is licensed under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/3.0/">The Creative Commons Attribution-ShareAlike License</a>.</p>
<p>If <font size=-1 color="#8C4112">DEMETER</font> and this document are useful to you, please
consider <a class="reference external" href="https://creativecommons.org/donate/">supporting The Creative Commons</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Artemis_logo.jpg" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../forward.html">1. Forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../startup/index.html">2. Starting Artemis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">3. The Data window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feff/index.html">4. The Atoms and Feff Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../path/index.html">5. The Path page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gds.html">6. The GDS window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fit/index.html">7. Running a fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plot/index.html">8. Plotting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logjournal.html">9. The Log and Journal windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">10. The History window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitor.html">11. Monitoring things</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prefs.html">12. Managing preferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">13. Worked examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atoms/index.html">14. Crystallography for EXAFS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">15. Extended discussions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="qfs.html">15.1. Quick first shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="cv.html">15.2. Characteristic value</a></li>
<li class="toctree-l2"><a class="reference internal" href="delr.html">15.3. Geometric parametrization of bond length</a></li>
<li class="toctree-l2"><a class="reference internal" href="ss.html">15.4. Modeling disorder</a></li>
<li class="toctree-l2"><a class="reference internal" href="constraints.html">15.5. Constraints and restraints</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">15.6. Bond valence sums</a></li>
<li class="toctree-l2"><a class="reference internal" href="empirical.html">15.7. Empirical standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipots.html">15.8. Unique potential styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="fuzzy.html">15.9. Fuzzy degeneracy</a></li>
<li class="toctree-l2"><a class="reference internal" href="dopants.html">15.10. Handling dopants</a></li>
<li class="toctree-l2"><a class="reference internal" href="fivesix.html">15.11. 5 &amp; 6 legged paths</a></li>
</ul>
</li>
</ul>
<h3>Helpful Links</h3>
<p>Current Demeter version: <b>0.9.26</b></p>

<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/">Demeter homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/bruceravel/demeter/">Demeter @ github</a>
  <li>&nbsp; &nbsp; <a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">Ifeffit mailing list</a>
  <li>&nbsp; &nbsp; <a href="http://xraypy.github.io/xraylarch/">Larch homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/newville/ifeffit">Ifeffit @ github</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/XAS-Education/">Bruce's XAS Education page</a>
  <li>&nbsp; &nbsp; <a href="http://xafs.org/">xafs.org</a>
</ul>
<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Athena/index.html">Athena manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Artemis/index.html">Artemis manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/bugs.html">Bug reporting hints</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/help.html">How to ask a good question</a>
</ul>
<p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/extended/bvs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="empirical.html" title="15.7. Empirical standards"
             >next</a></li>
        <li class="right" >
          <a href="constraints.html" title="15.5. Constraints and restraints"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Artemis 0.9.26 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >15. Extended discussions</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Bruce Ravel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.
    </div>
  </body>
</html>