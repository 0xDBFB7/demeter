<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>7.2. The heuristic happiness parameter &mdash; Artemis 0.9.26 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.26',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/wheat.ico"/>
    <link rel="top" title="Artemis 0.9.26 documentation" href="../index.html" />
    <link rel="up" title="7. Running a fit" href="index.html" />
    <link rel="next" title="7.3. Using path-like objects" href="pathlike.html" />
    <link rel="prev" title="7.1. Sanity checking your fitting model" href="sanity.html" />

    <link rel="stylesheet" type="text/css" href="../_static/demeter.css" />
    <link rel="stylesheet" type="text/css" href="../_static/keys.css" />
    <link rel="stylesheet" type="text/css" href="../_static/program.css" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="pathlike.html" title="7.3. Using path-like objects"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="sanity.html" title="7.1. Sanity checking your fitting model"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Artemis 0.9.26 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">7. Running a fit</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-heuristic-happiness-parameter">
<h1>7.2. The heuristic happiness parameter<a class="headerlink" href="#the-heuristic-happiness-parameter" title="Permalink to this headline">¶</a></h1>
<p><font size=-1 color="#8C4112">ARTEMIS</font> evaluates a variety of statistical parameters
relevant to the evaluation of your fit.  These include the fitting
metric χ<sup>2</sup>, the fitting metric normalized by the degrees
of freedom in the fit χ<sup>2</sup><sub>v</sub>, an R-factor, and the
uncertainties of and correlations between the variable parameters.</p>
<p>In a formal sense, the most important of these parameters is χ<sup>2</sup><sub>v</sub>, which is the statistical parameter allowing you to
distinguish between different fitting models applied to the same data.
Unfortunately, χ<sup>2</sup><sub>v</sub> is difficult to interpret
directly.  In practice, the EXAFS analysis problem using
<font size=-1 color="#8C4112">FEFF</font> is not a well-posed problem in the sense required by
Gaussian statistics. This is true for a variety of reasons. In EXAFS,
the signal is not ideally packed – that is, the signal is not
composed of pure sine waves. In general, you cannot guarantee that
errors in your fitting parameters are normally distributed. In
general, we cannot actually identify and enumerate all sources of
measurement error, many of which are complex and systematic, such as
sample inhomogeneity, detector non-linearity, and so on.  Finally, we
do not know the true line shape of our signal – instead we use
<font size=-1 color="#8C4112">FEFF</font> to approximate the lineshape.  All of this is
discussed further in my <a class="reference external" href="https://speakerdeck.com/bruceravel/advanced-topics-in-exafs-analysis?slide=6">Advanced Topics in EXAFS Analysis talk</a></p>
<p>For all those reasons, χ<sup>2</sup><sub>v</sub> is rarely – if
ever – close to 1 as expected for a good fit. Although χ<sup>2</sup><sub>v</sub> for different fitting models can be compared
effectively, it is, generally speaking, not a sufficient criterion for
evaluating the quality of an individual fit.</p>
<p>Happily, this is not an insolvable problem. After decades of analyzing
EXAFS data, using <font size=-1 color="#8C4112">FEFF</font>, and using <font size=-1 color="#8C4112">IFEFFIT</font>, we
know a lot about what constitutes a good fit. For instance, a good fit
has a small R-factor, which is a measure of the percentage misfit
between the data and theory.  We know things about individual
parameter types, e.g. that an E<sub>0</sub> is rarely more than 10 eV or
less than -10 eV, that S<sup>2</sup><sub>0</sub> and σ<sup>2</sup>
should never be negative. We know that a robust fit does not have
excessive correlation between variable parameters.</p>
<p><font size=-1 color="#8C4112">ARTEMIS</font> offers a heuristic tool called “happiness”
which is an attempt to enumerate the knowledge and experience we bring
to a fit. After a fit, this heuristic parameter is evaluated and
reported in the log file.  It has no meaning other that to give you a
general sense of how the fit came out.</p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">The word “happiness” was chosen for this
parameter because it is a silly word in a statistics context.
Happiness is an ad-hoc, semantic metric.  It has no basis in formal
statistics. It is a functionally meaningless parameter and should
<strong>NEVER</strong> be published.  <strong>NEVER</strong>!</p>
</div>
<div class="section" id="evaluation-of-the-happiness-parameter">
<h2>7.2.1. Evaluation of the happiness parameter<a class="headerlink" href="#evaluation-of-the-happiness-parameter" title="Permalink to this headline">¶</a></h2>
<p>The happiness parameter begins with a value of 100, indicating complete
happiness. After the fit is evaluated, a series of tests are run against
the fitting results. If a test hits, it removes points from the
happiness. The final evaluation is reported in the log file and used to
color the Fit and plot buttons.</p>
<dl class="docutils">
<dt><strong>R-factor</strong></dt>
<dd>Assess a penalty for an R-factor that is larger than 0.02. That
is, any fit which has 2% or less misfit between data and theory is
not assessed a penalty. Above that, the penalty scales linearly in
R-factor up to a maximum penalty of 40.</dd>
<dt><strong>Parameter values</strong></dt>
<dd>After every path parameter for every path is evaluated, assess a
penalty of 2 for each path parameter that fails a sanity
check. The sanity checks include checking that E₀ is not too large
either positively or negatively, checking that neither of S<sup>2</sup><sub>0</sub> or σ<sup>2</sup> is negative, and checking
that neither of σ<sup>2</sup> or ΔR is too large.</dd>
<dt><strong>Restraints</strong></dt>
<dd>If any restraints are placed upon the fit, assess a penalty for
every restraint which evaluates to something non-zero. The penalty
scales linearly with the size of the evaluated restraint.</dd>
<dt><strong>Number of independent points</strong></dt>
<dd>Assess a penalty if the number of guess parameters is larger than
2/3 of the total number of independent points as evaluated by the
Nyquist criterion. Above the 2/3 threshold, the penalty scales
linearly.</dd>
<dt><strong>Correlations</strong></dt>
<dd>Assess a penalty for each correlation that exceeds a cutoff value.</dd>
<dt><strong>Penalty parameters</strong></dt>
<dd>Assess a penalty equal to the evaluation of a penalty parameter.
<em>Penalty parameters have not yet been implemented.</em></dd>
</dl>
</div>
<div class="section" id="configuring-the-happiness-evaluation">
<h2>7.2.2. Configuring the happiness evaluation<a class="headerlink" href="#configuring-the-happiness-evaluation" title="Permalink to this headline">¶</a></h2>
<p>Note that everything above is something that Bruce made up out of whole
cloth, inlcuding the parametrization. That said, every part of the
happiness calculation is configurable. That means that you, the user,
can tune the happiness evaluation to report on fit quality in a way that
is meaningful and useful for your data and your fits.</p>
<p>The configuration parameters are spread over <a class="reference external" href="../prefs.html">two configuration groups</a>. The parameters in the “Happiness” group
control the evaluation of the penalties. Those in the
“Warning” group control the assessment of path parameter
values.</p>
<p>For example, to tune the assessment of the penalty for an excessive
number of guess parameters, you can change two configuration
parameters.  <font color="#636A24">♦Happiness→nidp_cutoff</font> default to 2/3 and
sets the cutoff below which no penalty is assessed. This parameter is
interpreted as a fraction of total number of independent points in the
fit. <font color="#636A24">♦Happiness→nidp_scale</font> sets the maximum penalty to
assess for using up all the independent points.</p>
<p>The path parameter penalties can also be fine tuned. A couple
examples: the value above which a penalty is assessed for an
excessively large E<sub>0</sub> is set with
<font color="#636A24">♦Warnings→e0_max</font> and the assessment of a penalty for a
negative σ<sup>2</sup> can be turned off by toggling
<font color="#636A24">♦Warnings→ss2_neg</font>.</p>
<p>Since this happiness thing is an artificial and statistically
meaningless creation, it can be changed as you like.  Do you have any
ideas for penalty assessments?  Open <a class="reference external" href="https://github.com/bruceravel/demeter/issues">an issue</a> at the
<font size=-1 color="#8C4112">DEMETER</font> website.  Do you have a suggestion for how the
existing penalties should be tuned?  Post your configuration parameter
values <a class="reference external" href="https://github.com/bruceravel/demeter/issues">as an issue</a>.</p>

<br>

<br>
<hr class="docutils" />
<p><font size=-1 color="#8C4112">DEMETER</font> is copyright © 2009-2016 Bruce Ravel – This document is
copyright © 2016 Bruce Ravel</p>
<p>This document is licensed under <a class="reference external" href="http://creativecommons.org/licenses/by-sa/3.0/">The Creative Commons Attribution-ShareAlike License</a>.</p>
<p>If <font size=-1 color="#8C4112">DEMETER</font> and this document are useful to you, please
consider <a class="reference external" href="http://creativecommons.org/support/">supporting The Creative Commons</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Artemis_logo.jpg" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../forward.html">1. Forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../startup/index.html">2. Starting Artemis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">3. The Data window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feff/index.html">4. The Atoms and Feff Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../path/index.html">5. The Path page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gds.html">6. The GDS window</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">7. Running a fit</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sanity.html">7.1. Sanity checking your fitting model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">7.2. The heuristic happiness parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathlike.html">7.3. Using path-like objects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plot/index.html">8. Plotting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logjournal.html">9. The Log and Journal windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">10. The History window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitor.html">11. Monitoring things</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prefs.html">12. Managing preferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">13. Worked examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atoms/index.html">14. Crystallography for EXAFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extended/index.html">15. Extended discussions</a></li>
</ul>
<h3>Helpful Links</h3>
<p>Current version: <b>0.9.26</b></p>

<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/">Demeter homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/bruceravel/demeter/">Demeter @ github</a>
  <li>&nbsp; &nbsp; <a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">Ifeffit mailing list</a>
  <li>&nbsp; &nbsp; <a href="http://xraypy.github.io/xraylarch/">Larch homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/newville/ifeffit">Ifeffit @ github</a>
  <li>&nbsp; &nbsp; <a href="http://xafs.org/">xafs.org</a>
</ul>
<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Athena/index.html">Athena manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Artemis/index.html">Artemis manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/bugs.html">Bug reporting hints</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/help.html">How to ask a good question</a>
</ul>
<p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/fit/happiness.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="pathlike.html" title="7.3. Using path-like objects"
             >next</a></li>
        <li class="right" >
          <a href="sanity.html" title="7.1. Sanity checking your fitting model"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Artemis 0.9.26 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >7. Running a fit</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Bruce Ravel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>