<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>7.3. The path finder &mdash; Demeter Programming Guide 0.9.24 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.24',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/wheat.ico"/>
    <link rel="top" title="Demeter Programming Guide 0.9.24 documentation" href="../index.html" />
    <link rel="up" title="7. Feff" href="index.html" />
    <link rel="next" title="7.4. Path interpretation" href="intrp.html" />
    <link rel="prev" title="7.2. Computng potentials" href="potph.html" />

    <link rel="stylesheet" type="text/css" href="../_static/demeter.css" />
    <link rel="stylesheet" type="text/css" href="../_static/keys.css" />
    <link rel="stylesheet" type="text/css" href="../_static/program.css" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="intrp.html" title="7.4. Path interpretation"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="potph.html" title="7.2. Computng potentials"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Demeter Programming Guide 0.9.24 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">7. Feff</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-path-finder">
<h1>7.3. The path finder<a class="headerlink" href="#the-path-finder" title="Permalink to this headline">¶</a></h1>
<p>The path finder is the tool that digs through the atoms list in the
<code class="file docutils literal"><span class="pre">feff.inp</span></code> file and determines all possible scattering
geometries. This has been reimplemented in <font size=-1 color="#8C4112">DEMETER</font> to add
some important features that are missing in <font size=-1 color="#8C4112">FEFF</font>'s path
finder. Continuing with the example from the previous section, we can
use an instrumented Feff object to compute potentials. It is not
essential to run the potentials calculation (line 6) before the path
finder (line 7), however both must be run before anything else
(plotting, fitting) is done with the <font size=-1 color="#8C4112">FEFF</font> calculation.</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre> <span class="c1">#!/usr/bin/perl</span>
 <span class="k">use</span> <span class="n">Demeter</span><span class="p">;</span>

 <span class="k">my</span> <span class="nv">$feff</span> <span class="o">=</span> <span class="nn">Demeter::</span><span class="n">Feff</span> <span class="o">-&gt;</span> <span class="k">new</span><span class="p">(</span><span class="n">file</span> <span class="o">=&gt;</span> <span class="s">&quot;feff/feff.inp&quot;</span><span class="p">);</span>
 <span class="nv">$feff</span> <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="n">workspace</span> <span class="o">=&gt;</span> <span class="s">&quot;feff/&quot;</span><span class="p">,</span> <span class="n">screen</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,);</span>
 <span class="nv">$feff</span> <span class="o">-&gt;</span> <span class="n">potph</span>
 <span class="nv">$feff</span> <span class="o">-&gt;</span> <span class="n">pathfinder</span><span class="p">;</span>

 <span class="nv">$feff</span> <span class="o">-&gt;</span> <span class="n">freeze</span><span class="p">(</span><span class="s">&quot;feff/feff.yaml&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>At line 9, the attributes of the Feff object, including results of the
path finder, are written to a save file. This save file is in the <a class="reference external" href="http://search.cpan.org/~adamk/YAML/">YAML
format</a>, which is a simple,
textual serialization format for data structures. As you will see in
subsequent sections, these YAML files (along with the phase.bin) can be
used to restore a <font size=-1 color="#8C4112">FEFF</font> calculation for future use.</p>
<p>This can be made a little more efficient.  <code class="docutils literal"><span class="pre">run</span></code> at line 6 below is
a thin wrapper around the <code class="docutils literal"><span class="pre">potph</span></code> and <code class="docutils literal"><span class="pre">pathfinder</span></code> method calls.</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre> <span class="c1">#!/usr/bin/perl</span>
 <span class="k">use</span> <span class="n">Demeter</span><span class="p">;</span>

 <span class="k">my</span> <span class="nv">$feff</span> <span class="o">=</span> <span class="nn">Demeter::</span><span class="n">Feff</span> <span class="o">-&gt;</span> <span class="k">new</span><span class="p">(</span><span class="n">file</span> <span class="o">=&gt;</span> <span class="s">&quot;feff/feff.inp&quot;</span><span class="p">);</span>
 <span class="nv">$feff</span> <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="n">workspace</span> <span class="o">=&gt;</span> <span class="s">&quot;feff/&quot;</span><span class="p">,</span> <span class="n">screen</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,);</span>
 <span class="nv">$feff</span> <span class="o">-&gt;</span> <span class="n">run</span>
</pre></div>
</td></tr></table></div>
<p>The rest of this chapter will cover ways of finding out information
about the <font size=-1 color="#8C4112">FEFF</font> calculation. The next chapter will cover in
detail how information from the <font size=-1 color="#8C4112">FEFF</font> calculation is used to
create Path object and how those Path objects can be plotted and used
in a fitting model.</p>
<div class="section" id="comparing-pathfinders">
<h2>7.3.1. Comparing Pathfinders<a class="headerlink" href="#comparing-pathfinders" title="Permalink to this headline">¶</a></h2>
<p><font size=-1 color="#8C4112">DEMETER</font>'s path finder has two huge advantages over <font size=-1 color="#8C4112">FEFF</font>'s:</p>
<ol class="arabic simple">
<li>User configurable fuzzy degeneracy (explained in detail
below). <font size=-1 color="#8C4112">FEFF</font> considers paths that differ in length by
0.00001 Å to be non-degenerate.</li>
<li>The scattering geometries of the degenerate paths are stored and
are available for use and examination.  <font size=-1 color="#8C4112">FEFF</font> discards
the details of the degenerate paths.</li>
</ol>
<p><font size=-1 color="#8C4112">FEFF</font>'s path finder, however, has its advantages over
<font size=-1 color="#8C4112">DEMETER</font>'s.</p>
<ol class="arabic simple">
<li>As it is written in a compiled language, it is considerably faster.
Fortunately, the path finder does not need to be called very often.</li>
<li><font size=-1 color="#8C4112">FEFF</font> uses its fast plane wave calculation to approximate
the importance of path. Low importance paths can be removed from
consideration, as can all higher order paths built from that path.
<font size=-1 color="#8C4112">DEMETER</font> does not have access to the plane wave
calculation, so it must consider many more paths that
<font size=-1 color="#8C4112">FEFF</font>'s and relies instead on some simple heuristics to
trim the tree of paths.</li>
<li><font size=-1 color="#8C4112">FEFF</font> path finder considers up to seven-legged
paths. <font size=-1 color="#8C4112">DEMETER</font> currently defaults to four-legged paths.
Five- and six-legged paths are possible, but time-consuming.</li>
</ol>
</div>
<div class="section" id="fuzzy-degeneracy">
<h2>7.3.2. Fuzzy degeneracy<a class="headerlink" href="#fuzzy-degeneracy" title="Permalink to this headline">¶</a></h2>
<p>As the path finder organizes all the scattering geometries it finds
among the atoms in the input atoms list, it will make a fuzzy
comparison to sort the paths into nearly-degenerate bins. That is, all
paths whose lengths are within a small margin will be considered
degenerate. The width of this bin is set by the
<font color="#636A24">♦Pathfinder→fuzz</font> preference. Consider this
<code class="file docutils literal"><span class="pre">feff.inp</span></code> file:</p>
<div class="highlight-python"><div class="highlight"><pre>TITLE magnetoplumbite  PbFe_12O_19
HOLE 4   1.0   *  Pb L3 edge  (13035.0 eV), second number is S0^2

*         mphase,mpath,mfeff,mchi
CONTROL   1      1     1     1
PRINT     1      0     0     0

RMAX        5.0

POTENTIALS
*    ipot   Z  element
       0   82   Pb
       1   82   Pb
       2   26   Fe
       3    8   O

ATOMS                          * this list contains 39 atoms
*   x          y          z      ipot  tag              distance
   0.00000    0.00000    0.00000  0 Pb1             0.00000
   1.65468    0.00003    2.30070  3 O_1             2.83393
  -0.82737   -1.43298    2.30070  3 O_1             2.83394
   1.65468    0.00003   -2.30070  3 O_1             2.83393
  -0.82737   -1.43298   -2.30070  3 O_1             2.83394
  -0.82737    1.43304    2.30070  3 O_2             2.83397
  -0.82737    1.43304   -2.30070  3 O_2             2.83397
   2.63123   -1.31552    0.00000  3 O_3             2.94176
  -0.17634   -2.93647    0.00000  3 O_3             2.94176
   2.63123    1.31558    0.00000  3 O_4             2.94179
  -2.45494   -1.62092    0.00000  3 O_4             2.94179
  -2.45494    1.62098    0.00000  3 O_5             2.94182
  -0.17634    2.93653    0.00000  3 O_5             2.94182
   1.69537   -2.93647    0.00000  2 Fe2_1           3.39074
  -3.39080    0.00003    0.00000  2 Fe2_2           3.39080
   1.69537    2.93653    0.00000  2 Fe2_2           3.39079
   0.83581   -1.44767    3.24399  2 Fe5_1           3.64936
   0.83581   -1.44767   -3.24399  2 Fe5_1           3.64936
  -1.67167    0.00003    3.24399  2 Fe5_2           3.64938
   0.83581    1.44772    3.24399  2 Fe5_2           3.64938
  -1.67167    0.00003   -3.24399  2 Fe5_2           3.64938
   0.83581    1.44772   -3.24399  2 Fe5_2           3.64938
   3.39074    0.00006    1.38042  2 Fe4_1           3.66097
  -1.69542   -2.93644    1.38042  2 Fe4_1           3.66097
   3.39074    0.00006   -1.38042  2 Fe4_1           3.66097
  -1.69542   -2.93644   -1.38042  2 Fe4_1           3.66097
  -1.69542    2.93656    1.38042  2 Fe4_2           3.66106
  -1.69542    2.93656   -1.38042  2 Fe4_2           3.66106
END
</pre></div>
</div>
<p>Using the default <font color="#636A24">♦Pathfinder→fuzz parameter</font> of 0.03
Å, will give these paths. Note that the <code class="docutils literal"><span class="pre">Fe4</span></code> and <code class="docutils literal"><span class="pre">Fe5</span></code>
scatterers, which differ by about 0.11 Å, get merged into a single
scattering path with an R<sub>eff</sub> value that is the average of the
constituent paths.</p>
<div class="highlight-python"><div class="highlight"><pre>#     degen   Reff       scattering path                       I legs   type
 0001   6    2.834  ----  &lt;+&gt; O_1    &lt;+&gt;                       2  2 single scattering
 0002   6    2.942  ----  &lt;+&gt; O_3    &lt;+&gt;                       2  2 single scattering
 0003   3    3.391  ----  &lt;+&gt; Fe2_1  &lt;+&gt;                       2  2 single scattering
 0004  12    3.655  ----  &lt;+&gt; Fe5_1  &lt;+&gt;                       2  2 single scattering
</pre></div>
</div>
<p>Resetting the <font color="#636A24">♦Pathfinder→fuzz</font> to 0.01 separates those
two nearly degenerate paths into separate scattering paths.</p>
<div class="highlight-perl"><div class="highlight"><pre><span class="nv">$any_object</span> <span class="o">-&gt;</span> <span class="n">co</span> <span class="o">-&gt;</span> <span class="n">set_default</span><span class="p">(</span><span class="s">&#39;pathfinder&#39;</span><span class="p">,</span> <span class="s">&#39;fuzz&#39;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>#     degen   Reff       scattering path                       I legs   type
 0001   6    2.834  ----  &lt;+&gt; O_1    &lt;+&gt;                       2  2 single scattering
 0002   6    2.942  ----  &lt;+&gt; O_3    &lt;+&gt;                       2  2 single scattering
 0003   3    3.391  ----  &lt;+&gt; Fe2_1  &lt;+&gt;                       2  2 single scattering
 0004   6    3.649  ----  &lt;+&gt; Fe5_1  &lt;+&gt;                       2  2 single scattering
 0005   6    3.661  ----  &lt;+&gt; Fe4_1  &lt;+&gt;                       2  2 single scattering
</pre></div>
</div>

<br>

<br>
<hr class="docutils" />
<p><font size=-1 color="#8C4112">DEMETER</font> is copyright © 2009-2016 Bruce Ravel – This document is
copyright © 2016 Bruce Ravel</p>
<p>This document is licensed under <a class="reference external" href="http://creativecommons.org/licenses/by-sa/3.0/">The Creative Commons Attribution-ShareAlike License</a>.</p>
<p>If <font size=-1 color="#8C4112">DEMETER</font> and this document are useful to you, please
consider <a class="reference external" href="http://creativecommons.org/support/">supporting The Creative Commons</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Isis-Sothis-Demeter_sm.jpg" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">2. The basics of data processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mue/index.html">3. Processing μ(E) data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xanes/index.html">4. Analysis of XANES data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../highlevel/index.html">5. High level actions of the object model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atoms.html">6. Atoms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">7. Feff</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="input.html">7.1. Input data for Feff</a></li>
<li class="toctree-l2"><a class="reference internal" href="potph.html">7.2. Computng potentials</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">7.3. The path finder</a></li>
<li class="toctree-l2"><a class="reference internal" href="intrp.html">7.4. Path interpretation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../paths/index.html">8. Scattering paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gds.html">9. Guess/Def/Set Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fit/index.html">10. Fitting EXAFS data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../perl.html">11. Using perl to structure a fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lgcv.html">12. Local guess parameters and the characteristic value</a></li>
</ul>
<h3>Helpful Links</h3>
<p>Current version: <b>0.9.24</b></p>

<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/">Demeter homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/bruceravel/demeter/">Demeter @ github</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/newville/ifeffit">Ifeffit</a>
  <li>&nbsp; &nbsp; <a href="http://xraypy.github.io/xraylarch/">Larch</a>
  <li>&nbsp; &nbsp; <a href="http://xafs.org/">xafs.org</a>
</ul>
<ul>
  <li>&nbsp; &nbsp; <a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">Ifeffit mailing list</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.com/demeter/pods/bugs.pod.html">Bug reporting hints</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.com/demeter/pods/help.pod.html">How to ask a good question</a>
</ul>
<p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/feff/pathfinder.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="intrp.html" title="7.4. Path interpretation"
             >next</a></li>
        <li class="right" >
          <a href="potph.html" title="7.2. Computng potentials"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Demeter Programming Guide 0.9.24 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >7. Feff</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Bruce Ravel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>