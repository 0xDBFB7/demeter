<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Demeter::UI::Standards</title>
<link rel="stylesheet" type="text/css" href="../../podstyle.css" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <script type="text/javascript">

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  </script></head>
<body>
<div class="box">
  <h1 class="t1">Demeter</h1>
  <table>
    <tr>
      <td class="label">Description</td>
      <td class="cell">Perl tools for X-ray Absorption Spectroscopy</td>
    </tr>
  </table>
</div>
<div class="path">
  <a href="../../index.html">Demeter</a> &gt; Perl Modules &gt;
  Demeter-UI-Standards
</div>
<div>
<a href="../../src/Demeter/UI/Standards.pm">Source</a>
</div>


<div class="pod">
<!-- INDEX START -->
<h3 id="TOP">Index</h3>
<ul>
	<li><a href="#NAME">NAME</a></li>
	<li><a href="#VERSION">VERSION</a></li>
	<li><a href="#SYNOPSIS">SYNOPSIS</a></li>
	<li><a href="#DESCRIPTION">DESCRIPTION</a></li>
	<li><a href="#METHODS">METHODS</a><br />
<ul>
	<li><a href="#General_methods">General methods</a></li>
	<li><a href="#Formatting_methods">Formatting methods</a></li>
</ul>
</li>
	<li><a href="#CONFIGURATION_AND_ENVIRONMENT">CONFIGURATION AND ENVIRONMENT</a></li>
	<li><a href="#DEPENDENCIES">DEPENDENCIES</a></li>
	<li><a href="#BUGS_AND_LIMITATIONS">BUGS AND LIMITATIONS</a></li>
	<li><a href="#AUTHOR">AUTHOR</a></li>
	<li><a href="#LICENCE_AND_COPYRIGHT">LICENCE AND COPYRIGHT</a></li>
</ul>
<hr />
<!-- INDEX END -->

<h1 id="NAME">NAME <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<p>Demeter::UI::Standards - Standard reference material database interaction</p>

<h1 id="VERSION">VERSION <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<p>This documentation refers to Demeter version 0.9.10.</p>

<h1 id="SYNOPSIS">SYNOPSIS <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<pre>  use Demeter;
  use Demeter::UI::Standards;
  my $standards = Demeter::UI::Standards -&gt; new;

</pre><h1 id="DESCRIPTION">DESCRIPTION <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<p>This module provides methods for an attempt to expand and improve upon
the <a href="http://exafsmaterials.com/Ref_Spectra_0.4MB.pdf">pictures of metal foils spectra</a> that come
with a box of foils from <a href="http://exafsmaterials.com">EXAFS Materials</a>.</p>

<p>That document is fine as far as it goes, but the spectra are not all
of the highest resolution and it only includes foils of a few select
elements.  This implementation expands upon that by including
reference spectra other than foils.  It is extensible in the sense
that new materials can be added easily.  Thus this visualization of
standard reference spectra can cover more of the periodic table and
include various common (or even uncommon) species of any element.</p>

<p>A small database of reference data ships with Demeter and various
mechanisms are provided for extending the list of materials in the
database.  You can use files on your own computer simply by pointing
the program at that file's location.  You can also grab data from the
web by pointing the program at the data file's URL.</p>

<p>Ideally, adequate metadata is provided about each material such that a
useful and thorough presentation of the data can be made.  This
metadata includes some comments identifying the provenance of the
data, the crystal type used to measure the data, enough information to
properly calibrate the data, and lists of points to mark in mu(E) or
the derivative of mu(E).  The program behaves well in the absence of
any of this metadata, but the utility of the program is dimished.</p>

<p>This module is a wrapper around four distinct ways of visualizing
standards data.  It can be used to interactively plot standards,
selecting elements from an on-screen periodic table or with a GUI.  It
can be used to generate a sequence of web pages that can be dropped on
a web site. It can be used to generate a latex document that can be
converted to PDF and printed to replace the one from EXAFS Materials.
Finally, is can be used to create an Athena project file containing a
subset of the reference materials.</p>

<h1 id="METHODS">METHODS <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<h2 id="General_methods">General methods</h2>

<p>These are the methods for handling the Standards object, which
encapsolates the metadata describing the standard reference materials.</p>

<dl>
	<dt><code>material_exists</code></dt>
		<dd><p>This method returns true if the argument string identifies a material
in the database.</p></dd>
<dd><pre>  $exists = $standards -&gt; material_exists(&quot;Zn&quot;);

</pre></dd>	<dt><code>element_exists</code></dt>
		<dd><p>This method returns true if the argument string identifies an element
represented by one or more materials in the data base.</p></dd>
<dd><pre>  $exists = $standards -&gt; element_exists(&quot;U&quot;);

</pre></dd>	<dt><code>get</code></dt>
		<dd><p>This method returns one of the attributes of a database entry.</p></dd>
<dd><pre>  $comment = $standards -&gt; get(&quot;fe&quot;, &quot;comment&quot;);

</pre></dd>	<dt><code>config</code></dt>
		<dd><p>This method returns one of the plotting configuration parameters.</p></dd>
<dd><pre>  $emin = $standards -&gt; config(&quot;emin&quot;);

</pre></dd>		<dd><p>Currently, the Standards-specific configuration parameters control the
plotting range and the placement of the legend.  The keywords are
<code>emin</code>, <code>emax</code>, <code>key_x</code>, and <code>key_y</code></p></dd>
	<dt><code>material_list</code></dt>
		<dd><p>This returns a list of all keys identifying the materials in the
database.  The list is sorted first by Z number of the absorber then
alphabetically by material name.</p></dd>
</dl>
<h2 id="Formatting_methods">Formatting methods</h2>

<p>These methods are used to control the output for the various
visualization modes.  Available modes are</p>

<ul>
	<li>screen</li>
	<li>web</li>
	<li>athena</li>
</ul>

<p>LaTeX mode is not yet working.</p>

<dl>
	<dt><code>plot</code></dt>
		<dd><p>This is the workhorse.  It reads and processes a data file according
to the metadata and prepares the data for display in the chosen output
mode.</p></dd>
<dd><pre>  $response = $standards -&gt; plot($material, $plot_type, $target);

</pre></dd>		<dd><p><code>$material</code> is a material contained in the database.  <code>$plot_type</code>
is an integer between 1 and 3.  A value of 1 says to prepare to plot
XANES data.  A value of 2 says to prepare to plot the derivative
spectrum.  A value of 3 says to prepare a plot explaining the use of a
fluorescence filter.</p></dd>
		<dd><p><code>$target</code> identifies the visualization mode and takes one of four
values:</p></dd>
<dd><dl>
	<dt><code>screen</code></dt>
		<dd><p>The data will be plotted on screen in the typical Ifeffit manner.  For
this target the return value will be an empty string is no problems
are encountered or a error message explaining the source of the error.</p></dd>
	<dt><code>athena</code></dt>
		<dd><p>The data processing will be stopped before any plotting actually
happens.  In this case, the return value is a reference to a Data
object conatining that standard.  This can then be written to an
athena project file or otherwise handled in the manner of Data object.</p></dd>
	<dt><i>filename</i><code>.png</code></dt>
		<dd><p>If the target ends in <code>.png</code>, then the plot will be written to a PNG
file with that name.  When using PGPLOT, it is recommended that you
set the <code>PGPLOT_DEV</code> environment variable to <code>/null</code>.  That will
suppress all plots to the screen before the PNG file is generated.
The return value is the same as for the screen target.</p></dd>
	<dt><i>filename</i><code>.ps</code></dt>
		<dd><p>If the target ends in <code>.ps</code>, then the plot will be written to a
postscript file with that name.  When using PGPLOT, it is recommended
that you set the <code>PGPLOT_DEV</code> environment variable to <code>/null</code>.  That
will suppress all plots to the screen before the postscript file is
generated.  The return value is the same as for the screen target.</p></dd>
</dl>
</dd>
	<dt><code>html_index</code></dt>
		<dd><p>This method writes an index file for the html output.  The index file
contains links to each of the individual material files in a simple
table.  The argument is the fully resolved name for the index file.</p></dd>
<dd><pre>  $standard -&gt; html_index($indexfile);

</pre></dd>	<dt><code>html</code></dt>
		<dd><p>This method writes a page for a given material.  All arguments are
passed as a hash reference.  The <code>folder</code> argument is the output
location for the html file and all image files.  The <code>skip</code> argument
says to skip this material if the html file already exists in the
output folder.  Setting <code>verbose</code> to 0 turns off all messages to
STDOUT.</p></dd>
<dd><pre>  $standards -&gt; html({
		      material =&gt; &quot;fe&quot;,
		      folder   =&gt; &quot;html&quot;,
		      verbose  =&gt; 1,
		      skip     =&gt; 0,
		     });

</pre></dd>	<dt><code>latex</code></dt>
		<dd><p>Not written yet.</p></dd>
	<dt><code>athena</code></dt>
		<dd><p>This method generates an Athena project file for all materials with an
absorber in the list specified by the <code>elements</code> key of the has
reference which is passed as the sole argument.  The output project
file is specified by <code>prjfile</code>.  It will be written to
<cite>standards.prj</cite> in the current directory if not otherwise stated.
Setting <code>verbose</code> to 0 turns off all messages to STDOUT.</p></dd>
<dd><pre>  $standards -&gt; athena({
                        elements =&gt; \@list_of_elements,
			prjfile  =&gt; &quot;standards.prj&quot;,
			verbose  =&gt; 1,
                       });

</pre></dd></dl>
<h1 id="CONFIGURATION_AND_ENVIRONMENT">CONFIGURATION AND ENVIRONMENT <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<p>The meta data -- that is the data about the reference data -- is
contained in the <cite>standards.ini</cite> file.  Here is an example:</p>

<pre>  [fe]
  tag         = Iron foil
  comment     = Iron foil measured at NSLS X11A 10/4/2002 by BR
  crystal     = Si(111)
  file        = %share%/standards/data/fe.stan
  energy      = $1
  numerator   = $2
  denominator = $3
  ln          = 1
  calibrate   = 7106.135, 7112
  xanes       = 7112, 7116.41, 7131.22, 7141.83
  deriv       = 7112, 7120.88, 7129.263

</pre><p>The first few lines describe the data.  The <code>file</code> line identifies
the data file containing the reference.  The &quot;<code>%share%</code>&quot; token is
replaced with the actual installation location of Demeter.  The next
four lines explain how to for mu(E) data from the columns in the file.
The last three lines are used to calibrate the data and mark the
interesting points in the XANES or derivative spectra.</p>

<p>Another option is to import data from an Athena project file.  Here is
an example:</p>

<pre>  [cd]
  tag         = Cadmium foil
  comment     = Cadmium foil, measured at APS 10ID Nov 18, 2006
  crystal     = Si(111)
  file        = %share%/standards/data/Cd.prj
  record      = 1
  xanes       = 26711, 26720.06, 25740.66, 25772.57
  deriv       = 26711, 26714, 26734.60, 26745.10

</pre><p>In this case, the <code>record</code> parameter is used to identify the location
of the data in the project file.  The Athena project file is presumed
to contain well processed data, thus the rebinning and calibration
steps are never performed for data from an project file.</p>

<p>The first section of the <cite>standards.ini</cite> file contains the
configuration data and is used to control some aspects of the plots
made of the reference data.</p>

<p>The output html and latex files are formatted using <a href="http://search.cpan.org/perldoc?Text%3A%3ATemplate">Text::Template</a>
templates, which can be found in the <cite>share</cite> directory of the Demeter
installation.  This is the same formatting system as used for
Demeter's output, but the template files are in a different location.</p>

<p>All other configuration is handled using Demeter's configuration
system.</p>

<h1 id="DEPENDENCIES">DEPENDENCIES <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<p>This uses Demeter and its dependencies.</p>

<h1 id="BUGS_AND_LIMITATIONS">BUGS AND LIMITATIONS <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<ul>
	<li>latex output</li>
	<li>load user ini files (i.e. ~/.horae/standards.ini)</li>
	<li>load site-specific ini files</li>
	<li>other local data locations, other web locations</li>
</ul>

<p>Please report problems to Bruce Ravel (bravel AT bnl DOT gov)</p>

<p>Patches are welcome.</p>

<h1 id="AUTHOR">AUTHOR <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<p>Bruce Ravel (bravel AT bnl DOT gov)</p>

<p><a href="http://cars9.uchicago.edu/~ravel/software/">http://cars9.uchicago.edu/~ravel/software/</a></p>




<h1 id="LICENCE_AND_COPYRIGHT">LICENCE AND COPYRIGHT <a href="#TOP" class="toplink"><img alt="^" src="../../up.gif" /></a></h1>

<p>Copyright (c) 2008-2012 Bruce Ravel (bravel AT bnl DOT gov). All rights reserved.</p>

<p>This module is free software; you can redistribute it and/or
modify it under the same terms as Perl itself. See <a href="http://search.cpan.org/perldoc?perlgpl">perlgpl</a>.</p>

<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>


</div><div class="footer">generated by <a href="http://search.cpan.org/perldoc?Pod%3A%3AProjectDocs">Pod::ProjectDocs</a></div></body>
</html>
