<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>
<title>Demeter::Atoms &mdash; Demeter</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="../podstyle.css" type="text/css" />
</head>
<body><div class="box">
  <h1 class="t1">Demeter</h1>
  <table>
    <tr>
      <td class="label">Description</td>
      <td class="cell">Perl tools for X-ray Absorption Spectroscopy</td>
    </tr>
  </table>
</div>
<div class="path">
  <a href="../index.html">Demeter</a> &gt; Perl Modules &gt;
  Demeter::Atoms
</div>
<div>
<a href="../src/Demeter/Atoms.pm">Source</a>
</div>

<div class="pod">


<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#VERSION">VERSION</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#ATTRIBUTES">ATTRIBUTES</a>
    <ul>
      <li><a href="#Input-parameters">Input parameters</a></li>
      <li><a href="#Progress-flags">Progress flags</a></li>
      <li><a href="#Crystallography">Crystallography</a></li>
    </ul>
  </li>
  <li><a href="#METHODS">METHODS</a>
    <ul>
      <li><a href="#Accessor-methods">Accessor methods</a></li>
      <li><a href="#Main-methods">Main methods</a></li>
      <li><a href="#Methods-for-doing-absorption-calculations">Methods for doing absorption calculations</a></li>
    </ul>
  </li>
  <li><a href="#TEMPLATES">TEMPLATES</a></li>
  <li><a href="#DIAGNOSTICS">DIAGNOSTICS</a></li>
  <li><a href="#SERIALIZATION-AND-DESERIALIZATION">SERIALIZATION AND DESERIALIZATION</a></li>
  <li><a href="#CONFIGURATION-AND-ENVIRONMENT">CONFIGURATION AND ENVIRONMENT</a></li>
  <li><a href="#DEPENDENCIES">DEPENDENCIES</a></li>
  <li><a href="#BUGS-AND-LIMITATIONS">BUGS AND LIMITATIONS</a></li>
  <li><a href="#AUTHOR">AUTHOR</a></li>
  <li><a href="#LICENCE-AND-COPYRIGHT">LICENCE AND COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Demeter::Atoms - Convert crystallographic data to atomic lists</p>

<h1 id="VERSION">VERSION</h1>

<p>This documentation refers to Demeter version 0.9.26.</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<p>These lines behave much like any other version of Atoms:</p>

<pre><code>  use Demeter;
  my $atoms = Demeter::Atoms -&gt; new()
    -&gt; read_inp($ARGV[0]||&quot;atoms.inp&quot;)
      -&gt; Write(&#39;feff6&#39;);</code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This module implements Atoms in the Demeter system. The purpose of Atoms is to convert crystallographic data into a list of atomic coordinates of the sort used by Feff as input data. This greatly simplifies the chore of making Feff input files for crystalline materials.</p>

<h1 id="ATTRIBUTES">ATTRIBUTES</h1>

<p>The following are the attributes of the Data object. Attempting to access an attribute not on this list will throw an exception.</p>

<p>The type of argument expected in given in parentheses. i.e. number, integer, string, and so on. The default value, if one exists, is given in square brackets.</p>

<h2 id="Input-parameters">Input parameters</h2>

<dl>

<dt id="space-string"><code>space</code> (string)</dt>
<dd>

<p>The space group ofthe crystal. This can be in any form recognized by <a href="../Xray/Crystal/Cell.pm.html">Xray::Crystal::Cell</a>, including Hermann-Maguin, Schoenflies, number, or one of a few nicknames.</p>

</dd>
<dt id="a-real"><code>a</code> (real)</dt>
<dd>

<p>The length of the A lattice constant in Angstroms.</p>

</dd>
<dt id="b-real"><code>b</code> (real)</dt>
<dd>

<p>The length of the B lattice constant in Angstroms.</p>

</dd>
<dt id="c-real"><code>c</code> (real)</dt>
<dd>

<p>The length of the C lattice constant in Angstroms.</p>

</dd>
<dt id="alpha-real"><code>alpha</code> (real)</dt>
<dd>

<p>The angle between B and C, in degrees.</p>

</dd>
<dt id="beta-real"><code>beta</code> (real)</dt>
<dd>

<p>The angle between A and C, in degrees.</p>

</dd>
<dt id="gamma-real"><code>gamma</code> (real)</dt>
<dd>

<p>The angle between A and B, in degrees.</p>

</dd>
<dt id="rmax-real"><code>rmax</code> (real)</dt>
<dd>

<p>The extent of the cluster generated from the input crystal data.</p>

</dd>
<dt id="rpath-real"><code>rpath</code> (real)</dt>
<dd>

<p>The value used for the RMAX keyword in the <i>feff.inp</i> file. This is the length of the longest path to be calculated by the pathfinder. A value much larger than about 6 will bog down Demeter&#39;s pathfinder in its current form.</p>

</dd>
<dt id="edge-string-k-or-l3-depending-on-Z-number"><code>edge</code> (string) [k or l3 depending on Z-number]</dt>
<dd>

<p>The edge of the absorber.</p>

</dd>
<dt id="core-string-first-sitin-the-list"><code>core</code> (string) [first sitin the list]</dt>
<dd>

<p>The identifier of the absorber. This should be one of the site tags.</p>

</dd>
<dt id="shiftvec-vector-0-0-0"><code>shiftvec</code> (vector) [0,0,0]</dt>
<dd>

<p>The value of the shift vector, should one be necessary.</p>

</dd>
<dt id="file-filename"><code>file</code> (filename)</dt>
<dd>

<p>The name of an atoms input file.</p>

</dd>
<dt id="cif-filename"><code>cif</code> (filename)</dt>
<dd>

<p>The name of a CIF file.</p>

</dd>
<dt id="record-string-0"><code>record</code> (string) [0]</dt>
<dd>

<p>The record to import from a multi-record CIF file. The default is to read the first record. Note that this is zero-based while you user interface probably should be one-based.</p>

</dd>
<dt id="titles-array-of-strings"><code>titles</code> (array of strings)</dt>
<dd>

<p>An array of strings containing the title lines read from the input data.</p>

</dd>
<dt id="template-output-template-feff6"><code>template</code> (output template) [feff6]</dt>
<dd>

<p>The output template.</p>

</dd>
<dt id="ipot_style-string-elements"><code>ipot_style</code> (string) [elements]</dt>
<dd>

<p>The style for generating the potentials list in a Feff input file. The choices are sites, elements, and tags.</p>

</dd>
</dl>

<h2 id="Progress-flags">Progress flags</h2>

<dl>

<dt id="is_imported-boolean-false"><code>is_imported</code> (boolean) [false]</dt>
<dd>

<p>This is set to true when data is imported from a file.</p>

</dd>
<dt id="is_populated-boolean-false"><code>is_populated</code> (boolean) [false]</dt>
<dd>

<p>This is set to true when the cell is populated.</p>

</dd>
<dt id="is_expanded-boolean-false"><code>is_expanded</code> (boolean) [false]</dt>
<dd>

<p>This is set to true when the populated cell is expanded into a cluster.</p>

</dd>
<dt id="is_ipots_set-boolean-false"><code>is_ipots_set</code> (boolean) [false]</dt>
<dd>

<p>This is set to true when the unique potentials are assigned.</p>

</dd>
<dt id="partial_occupancy"><code>partial_occupancy</code></dt>
<dd>

<p>This is set to true if the input crystal data includes sites with partial occupancy.</p>

</dd>
</dl>

<h2 id="Crystallography">Crystallography</h2>

<dl>

<dt id="sites-list-of-Site-objects"><code>sites</code> (list of Site objects)</dt>
<dd>

<p>This is a reference to the array of Site objects in the cluster.</p>

</dd>
<dt id="cell-reference-to-Cell-object"><code>cell</code> (reference to Cell object)</dt>
<dd>

<p>This is a reference to the Cell object associated with this Atoms object.</p>

</dd>
<dt id="cluster-list"><code>cluster</code> (list)</dt>
<dd>

<p>This is a list containing the expanded cluster. Need to describe each list entry.</p>

</dd>
<dt id="is_rhomb-is_hex-is_first-is_second-boolean"><code>is_rhomb</code>, <code>is_hex</code>, <code>is_first</code>, <code>is_second</code> (boolean)</dt>
<dd>

<p>Occassionally, modifiers to the space group symbol are used to explicitly specify the setting of the crystal.</p>

<p>Trigonal space groups with symbols beginning with <code>R</code> (numbers 146, 148, 155, 160, 161, 166, and 167) can be expressed in rhombohedral or hexagonal settings. While it is possible to figure out the setting from the specified parameters -- the rhombohedral setting has a=b=c, alpha!=90, and alpha=beta=gamma, while the hexagonal setting has a=b!=c, alpha=beta=90, and gamma=120 -- CIF file authors and others may modify the space group symbol with <code>:R</code> or <code>:H</code> to indicated the setting.</p>

<p>Some orthoganal groups (numbers 48, 50, 59, 68, 70), tetragonal groups (85, 86, 88, 125, 126, 129, 130, 133, 134, 137, 138, 141, 142), and cubic groups (201, 203, 222, 224, 227, 228) are given in the International Tables referenced to two centers of symmetry. In general, it is difficult to know which center is used before expanding the unit cell and examining its contents. To remove this ambiguity some CIF file authors and others will modify the space group symbol with <code>:1</code> or <code>:2</code> to indicated which center has been used. Demeter assumes the second setting, so if <code>:1</code> is specified, it is likely that a shift vector will be needed.</p>

<p>When a space group symbol uses one of these modifiers, the corresponding boolean parameter will be set to <code>1</code>.</p>

</dd>
</dl>

<h1 id="METHODS">METHODS</h1>

<p>Various methods for populating the cell, explanding the cluster, and other chores are not documented here. These things will happen as needed when any of the output generating methods are called.</p>

<h2 id="Accessor-methods">Accessor methods</h2>

<dl>

<dt id="set"><code>set</code></dt>
<dd>

<p>Set attributes. This takes a single argument which is a reference to a hash of attribute values. The keys of that hash are any of the valid object attributes listed above.</p>

<pre><code>  $atoms -&gt; set(a =&gt; 3.81, rmax =&gt; 6);</code></pre>

</dd>
<dt id="get"><code>get</code></dt>
<dd>

<p>Retrieve attribute values. This works in scalar and list context.</p>

<pre><code>  $a = $atoms -&gt; get(&quot;a&quot;);
  @cell_constants = $atoms -&gt; get(qw(a b c alpha beta gamma));</code></pre>

</dd>
</dl>

<h2 id="Main-methods">Main methods</h2>

<dl>

<dt id="read_inp"><code>read_inp</code></dt>
<dd>

<p>Import crystal data from an Atoms input file.</p>

<pre><code>  $atoms -&gt; read_inp(&quot;atoms.inp&quot;);</code></pre>

</dd>
<dt id="read_cif"><code>read_cif</code></dt>
<dd>

<p>Import crystal data from a CIF file.</p>

<pre><code>  $atoms -&gt; read_cif(&quot;your_data.cif&quot;);</code></pre>

<p>See <a href="Atoms/Cif.pm.html">Demeter::Atoms::Cif</a> for more details.</p>

</dd>
<dt id="atoms_file"><code>atoms_file</code></dt>
<dd>

<p>Generate text suitable for an atoms input file.</p>

<pre><code>  print $atoms -&gt; atoms_file;</code></pre>

</dd>
<dt id="Write"><code>Write</code></dt>
<dd>

<p>Write out an output file using a specified output template.</p>

<pre><code>  print $atoms-&gt;Write($template);</code></pre>

<p>Several types are already defined, see <a href="#TEMPLATES">&quot;TEMPLATES&quot;</a>.</p>

</dd>
</dl>

<h2 id="Methods-for-doing-absorption-calculations">Methods for doing absorption calculations</h2>

<dl>

<dt id="xsec"><code>xsec</code></dt>
<dd>

<p>Return the length in microns of the sample required for a total absorption length of 1.</p>

</dd>
<dt id="deltamu"><code>deltamu</code></dt>
<dd>

<p>Return the length in microns of the sample required for an edge step of 1.</p>

</dd>
<dt id="density"><code>density</code></dt>
<dd>

<p>Return the density as a unitless specific gravity. The density os computed from the unit cell volume and the mass of the contents of the cell.</p>

</dd>
<dt id="mcmaster"><code>mcmaster</code></dt>
<dd>

<p>Return an approximation of the effect of unit normalization on the sigma^2 values measured in an EXAFS analysis.</p>

</dd>
<dt id="i0"><code>i0</code></dt>
<dd>

<p>Return an approximation of the effect of the energy response of the I0 detector on the sigma^2 values in a fluorescence EXAFS measurement.</p>

</dd>
<dt id="selfsig"><code>selfsig</code></dt>
<dd>

<p>Return an approximation of the effect of self-absorption on the sigma^2 values in a fluorescence EXAFS measurement.</p>

</dd>
<dt id="selfamp"><code>selfamp</code></dt>
<dd>

<p>Return an approximation of the effect of self-absorption on the amplitude in a fluorescence EXAFS measurement.</p>

</dd>
<dt id="netsig"><code>netsig</code></dt>
<dd>

<p>Return the sum of the three sigma^2 corrections.</p>

</dd>
</dl>

<h1 id="TEMPLATES">TEMPLATES</h1>

<p>Atoms templates use the syntax of <a href="http://metacpan.org/module/Text::Template">Text::Template</a>. This is a simple templating language which has snippets of perl code interspersed among plain text.</p>

<ul>

<li><p><b>atoms</b>: An input file for atoms. Calling the <code>Write</code> method with <code>atoms</code> as the argument is identical to calling the <code>atoms_file</code> method.</p>

</li>
<li><p><b>p1</b>: The entrie contents of the fully decorated unit cell, written as an input file for atoms using the <code>P1</code> space group.</p>

</li>
<li><p><b>feff6</b>: An input file for feff6.</p>

</li>
<li><p><b>feff7</b>: An input file for feff7.</p>

</li>
<li><p><b>feff8</b>: An input file for feff8.</p>

</li>
<li><p><b>absorption</b>: Text with the results of various caluclations using tables of xray absorption coefficients.</p>

</li>
<li><p><b>spacegroup</b>: A brief description of the space group, including alternate symbols and a list of equivalent positions.</p>

</li>
</ul>

<p>New output types can be defined by writing new template files. Any template files found on your system can be used as the argument to the <code>Write</code> method.</p>

<h1 id="DIAGNOSTICS">DIAGNOSTICS</h1>

<dl>

<dt id="Atoms:-file-does-not-exist"><code>Atoms: \&quot;$file\&quot; does not exist&quot;</code></dt>
<dd>

<p>Your atoms input file or CIF file could not be found.</p>

</dd>
<dt id="Atoms:-file-could-not-be-read"><code>Atoms: \&quot;$file\&quot; could not be read&quot;</code></dt>
<dd>

<p>Your atoms input file or CIF file could not be read,probably due to a permissions problem.</p>

</dd>
<dt id="Unknown-Atoms-template-file----type-file:-tmpl"><code>Unknown Atoms template file -- type $file: $tmpl&quot;</code></dt>
<dd>

<p>The template file specified in the call to the <code>Write</code> method could not located.</p>

</dd>
<dt id="key-is-not-a-valid-Demeter::Atoms-parameter"><code>&quot;$key&quot; is not a valid Demeter::Atoms parameter</code></dt>
<dd>

<p>You have attempted to set an unrecognized keyword.</p>

</dd>
<dt id="You-have-i-unique-potentials-but-Feff-only-allows-7"><code>You have $i unique potentials, but Feff only allows 7.</code></dt>
<dd>

<p>Your choice of ipot style has resulted in more than 7 unique potentials being defined. Feff will refuse to run with that many.</p>

</dd>
<dt id="key-is-a-deprecated-Atoms-keyword-file-line"><code>&quot;$key&quot; is a deprecated Atoms keyword ($file line $.)</code></dt>
<dd>

<p>While reading an Atoms input file, you have come across a keyword that was recognized in an earlier version of Atoms, but which is no longer supported. It&#39;s value was ignored.</p>

</dd>
<dt id="key-is-not-an-Atoms-keyword-file-line"><code>&quot;$key&quot; is not an Atoms keyword ($file line $.)</code></dt>
<dd>

<p>While reading an Atoms input file, you have come across a keyword that is not an Atoms keyword. It&#39;s value was ignored.</p>

</dd>
</dl>

<h1 id="SERIALIZATION-AND-DESERIALIZATION">SERIALIZATION AND DESERIALIZATION</h1>

<p>The atoms input file is used for serialization of input data. Output data should be associated with a Feff object and serialization of the output should be handled as a Feff object.</p>

<h1 id="CONFIGURATION-AND-ENVIRONMENT">CONFIGURATION AND ENVIRONMENT</h1>

<p>See <a href="Config.pm.html">Demeter::Config</a> for a description of the configuration system. Atoms uses the <code>atoms</code> configuration group.</p>

<h1 id="DEPENDENCIES">DEPENDENCIES</h1>

<p>The dependencies of the Demeter system are in the <i>Build.PL</i> file.</p>

<h1 id="BUGS-AND-LIMITATIONS">BUGS AND LIMITATIONS</h1>

<ul>

<li><p>Need to implement a feff.inp parser for OpenBabel to enable a much broader range of output formats.</p>

</li>
<li><p>Neutral (parallelipiped) cluster?</p>

</li>
<li><p>Need overfull, p1_cartesian, gnxas outout.</p>

</li>
<li><p>Location in user space for user-defined templates.</p>

</li>
<li><p>Need more testing of spacegroups and database.</p>

</li>
</ul>

<p>Please report problems to the Ifeffit Mailing List (<a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">http://cars9.uchicago.edu/mailman/listinfo/ifeffit/</a>)</p>

<p>Patches are welcome.</p>

<h1 id="AUTHOR">AUTHOR</h1>

<p>Bruce Ravel, <a href="http://bruceravel.github.io/home">http://bruceravel.github.io/home</a></p>

<p><a href="http://bruceravel.github.io/demeter">http://bruceravel.github.io/demeter</a></p>

<h1 id="LICENCE-AND-COPYRIGHT">LICENCE AND COPYRIGHT</h1>

<p>Copyright (c) 2006-2017 Bruce Ravel (<a href="http://bruceravel.github.io/home">http://bruceravel.github.io/home</a>). All rights reserved.</p>

<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself. See <a href="http://metacpan.org/module/perlgpl">perlgpl</a>.</p>

<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>

</div><div class="footer">generated by <a href="http://metacpan.org/module/Pod::ProjectDocs">Pod::ProjectDocs</a></div></body></html>

