<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>
<title>Demeter::Data::Beamlines &mdash; Demeter</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="../../podstyle.css" type="text/css" />
</head>
<body><div class="box">
  <h1 class="t1">Demeter</h1>
  <table>
    <tr>
      <td class="label">Description</td>
      <td class="cell">Perl tools for X-ray Absorption Spectroscopy</td>
    </tr>
  </table>
</div>
<div class="path">
  <a href="../../index.html">Demeter</a> &gt; Perl Modules &gt;
  Demeter::Data::Beamlines
</div>
<div>

<a href="../../src/Demeter/Data/Beamlines.pm">Source</a>

</div>

<div class="pod">


<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#VERSION">VERSION</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#ATTRIBUTES">ATTRIBUTES</a></li>
  <li><a href="#METHODS">METHODS</a></li>
  <li><a href="#Hints-for-plugin-writers">Hints for plugin writers</a></li>
  <li><a href="#BUGS-AND-LIMITATIONS">BUGS AND LIMITATIONS</a></li>
  <li><a href="#AUTHOR">AUTHOR</a></li>
  <li><a href="#LICENCE-AND-COPYRIGHT">LICENCE AND COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Demeter::Data::Beamlines - Role for identifying the beamline provenance of data</p>

<h1 id="VERSION">VERSION</h1>

<p>This documentation refers to Demeter version 0.9.26.</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>Using plugins found in <i>Demeter/Plugins/Beamlines</i>, attempt to identify the beamline of origin of the data file. If identified, attempt to glean metadata from the file header.</p>

<h1 id="ATTRIBUTES">ATTRIBUTES</h1>

<dl>

<dt id="daq-string"><code>daq</code> (string)</dt>
<dd>

<p>The name of the data acquisition program used to collect the data.</p>

</dd>
<dt id="beamline-string"><code>beamline</code> (string)</dt>
<dd>

<p>The designation of the beamline at which the data were collected.</p>

</dd>
<dt id="beamline_identified-boolean"><code>beamline_identified</code> (boolean)</dt>
<dd>

<p>Set to true once the beamline has been positively identified.</p>

</dd>
</dl>

<h1 id="METHODS">METHODS</h1>

<p>There is only one method -- <code>identify_beamline</code>. This steps through the plugins found in <i>Demeter/Plugins/Beamlines</i>, each of which must provide a method called <code>is</code>. Each plugin&#39;s <code>is</code> method is called in turn. Once one returns a positive, metadata is set and this method returns.</p>

<p>These checks can be completely disabled by setting the <code>operations-</code>identify_beamline&gt; configuration parameter to 0.</p>

<p>A beamline plugin provides one (and only one) method. This method must be called <code>is</code>.</p>

<p>This method is called like so:</p>

<pre><code>    Demeter::Plugin::Beamlines::MX-&gt;is($data, $file);</code></pre>

<p>where <code>$data</code> is the Demeter::Data object that represents the data in the file and <code>$file</code> is the fully resolved filename of the file being tested.</p>

<p>Each <code>is</code> method <b>must</b> perform the following chores:</p>

<ol>

<li><p><b>Very quickly</b> recognize whether a file comes from the beamline. Speed is essential as every file will be checked sequentially against every beamline plugin. If a beamline plugin is slow to determine this, then the use of Athena or other applications will be noticeably affected.</p>

</li>
<li><p>Recognize semantic content from the file header. Where possible, map this content onto defined XDI headers. Other semantic content should be placed into extension headers.</p>

</li>
<li><p>Add versioning information for the data acquisition program into the XDI extra_version attribute.</p>

</li>
<li><p>Set the <code>daq</code> and <code>beamline</code> attributes of the Demeter::Data object with the names of the data acquisition software and the designation of the beamline.</p>

</li>
</ol>

<p><code>is</code> is not required to read the data table and is encouraged not to do so. Of course, if there is semantic content in the data table intended to be interpreted as metadata, then it would be appropriate. But ... ick ...!</p>

<h1 id="Hints-for-plugin-writers">Hints for plugin writers</h1>

<ul>

<li><p>If possible, recognize the beamline by examination of the first line (or first few lines) of the file.</p>

</li>
<li><p>Define an Xray::XDI object for use with the Demeter::Data object as soon as possible, but after the bail-out point for a file that is not from this beamline.</p>

</li>
<li><p>Use <code>$data-</code>xdi-&gt;set_item&gt; to set a defined or extension header. The syntax is</p>

<pre><code>    $data-&gt;xdi-&gt;set_item($family, $tag, $value);</code></pre>

<p>Use defined fields wherever possible.</p>

</li>
<li><p>Use <code>$data-</code>xdi-&gt;push_comment&gt; to push each user comment line onto the XDi comment attribute. The syntax is:</p>

<pre><code>    $data-&gt;xdi-&gt;push_comment($comment_line);</code></pre>

<p>where <code>$comment_line</code> is free-form text and does <b>not</b> end with an end-of-line character. The <code>push_comment</code> method handles the end-of-line character correctly for your computer.</p>

</li>
<li><p>Some metadata is constant for any file collected at a beamline. Deposit an .ini file in Demeter&#39;s <i>share/xdi/</i> folder and use it by a call to <code>$data-</code>metadata_from_ini&gt;. The syntax is</p>

<pre><code>    $data-&gt;metadata_from_ini($inifile);</code></pre>

<p>where <code>$inifile</code> is the fully resolved name of the .ini file, likely in the <i>share/xdi/</i> folder (but it can be anywhere). That method will fail gracefully if <code>$inifile</code> does not exist.</p>

</li>
</ul>

<h1 id="BUGS-AND-LIMITATIONS">BUGS AND LIMITATIONS</h1>

<p>Please report problems to the Ifeffit Mailing List (<a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">http://cars9.uchicago.edu/mailman/listinfo/ifeffit/</a>)</p>

<p>Patches are welcome.</p>

<h1 id="AUTHOR">AUTHOR</h1>

<p>Bruce Ravel, <a href="http://bruceravel.github.io/home">http://bruceravel.github.io/home</a></p>

<p><a href="http://bruceravel.github.io/demeter/">http://bruceravel.github.io/demeter/</a></p>

<h1 id="LICENCE-AND-COPYRIGHT">LICENCE AND COPYRIGHT</h1>

<p>Copyright (c) 2006-2018 Bruce Ravel (<a href="http://bruceravel.github.io/home">http://bruceravel.github.io/home</a>). All rights reserved.</p>

<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself. See <a href="http://metacpan.org/module/perlgpl">perlgpl</a>.</p>

<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>

</div><div class="footer">generated by <a href="http://metacpan.org/module/Pod::ProjectDocs">Pod::ProjectDocs</a></div></body></html>

