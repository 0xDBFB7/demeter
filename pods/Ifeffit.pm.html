<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Ifeffit</title>
<link rel="stylesheet" type="text/css" href="podstyle.css" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <script type="text/javascript">

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  </script></head>
<body>
<div class="box">
  <h1 class="t1">Demeter</h1>
  <table>
    <tr>
      <td class="label">Description</td>
      <td class="cell">Perl tools for X-ray Absorption Spectroscopy</td>
    </tr>
  </table>
</div>
<div class="path">
  <a href="index.html">Demeter</a> &gt; Perl Modules &gt;
  Ifeffit
</div>
<div>
<a href="src/Ifeffit.pm">Source</a>
</div>


<div class="pod">
<!-- INDEX START -->
<h3 id="TOP">Index</h3>
<ul>
	<li><a href="#NAME">NAME</a></li>
	<li><a href="#SYNOPSIS">SYNOPSIS</a></li>
	<li><a href="#DESCRIPTION">DESCRIPTION</a><br />
<ul>
	<li><a href="#ifeffit">ifeffit</a></li>
	<li><a href="#put_scalar">put_scalar</a></li>
	<li><a href="#get_scalar">get_scalar</a></li>
	<li><a href="#put_string">put_string</a></li>
	<li><a href="#get_string">get_string</a></li>
	<li><a href="#put_array">put_array</a></li>
	<li><a href="#get_array">get_array</a></li>
</ul>
</li>
	<li><a href="#REVISION_HISTORY">REVISION HISTORY</a></li>
	<li><a href="#AUTHOR">AUTHOR</a></li>
	<li><a href="#SEE_ALSO">SEE ALSO</a></li>
</ul>
<hr />
<!-- INDEX END -->

<h1 id="NAME">NAME <a href="#TOP" class="toplink"><img alt="^" src="up.gif" /></a></h1>

<p>Ifeffit - Perl interface to the IFEFFIT XAFS Analysis library.</p>

<h1 id="SYNOPSIS">SYNOPSIS <a href="#TOP" class="toplink"><img alt="^" src="up.gif" /></a></h1>

<pre>    use Ifeffit;
    use Ifeffit qw(put_scalar put_string put_array);
    use Ifeffit qw(get_scalar get_string get_array);

    my ($kmin, $my_file, $file_type ) = (0.01, &quot;Cu.xmu&quot;, &quot;xmu&quot;);
    put_scalar(&quot;rbkg&quot;, 1.1);
    put_scalar(&quot;kmin&quot;, $kmin);
    put_string(&quot;filename&quot;, $my_file);

    ifeffit(&quot; read_data($my_file, prefix= my,&quot;);
    ifeffit(&quot;           type= $file_type)&quot;);
    ifeffit(&quot; newplot (energy, xmu ) &quot;);

    my $e0 = get_scalar(&quot;e0&quot;);
    print &quot;e0 = $e0 , rbkg  = &quot; ,get_scalar(&quot;rbkg&quot;), &quot;\n&quot;;

</pre><h1 id="DESCRIPTION">DESCRIPTION <a href="#TOP" class="toplink"><img alt="^" src="up.gif" /></a></h1>

<p>The Ifeffit Perl Module gives access to the ifeffit library for XAFS
analysis.  The module provides seven perl functions - <strong>ifeffit</strong>,
<strong>put_scalar</strong>, <strong>get_scalar</strong>, <strong>put_string</strong>, <strong>get_string</strong>, <strong>put_array</strong>,
and <strong>get_array</strong>.  The <strong>ifeffit</strong> is always provided (ie, exported by the
&quot;use Ifeffit;&quot; pragma), but the other commands must be explicitly imported,
as shown above.</p>

<h2 id="ifeffit">ifeffit</h2>

<p><a href="#" onclick="toggleCode('method_ifeffit');return false;">[Source]</a></p>
                                        <div class="method-source-code" id="method_ifeffit">
                                        <pre>

sub ifeffit ($) {
    my @com = split(/\n/, $_[0]);
    my ($c, $ret) ;
    foreach $c (@com) {$ret = Ifeffit::iff_exec($c); };
    return $ret;
}
</pre></div>

<p>The ifeffit function provides the main interface to the ifeffit engine.
The character string argument is interpreted as an ifeffit command.
Ifeffit returns 0 if a valid command is sent and fully processed, -1 if a
partial command has been sent (so that it will be expecting the rest of the
command next), 1 if the &quot;quit&quot; command has been sent, and other non-zero
valuses on error.  The syntax for and meaning of command lines to ifeffit
is described in <i>The Ifeffit Reference Manual</i> of the Ifeffit
distribution.  The syntax for the perl function is</p>

<p><code>$i = ifeffit(&quot;plot(my.x,  my.y)&quot;);</code></p>

<h2 id="put_scalar">put_scalar</h2>

<p><a href="#" onclick="toggleCode('method_put_scalar');return false;">[Source]</a></p>
                                        <div class="method-source-code" id="method_put_scalar">
                                        <pre>

sub put_scalar ($$) {
    return (ifeffit("set $_[0] = $_[1]")) ? undef: $_[1];
}
</pre></div>

<p>This sets the value of a named scalar in the list of ifeffit data.
The set value is returned on successful execution.  The syntax is</p>

<p><code>$i = put_scalar(&quot;kweight&quot;, 2.0);</code>.</p>

<p>which is equivalent to</p>

<p><code>$i = ifeffit(&quot;kweight = 2.0&quot;);</code></p>

<p>But having a choice seems like the perl way.</p>

<h2 id="get_scalar">get_scalar</h2>

<p><a href="#" onclick="toggleCode('method_get_scalar');return false;">[Source]</a></p>
                                        <div class="method-source-code" id="method_get_scalar">
                                        <pre>

sub get_scalar ($) {
    my $ptr = new_Pdbl();
    my $val = undef;
    if (Ifeffit::iff_get_scalar($_[0],$ptr) == 0) {
	$val = Pdbl_value($ptr);
    }
    delete_Pdbl($ptr);
    return $val;
}
</pre></div>

<p>This returns the value of a named ifeffit scalar. The syntax is</p>

<p><code>$value = get_scalar(&quot;x&quot;);</code></p>

<h2 id="put_string">put_string</h2>

<p><a href="#" onclick="toggleCode('method_put_string');return false;">[Source]</a></p>
                                        <div class="method-source-code" id="method_put_string">
                                        <pre>

sub put_string ($$) {
    my $inp = $_[0];
    $inp = "\$".$inp unless ($inp =~ /^(\$)/o);
    my $str = $_[1];
    $str = "\"" . $str . "\"" unless ($str =~ /^\".*\"$/);
    return ifeffit("set $inp =  $str");
}
</pre></div>

<p>This sets the value of a named ifeffit string.  The value is returned
on successful execution.  The syntax is</p>

<p><code>$i = put_text(&quot;home&quot;, &quot;the merry old land of oz&quot;);</code>.</p>

<p>The same effect could be achieved with the command</p>

<p><code>$i = ifeffit(&quot;set \$home = 'the merry old land of oz'&quot;);</code>.</p>

<p>but <strong>put_text</strong> takes care of the icky leading dollar sign, and returns the
string instead of a simple exit status.</p>

<h2 id="get_string">get_string</h2>

<p><a href="#" onclick="toggleCode('method_get_string');return false;">[Source]</a></p>
                                        <div class="method-source-code" id="method_get_string">
                                        <pre>

sub get_string ($) {
    my $str = " "x512;
    my $len = Ifeffit::iff_get_string($_[0],$str);
    return ($len) ?  substr($str,0,$len) : " ";
}
</pre></div>

<p>This returns the value of a named ifeffit string.  The syntax is</p>

<p><code>$bg = get_string(&quot;plot_bg&quot;);</code></p>

<h2 id="put_array">put_array</h2>

<p><a href="#" onclick="toggleCode('method_put_array');return false;">[Source]</a></p>
                                        <div class="method-source-code" id="method_put_array">
                                        <pre>

sub put_array ($$) {
    my $npts   = $#{$_[1]} + 1;
    my ($i,$x,$p_n,$ret,$ptr);
    if ($npts > $MAX_ARRAY_PTS) { $npts = $MAX_ARRAY_PTS;}
    $ptr    = new_Parr($npts);
    for ($i = 0; $i < $npts; $i++) { Parr_setitem($ptr, $i, ${$_[1]}[$i]); }
    $p_n    = new_Pint();
    Pint_assign($p_n, $npts);
    $ret = Ifeffit::iff_put_array($_[0], $p_n, $ptr);
    delete_Pint($p_n);
    delete_Parr($ptr);
    return $ret;
}
</pre></div>

<p>This copies a perl array of numeric values to an ifeffit array.
The syntax is</p>

<p><code>put_array(&quot;my.array&quot;,\@array);</code></p>

<p>which creates (or overwrites) the ifeffit array <i>my.array</i>, and fill it
with the values of the perl array <i>@array</i>.  Note that the <strong>reference</strong> to
the array is passed into <strong>put_array</strong>, not the whole array itself!</p>

<h2 id="get_array">get_array</h2>

<p><a href="#" onclick="toggleCode('method_get_array');return false;">[Source]</a></p>
                                        <div class="method-source-code" id="method_get_array">
                                        <pre>

sub get_array ($) {  # note the use of MAX_ARRAY_PTS !!!
    my ($ptr,$npts,$i);
    my @arr  = ();
    $ptr  = new_Parr($MAX_ARRAY_PTS);
    $npts = Ifeffit::iff_get_array($_[0],$ptr);
    if ($npts) {
	for ($i = 0; $i < $npts; $i++) { $arr[$i] = Parr_getitem($ptr,$i);}
    }
    delete_Parr($ptr);
    return @arr;
}
</pre></div>

<p>This gets the values of an ifeffit array of numeric values. The syntax is</p>

<p><code>@array = get_array(&quot;my.array&quot;);</code></p>

<p>which will fill the perl array <strong>@array</strong> with the ifeffit array
<i>my.array</i>.</p>

<h1 id="REVISION_HISTORY">REVISION HISTORY <a href="#TOP" class="toplink"><img alt="^" src="up.gif" /></a></h1>

<dl>
	<dt>1.3</dt>
		<dd><p>Begin distributing with horae package.</p></dd>
	<dt>1.3 (1)</dt>
		<dd><p>Force enclosure of string by double quotes in the put_string function.
(Bruce Ravel 18 Feb. 2003)</p></dd>
</dl>
<h1 id="AUTHOR">AUTHOR <a href="#TOP" class="toplink"><img alt="^" src="up.gif" /></a></h1>

<p>Matthew Newville  --  newville@cars.uchicago.edu</p>

<h1 id="SEE_ALSO">SEE ALSO <a href="#TOP" class="toplink"><img alt="^" src="up.gif" /></a></h1>

<p>ifeffit, Ifeffit Reference Manual, perl(1)</p>

<p>PGPERL, PDL,  GNU ReadLine Library</p>





</div><div class="footer">generated by <a href="https://metacpan.org/pod/Pod%3A%3AProjectDocs">Pod::ProjectDocs</a></div></body>
</html>
